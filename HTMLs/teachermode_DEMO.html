<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>MISSION CONTROL // JUNCTURE OPERATIONS (DEMO)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="critical_crypto.js"></script>
    <style>
        :root {
            --bg: #f4f4f4;
            --accent: #222;
            --success: #28a745;
            --err: #dc3545;
            --terminal: #000;
            --term-txt: #0f0;
            --font-main: 'Inter', sans-serif;
            --font-tech: 'Courier New', monospace;
        }

        body {
            font-family: var(--font-main);
            padding: 40px;
            background: var(--bg);
            color: #333;
            margin: 0;
        }

        #status-bar {
            background: #1a1a1a;
            color: #fff;
            padding: 15px 25px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 5px solid var(--accent);
        }

        .status-light {
            height: 12px;
            width: 12px;
            border-radius: 50%;
            background: #666;
            display: inline-block;
            margin-right: 10px;
        }

        .status-light.online {
            background: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        h1 {
            font-family: var(--font-tech);
            text-transform: uppercase;
            letter-spacing: 5px;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.5rem;
        }

        #console {
            background: var(--terminal);
            color: var(--term-txt);
            padding: 15px;
            height: 180px;
            overflow-y: auto;
            font-size: 0.8rem;
            border: 1px solid #333;
            margin-bottom: 30px;
        }

        .panel {
            background: #fff;
            padding: 30px;
            border: 1px solid #ddd;
            border-top: 5px solid var(--accent);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1.2fr;
            gap: 30px;
        }

        input,
        textarea {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            font-family: inherit;
            box-sizing: border-box;
        }

        .btn {
            background: var(--accent);
            color: #fff;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
            transition: all 0.2s ease;
            border-radius: 4px;
            /* [v65.61] UI Polish */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            font-size: 0.75rem;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            filter: brightness(1.1);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
            text-align: left;
            font-size: 0.75rem;
            vertical-align: middle;
        }

        th {
            background: var(--accent);
            color: #fff;
            text-transform: uppercase;
            font-size: 0.6rem;
            letter-spacing: 1px;
        }

        label {
            font-size: 0.6rem;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 5px;
            display: block;
            font-weight: bold;
        }

        /* PROJECTOR MODE */
        #projector-view {
            display: none;
            position: fixed;
            inset: 0;
            background: #050505;
            z-index: 2000;
            padding: 40px;
            overflow-y: auto;
        }

        #projector-view.active {
            display: block;
        }

        .proj-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #d2b48c;
            padding-bottom: 20px;
            margin-bottom: 40px;
        }

        .proj-header h1 {
            margin: 0;
            letter-spacing: 8px;
            font-size: 2rem;
            color: #d2b48c;
            text-transform: uppercase;
        }

        .proj-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 12px;
        }

        .proj-card {
            background: #111;
            border: 1px solid #333;
            padding: 8px;
            transition: 0.3s;
        }

        .proj-card.active {
            border-color: #d2b48c;
            box-shadow: 0 0 20px rgba(210, 180, 140, 0.1);
        }

        .proj-name {
            font-size: 0.85rem;
            font-weight: bold;
            color: #d2b48c;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .proj-class {
            font-size: 0.55rem;
            color: #d2b48c;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .proj-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.65rem;
            border-top: 1px solid #333;
            padding-top: 6px;
        }

        .proj-bar {
            height: 3px;
            background: #222;
            margin-top: 8px;
        }

        .proj-fill {
            height: 100%;
            background: #d2b48c;
            transition: width 1s ease;
        }

        .demo-banner {
            background: #d2b48c;
            color: #000;
            padding: 5px 15px;
            font-size: 0.6rem;
            font-weight: bold;
            letter-spacing: 2px;
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="demo-banner">DEMO MODE : OFFLINE DATA ARCHIVE ACTIVE</div>
    <div id="projector-view">
        <header class="proj-header">
            <h1>COMMAND PROGRESS BOARD (DEMO)</h1>
            <div style="display:flex; gap:15px; align-items:center;">
                <select id="proj-class-filter" onchange="renderProjectorBoard()"
                    style="padding:8px 12px; font-family:inherit; font-size:0.7rem; background:#222; color:#d2b48c; border:1px solid #444;">
                    <option value="ALL">ALL CLASSES</option>
                </select>
                <select id="proj-mission-filter" onchange="renderProjectorBoard()"
                    style="padding:8px 12px; font-family:inherit; font-size:0.7rem; background:#222; color:#d2b48c; border:1px solid #444;">
                    <option value="ALL">ALL MISSIONS</option>
                </select>
                <span id="proj-sync" style="font-size:0.7rem; color:#888; letter-spacing:2px;">[DEMO_ACTIVE]</span>
                <button onclick="toggleProjector()"
                    style="background:#d2b48c; color:#000; border:none; padding:8px 15px; cursor:pointer; font-weight:bold; letter-spacing:1px; font-size:0.7rem;">EXIT
                    PROJECTOR</button>
            </div>
        </header>
        <div id="proj-board" class="proj-grid"></div>
    </div>

    <div id="status-bar">
        <div><span id="s-light" class="status-light online"></span> <span id="s-text"
                style="letter-spacing: 2px;">SECURE_DEMO_LINK_ACTIVE</span></div>
        <div style="display:flex; gap:20px; align-items:center;">
            <button onclick="toggleProjector()"
                style="background:#333; color:#d2b48c; font-size:0.6rem; border:1px solid #d2b48c; padding:6px 15px; border-radius:3px; cursor:pointer; font-weight:bold; letter-spacing:1px;">ðŸ“º
                PROJECTOR VIEW</button>
            <div style="font-size: 0.7rem; opacity: 0.7;">TEACHER DEMO // v65.53</div>
        </div>
    </div>
    <h1 style="margin: 0 40px 30px 40px;">COMMAND CENTER // MISSION CONTROL (DEMO)</h1>
    <div class="grid" style="grid-template-columns: 1fr 1.5fr 1fr; padding: 0 40px;">
        <div class="panel">
            <h3
                style="margin-top:0; letter-spacing:2px; font-size:0.8rem; border-bottom:1px solid #ddd; padding-bottom:10px;">
                CAPSULE STAGING</h3>
            <div style="padding:20px; background:#f9f9f9; border:1px solid #eee; text-align:center; opacity:0.5;">
                <div style="font-size:0.55rem; color:#666; font-weight:bold;">LIVE UPLOADS DISABLED IN DEMO</div>
            </div>
            <div style="margin-top:20px;">
                <label>Archive Access (Class PIN)</label>
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <input id="master-pin" type="password" placeholder="ENTER PIN" style="margin:0;">
                    <button class="btn" style="width:auto; padding:0 15px;"
                        onclick="deriveMasterKey()">DECIPHER</button>
                </div>
                <div id="crypto-status"
                    style="font-size:0.5rem; color:#888; text-transform:uppercase; letter-spacing:1px;">LINK_DECRYPTED:
                    NO</div>
                <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
                <div style="display:flex; gap:10px;">
                    <button class="btn" id="dl-btn" style="padding:10px; font-size:0.75rem; background:#333;"
                        onclick="downloadArchive()">DOWNLOAD ARCHIVE</button>
                    <button class="btn" id="imp-btn"
                        style="padding:10px; font-size:0.75rem; background:var(--accent); color:#000;"
                        onclick="document.getElementById('import-file').click()">IMPORT FOR REVIEW</button>
                    <input type="file" id="import-file" style="display:none" onchange="importArchive(this.files[0])"
                        accept=".json">
                </div>
            </div>

            <div id="grading-panel"
                style="display:none; margin-top:30px; border-top:5px solid var(--accent); padding-top:20px;">
                <h3 style="margin-top:0; letter-spacing:2px; font-size:0.8rem;">ASSESSMENT INTERFACE</h3>
                <div
                    style="background:#fff; border:1px solid #ddd; padding:20px; box-shadow:0 4px 6px rgba(0,0,0,0.05);">
                    <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                        <strong id="grade-name" style="font-size:1.2rem;">STUDENT NAME</strong>
                        <span id="grade-mission" style="color:#888; letter-spacing:1px;">MISSION_ID</span>
                    </div>

                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                        <div>
                            <label>DECISION MATRIX</label>
                            <div id="grade-dec"
                                style="font-family:monospace; background:#f4f4f4; padding:10px; font-size:0.8rem; margin-bottom:15px;">
                            </div>

                            <label>FIELD ANALYSIS (RAT)</label>
                            <div id="grade-rat"
                                style="font-family:var(--font-p); background:#fff; border:1px solid #eee; padding:15px; font-size:0.9rem; margin-bottom:15px; border-left:3px solid var(--accent); font-style:italic;">
                            </div>

                            <label>POST-MISSION REFLECTION</label>
                            <div id="grade-ans"
                                style="font-family:var(--font-p); background:#fff; border:1px solid #eee; padding:15px; font-size:0.9rem;">
                            </div>
                        </div>

                        <div style="background:#fafafa; border:1px solid #eee; padding:15px;">
                            <label>RUBRIC ASSESSMENT</label>
                            <div style="margin-bottom:10px; font-size:0.75rem; color:#666;">CRITERIA: Evidence Citation,
                                Strategic Logic, Ethical Reasoning</div>

                            <label>AI INITIAL SCORE</label>
                            <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
                                <div id="ai-score" style="font-size:1.5rem; font-weight:bold; color:var(--accent);">
                                    --/100</div>
                                <div style="font-size:0.55rem; color:#888; text-transform:uppercase;">Based on keyword
                                    density & sentiment</div>
                            </div>

                            <label>INSTRUCTOR GRADE</label>
                            <input type="number" id="final-grade" placeholder="0-100"
                                style="font-size:1.2rem; font-weight:bold;">

                            <label>FEEDBACK</label>
                            <textarea id="grade-feedback" placeholder="Enter instructor feedback..."
                                style="height:80px;"></textarea>

                            <button class="btn" style="background:var(--success);" onclick="saveGrade()">SUBMIT
                                GRADE</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel">
            <div
                style="display:flex; justify-content:space-between; align-items:flex-start; border-bottom:1px solid #ddd; padding-bottom:10px; margin-bottom:20px;">
                <h3 style="margin:0; letter-spacing:2px; font-size:0.8rem;">LIVE PROGRESS (SIMULATED)</h3>
                <div id="sync-tick" style="font-size:0.55rem; color:#888;">[SYNC_IDLE]</div>
            </div>
            <div style="margin-bottom:15px; display:flex; gap:10px;">
                <select id="class-filter" style="flex:1; padding:8px; font-family:inherit; font-size:0.75rem;"
                    onchange="renderProgress()">
                    <option value="ALL">ALL CLASSES</option>
                </select>
                <button class="btn" style="width:auto; padding:0 15px; font-size:0.6rem;"
                    onclick="fetchProgress()">REFRESH</button>
            </div>
            <div id="progress-list" style="max-height:500px; overflow-y:auto; border:1px solid #eee;"></div>
        </div>

        <div style="display:flex; flex-direction:column; gap:20px;">
            <div class="panel" style="flex:1;">
                <h3
                    style="margin-top:0; letter-spacing:2px; font-size:0.8rem; border-bottom:1px solid #ddd; padding-bottom:10px;">
                    MISSION DIRECTORY</h3>
                <div id="library-list"></div>
            </div>
            <div class="panel" style="padding:20px; background:var(--terminal); border-top:none;">
                <h3 style="margin-top:0; color:#fff; font-size:0.6rem; letter-spacing:1px; opacity:0.6;">SYSTEM LOG</h3>
                <div id="console" style="height:150px; overflow-y:auto; font-size:0.65rem; color:var(--term-txt);">
                </div>
            </div>
        </div>
    </div>

    <script>
        const allProgress = [
            { id: "A01", name: "Agent Leo", class: "PER-01", missionData: { "CUBA_62": { preDone: true, dec: { 1: "D", 2: "Q", 3: "S", 4: "D", 5: "H" } } } },
            { id: "A02", name: "Agent Sarah", class: "PER-01", missionData: { "CUBA_62": { preDone: true, dec: { 1: "S", 2: "A", 3: "A", 4: "K", 5: "F" } } } },
            {
                id: "A11_SECURED",
                name: "Agent X (Secured)",
                class: "PER-62",
                encryptedState: "5XbCiSwM+EFeKJfu:/frn5Re+R5darzRxZtFzfjsANsto1vxm9Lylfj/TnvXyxL5+oV/uV6izQ/Qn1KM4NSiFGWXvO6Y+LB1B8q7B1T7GLi5mgh2SkCAbTjZTGy8decbhmLZBQZ4auFdYgp1cvFDyvIDips7y9mMSyOTswDPuS7U6wJ57CBpYKMZiLBPhoJs4voukh6Cnx5lzhOcR3j0Zn+DCuRdWtmsBmAOLpFgT2lAC8N72bsGCjzRtb/fGRf2z32NwD+Zxkgl3cB8K8B37JHUJrl0EttM1PUQemirPhB7hxpztNTc9As19WrKVxHr93/lVURGqcpKERz08/2jbXFtd4RpwWMDWRfewyfsKmWzM2TLP0KpDiGArFNRqFqkOdqzzf4Pgjy30Cw4lz3vvrBN1YvlYqv/djf0gECL9SFP7cPNNNOwT4QL+a73EO05X9pBG/s/6dll+bsCt6b4N3HoWvtzoRg/W/oMAvYZvkdDJBSEd"
                // Simulated AES-GCM payload using PIN '1234' and Salt 'PER-62'
            }
        ];

        let masterKey = null;

        async function deriveMasterKey() {
            const pin = document.getElementById('master-pin').value;
            if (!pin) return alert("Security PIN required.");

            try {
                // In teacher mode, we iterate through active classes or derive once for the primary class
                // For demo, we assume the teacher is unlocking PER-62
                masterKey = await CriticalCrypto.deriveKey(pin, "PER-62");
                document.getElementById('crypto-status').innerText = "LINK_DECRYPTED: YES (PER-62)";
                document.getElementById('crypto-status').style.color = "var(--success)";
                log("Encryption Umbrella synchronized. PER-62 data available.", "success");
                renderProgress();
            } catch (e) {
                alert("DECIPHER_ERROR: Master Key mismatch.");
            }
        }

        async function downloadArchive() {
            if (!masterKey) return alert("Establish DECRYPTED LINK before export.");

            const decryptedData = [];
            for (const p of allProgress) {
                if (p.encryptedState) {
                    try {
                        const plain = await CriticalCrypto.decrypt(p.encryptedState, masterKey);
                        decryptedData.push({ ...p, state: JSON.parse(plain), format: "DECRYPTED" });
                    } catch (e) {
                        decryptedData.push({ ...p, format: "LOCKED" });
                    }
                } else {
                    decryptedData.push({ ...p, format: "PLAINTEXT" });
                }
            }

            const blob = new Blob([JSON.stringify(decryptedData, null, 2)], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `situation_room_archive_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            log("Archive download triggered.", "success");
        }

        function importArchive(file) {
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    log(`Archive imported: ${data.length} records found.`, "success");
                    // Find a record to grade - preferably a decrypted one
                    const target = data.find(p => p.format === "DECRYPTED" && p.state && p.state.rat) || data[0]; // fallback
                    if (target) renderGradingInterface(target);
                    else alert("No assessable records found in archive.");
                } catch (err) {
                    alert("IMPORT_ERROR: Invalid JSON format.");
                }
            };
            reader.readAsText(file);
        }

        function renderGradingInterface(student) {
            document.getElementById('grading-panel').style.display = 'block';
            document.getElementById('grade-name').innerText = student.name;
            document.getElementById('grade-mission').innerText = "CUBA_62"; // Default for demo

            const state = student.state || {}; // Handle plaintext format difference if needed

            // Format Decisions
            let decH = "";
            if (state.dec) Object.keys(state.dec).forEach(k => decH += `STEP ${k}: ${state.dec[k]} | `);
            document.getElementById('grade-dec').innerText = decH || "NO DATA";

            // Format RAT
            let ratH = "";
            if (state.rat) Object.keys(state.rat).forEach(k => ratH += `"${state.rat[k]}"\n\n`);
            document.getElementById('grade-rat').innerText = ratH || "NO ANALYSIS SUBMITTED";

            // Format Reflection
            let ansH = "";
            if (state.ans) Object.keys(state.ans).forEach(k => ansH += `${k}: ${state.ans[k]}\n`);
            document.getElementById('grade-ans').innerText = ansH || "NO REFLECTION SUBMITTED";

            // AI Simulation
            const words = (ratH + ansH).split(/\s+/).length;
            const score = Math.min(100, 60 + Math.floor(words / 2)); // Simple heuristic
            document.getElementById('ai-score').innerText = `${score}/100`;
            document.getElementById('final-grade').value = score;

            // Scroll to grader
            document.getElementById('grading-panel').scrollIntoView({ behavior: 'smooth' });
        }

        function saveGrade() {
            const g = document.getElementById('final-grade').value;
            const f = document.getElementById('grade-feedback').value;
            alert(`GRADE SUBMITTED: ${g}/100\nFEEDBACK LOGGED: "${f}"`);
            document.getElementById('grading-panel').style.display = 'none';
            log("Assessment saved to local register.", "success");
        }

        function log(m, t = "info") {
            const c = document.getElementById('console');
            const color = t === "success" ? "lime" : t === "error" ? "red" : "#0f0";
            if (!c) return;
            c.innerHTML += `<div style="color:${color}">[${new Date().toLocaleTimeString()}] ${m}</div>`;
            c.scrollTop = c.scrollHeight;
        }

        async function fetchMissions() {
            log("Handshake successful. Demo Directory synchronized.", "success");
            const missions = [
                { id: "CUBA_62", name: "DEFCON 2: The 13 Days", thumb: "https://dwaugh-edsim.github.io/projectimages/cuba62/u2photos.jpg", aiEnabled: true },
                { id: "MIKMAW11", name: "The Trading Post", thumb: "http://dwaugh-edsim.github.io/projectimages/leo-sitroom2/images/truckhouse-map.jpg", aiEnabled: true }
            ];
            renderMissions(missions);
            renderProgress();
            updateClassFilter();
        }

        function fetchProgress() {
            log("Syncing offline student records...", "info");
            document.getElementById('sync-tick').innerText = "[DEMO_OK]";
            renderProgress();
            setTimeout(() => document.getElementById('sync-tick').innerText = "[SYNC_IDLE]", 2000);
        }

        function updateClassFilter() {
            const f = document.getElementById('class-filter');
            const classes = [...new Set(allProgress.map(p => p.class))].sort();
            let h = `<option value="ALL">ALL CLASSES</option>`;
            classes.forEach(c => { h += `<option value="${c}">${c}</option>`; });
            f.innerHTML = h;
        }

        function renderProgress() {
            const filter = document.getElementById('class-filter').value;
            const filtered = filter === "ALL" ? allProgress : allProgress.filter(p => p.class === filter);
            let h = "";
            filtered.forEach(p => {
                const missions = Object.keys(p.missionData || {});
                missions.forEach(mid => {
                    const st = p.missionData[mid];
                    const decs = Object.keys(st.dec || {}).length;
                    h += `<div style="padding:6px 10px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; gap:10px;">
                        <div style="flex:1; min-width:0;">
                            <div style="font-size:0.7rem; font-weight:bold;">${p.name} <span style="color:#888; font-weight:normal; font-size:0.65rem;">${p.class}</span></div>
                            <div style="color:#666; font-size:0.6rem; margin-top:2px;">MISSION: ${mid} | EXHIBIT: ${decs} / 6</div>
                        </div>
                        <div style="font-size:0.5rem; color:var(--success); font-weight:bold;">LOCAL DATA</div>
                      </div>`;
                });
            });
            document.getElementById('progress-list').innerHTML = h;
        }

        function renderMissions(missions) {
            const list = document.getElementById('library-list');
            let h = `<table><thead><tr><th>VISUAL</th><th>ID</th><th>NAME</th></tr></thead><tbody>`;
            missions.forEach(m => {
                h += `<tr>
                    <td><div style="width:40px; height:25px; background-image:url('${m.thumb}'); background-size:cover; background-position:center; border-radius:2px; border:1px solid #ccc;"></div></td>
                    <td>${m.id}</td>
                    <td>${m.name}</td>
                </tr>`;
            });
            h += `</tbody></table>`;
            list.innerHTML = h;
        }

        function toggleProjector() {
            const pv = document.getElementById('projector-view');
            pv.classList.toggle('active');
            if (pv.classList.contains('active')) renderProjectorBoard();
        }

        function renderProjectorBoard() {
            const board = document.getElementById('proj-board');
            const classFilter = document.getElementById('proj-class-filter');
            const missionFilter = document.getElementById('proj-mission-filter');

            const currentClass = classFilter.value;
            const currentMission = missionFilter.value;

            // Sort and render
            let h = "";
            allProgress.forEach(p => {
                Object.keys(p.missionData).forEach(mid => {
                    if (currentClass !== 'ALL' && p.class !== currentClass) return;
                    if (currentMission !== 'ALL' && mid !== currentMission) return;

                    const st = p.missionData[mid];
                    const steps = Object.keys(st.dec).length;
                    const pct = (steps / 6) * 100;

                    h += `<div class="proj-card active">
                        <div class="proj-name">${p.name}</div>
                        <div class="proj-class">${p.class} // ${mid}</div>
                        <div class="proj-stats">
                            <div><div style="color:#d2b48c; font-size:0.55rem;">STEP</div><div style="font-size:0.75rem; color:#fff;">${steps}</div></div>
                            <div><div style="color:#d2b48c; font-size:0.55rem;">STATUS</div><div style="font-size:0.65rem; color:#0f0;">ACTIVE</div></div>
                        </div>
                        <div class="proj-bar"><div class="proj-fill" style="width:${pct}%"></div></div>
                    </div>`;
                });
            });
            board.innerHTML = h;
        }

        window.onload = () => {
            log("BOOT SEQUENCE INITIATED...");
            fetchMissions();

            // Populate projector filters once
            const classFilter = document.getElementById('proj-class-filter');
            const missionFilter = document.getElementById('proj-mission-filter');
            const classes = [...new Set(allProgress.map(p => p.class))].sort();
            classes.forEach(c => { classFilter.innerHTML += `<option value="${c}">${c}</option>`; });
            missionFilter.innerHTML += `<option value="CUBA_62">CUBA_62</option><option value="MIKMAW11">MIKMAW11</option>`;
        };
    </script>
</body>

</html>