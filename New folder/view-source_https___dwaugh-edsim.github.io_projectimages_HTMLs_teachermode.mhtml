From: <Saved by Blink>
Snapshot-Content-Location: https://dwaugh-edsim.github.io/projectimages/HTMLs/teachermode.html
Subject: 
Date: Tue, 6 Jan 2026 18:13:42 -0400
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--FeyzHuLTMIljhGvj9jgptcWXZPnsbmmXKjbLzejwBg----"


------MultipartBoundary--FeyzHuLTMIljhGvj9jgptcWXZPnsbmmXKjbLzejwBg----
Content-Type: text/html
Content-ID: <frame-0A41032AF980B3C3E2FF583164D3504A@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: https://dwaugh-edsim.github.io/projectimages/HTMLs/teachermode.html

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html; charset=
=3DUTF-8"><meta name=3D"color-scheme" content=3D"light dark"></head><body><=
div class=3D"line-gutter-backdrop"></div><form autocomplete=3D"off"><label =
class=3D"line-wrap-control">Line wrap<input type=3D"checkbox" aria-label=3D=
"Line wrap"></label></form><table><tbody><tr><td class=3D"line-number" valu=
e=3D"1"></td><td class=3D"line-content"><span class=3D"html-doctype">&lt;!D=
OCTYPE html&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"2"><=
/td><td class=3D"line-content"><span class=3D"html-tag">&lt;html <span clas=
s=3D"html-attribute-name">lang</span>=3D"<span class=3D"html-attribute-valu=
e">en</span>" <span class=3D"html-attribute-name">data-theme</span>=3D"<spa=
n class=3D"html-attribute-value">dark</span>"&gt;</span></td></tr><tr><td c=
lass=3D"line-number" value=3D"3"></td><td class=3D"line-content"><br></td><=
/tr><tr><td class=3D"line-number" value=3D"4"></td><td class=3D"line-conten=
t"><span class=3D"html-tag">&lt;head&gt;</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"5"></td><td class=3D"line-content">    <span class=3D"=
html-tag">&lt;meta <span class=3D"html-attribute-name">charset</span>=3D"<s=
pan class=3D"html-attribute-value">UTF-8</span>"&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"6"></td><td class=3D"line-content">    <sp=
an class=3D"html-tag">&lt;meta <span class=3D"html-attribute-name">name</sp=
an>=3D"<span class=3D"html-attribute-value">viewport</span>" <span class=3D=
"html-attribute-name">content</span>=3D"<span class=3D"html-attribute-value=
">width=3Ddevice-width, initial-scale=3D1.0</span>"&gt;</span></td></tr><tr=
><td class=3D"line-number" value=3D"7"></td><td class=3D"line-content">    =
<span class=3D"html-tag">&lt;meta <span class=3D"html-attribute-name">http-=
equiv</span>=3D"<span class=3D"html-attribute-value">Cache-Control</span>" =
<span class=3D"html-attribute-name">content</span>=3D"<span class=3D"html-a=
ttribute-value">no-cache, no-store, must-revalidate</span>"&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"8"></td><td class=3D"line-conte=
nt">    <span class=3D"html-tag">&lt;meta <span class=3D"html-attribute-nam=
e">http-equiv</span>=3D"<span class=3D"html-attribute-value">Pragma</span>"=
 <span class=3D"html-attribute-name">content</span>=3D"<span class=3D"html-=
attribute-value">no-cache</span>"&gt;</span></td></tr><tr><td class=3D"line=
-number" value=3D"9"></td><td class=3D"line-content">    <span class=3D"htm=
l-tag">&lt;meta <span class=3D"html-attribute-name">http-equiv</span>=3D"<s=
pan class=3D"html-attribute-value">Expires</span>" <span class=3D"html-attr=
ibute-name">content</span>=3D"<span class=3D"html-attribute-value">0</span>=
"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"10"></td><td c=
lass=3D"line-content">    <span class=3D"html-tag">&lt;title&gt;</span>SITU=
ATION ROOM // COMMAND CENTER<span class=3D"html-tag">&lt;/title&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"11"></td><td class=3D"line-=
content">    <span class=3D"html-comment">&lt;!-- Tailwind CSS + DaisyUI vi=
a CDN --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"12"></t=
d><td class=3D"line-content">    <span class=3D"html-tag">&lt;link <span cl=
ass=3D"html-attribute-name">href</span>=3D"<a class=3D"html-attribute-value=
 html-resource-link" target=3D"_blank" href=3D"https://cdn.jsdelivr.net/npm=
/daisyui@4.12.14/dist/full.min.css" rel=3D"noreferrer noopener">https://cdn=
.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css</a>" <span class=3D"htm=
l-attribute-name">rel</span>=3D"<span class=3D"html-attribute-value">styles=
heet</span>" <span class=3D"html-attribute-name">type</span>=3D"<span class=
=3D"html-attribute-value">text/css</span>" /&gt;</span></td></tr><tr><td cl=
ass=3D"line-number" value=3D"13"></td><td class=3D"line-content">    <span =
class=3D"html-tag">&lt;script <span class=3D"html-attribute-name">src</span=
>=3D"<a class=3D"html-attribute-value html-resource-link" target=3D"_blank"=
 href=3D"https://cdn.tailwindcss.com/" rel=3D"noreferrer noopener">https://=
cdn.tailwindcss.com</a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"14"></td><td class=
=3D"line-content">    <span class=3D"html-tag">&lt;link <span class=3D"html=
-attribute-name">rel</span>=3D"<span class=3D"html-attribute-value">preconn=
ect</span>" <span class=3D"html-attribute-name">href</span>=3D"<a class=3D"=
html-attribute-value html-resource-link" target=3D"_blank" href=3D"https://=
fonts.googleapis.com/" rel=3D"noreferrer noopener">https://fonts.googleapis=
.com</a>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"15"></=
td><td class=3D"line-content">    <span class=3D"html-tag">&lt;link <span c=
lass=3D"html-attribute-name">href</span>=3D"<a class=3D"html-attribute-valu=
e html-resource-link" target=3D"_blank" href=3D"https://fonts.googleapis.co=
m/css2?family=3DInter:wght@400;600;700&amp;family=3DOswald:wght@700&amp;dis=
play=3Dswap" rel=3D"noreferrer noopener">https://fonts.googleapis.com/css2?=
family=3DInter:wght@400;600;700&amp;family=3DOswald:wght@700&amp;display=3D=
swap</a>"</span></td></tr><tr><td class=3D"line-number" value=3D"16"></td><=
td class=3D"line-content">        <span class=3D"html-attribute-name">rel</=
span>=3D"<span class=3D"html-attribute-value">stylesheet</span>"&gt;</td></=
tr><tr><td class=3D"line-number" value=3D"17"></td><td class=3D"line-conten=
t">    <span class=3D"html-tag">&lt;link <span class=3D"html-attribute-name=
">rel</span>=3D"<span class=3D"html-attribute-value">icon</span>" <span cla=
ss=3D"html-attribute-name">type</span>=3D"<span class=3D"html-attribute-val=
ue">image/png</span>" <span class=3D"html-attribute-name">href</span>=3D"<a=
 class=3D"html-attribute-value html-resource-link" target=3D"_blank" href=
=3D"https://dwaugh-edsim.github.io/projectimages/HTMLs/images/logic_gear_lo=
go.png" rel=3D"noreferrer noopener">images/logic_gear_logo.png</a>"&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"18"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"19"></td>=
<td class=3D"line-content">    <span class=3D"html-comment">&lt;!-- SYSTEM =
SCRIPTS --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"20"><=
/td><td class=3D"line-content">    <span class=3D"html-tag">&lt;script <spa=
n class=3D"html-attribute-name">src</span>=3D"<a class=3D"html-attribute-va=
lue html-resource-link" target=3D"_blank" href=3D"https://dwaugh-edsim.gith=
ub.io/projectimages/HTMLs/config.js" rel=3D"noreferrer noopener">config.js<=
/a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;</span></td></tr><tr=
><td class=3D"line-number" value=3D"21"></td><td class=3D"line-content">   =
 <span class=3D"html-tag">&lt;script&gt;</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"22"></td><td class=3D"line-content">        // --- BOO=
TSTRAP CONFIGURATION (Global Infrastructure) ---</td></tr><tr><td class=3D"=
line-number" value=3D"23"></td><td class=3D"line-content">        const SB_=
URL =3D "https://zwujpkuguevnkcqrkhas.supabase.co";</td></tr><tr><td class=
=3D"line-number" value=3D"24"></td><td class=3D"line-content">        const=
 SB_KEY =3D "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsI=
nJlZiI6Inp3dWpwa3VndWV2bmtjcXJraGFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjczODA0=
NDQsImV4cCI6MjA4Mjk1NjQ0NH0.H9tVz_expVsE7VLLLLEsnTMVsm5PQ09r7KlLe85MirA";</=
td></tr><tr><td class=3D"line-number" value=3D"25"></td><td class=3D"line-c=
ontent">        const TEACHER_HANDLE =3D localStorage.getItem('TM_TEACHER_H=
ANDLE') || (typeof CONFIG !=3D=3D 'undefined' ? CONFIG.TEACHER_ID : 'GUEST'=
);</td></tr><tr><td class=3D"line-number" value=3D"26"></td><td class=3D"li=
ne-content">        let GOOGLE_CLIENT_ID =3D localStorage.getItem('TM_GCP_C=
LIENT_ID') || "985904065235-u0115ektel546fs42mar5rch46utkki6.apps.googleuse=
rcontent.com";</td></tr><tr><td class=3D"line-number" value=3D"27"></td><td=
 class=3D"line-content">        const HARDWIRED_PROXY =3D "https://nextjs-b=
asic-lemon-one.vercel.app/api/chat";</td></tr><tr><td class=3D"line-number"=
 value=3D"28"></td><td class=3D"line-content">    <span class=3D"html-tag">=
&lt;/script&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"29">=
</td><td class=3D"line-content">    <span class=3D"html-tag">&lt;script <sp=
an class=3D"html-attribute-name">src</span>=3D"<a class=3D"html-attribute-v=
alue html-resource-link" target=3D"_blank" href=3D"https://dwaugh-edsim.git=
hub.io/projectimages/HTMLs/critical_crypto.js" rel=3D"noreferrer noopener">=
critical_crypto.js</a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"30"></td><td class=
=3D"line-content">    <span class=3D"html-tag">&lt;script <span class=3D"ht=
ml-attribute-name">src</span>=3D"<a class=3D"html-attribute-value html-reso=
urce-link" target=3D"_blank" href=3D"https://accounts.google.com/gsi/client=
" rel=3D"noreferrer noopener">https://accounts.google.com/gsi/client</a>" <=
span class=3D"html-attribute-name">async</span> <span class=3D"html-attribu=
te-name">defer</span>&gt;</span><span class=3D"html-tag">&lt;/script&gt;</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"31"></td><td class=3D"=
line-content">    <span class=3D"html-tag">&lt;script <span class=3D"html-a=
ttribute-name">src</span>=3D"<a class=3D"html-attribute-value html-resource=
-link" target=3D"_blank" href=3D"https://cdn.jsdelivr.net/npm/marked/marked=
.min.js" rel=3D"noreferrer noopener">https://cdn.jsdelivr.net/npm/marked/ma=
rked.min.js</a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"32"></td><td class=3D"line-=
content">    <span class=3D"html-tag">&lt;script <span class=3D"html-attrib=
ute-name">src</span>=3D"<a class=3D"html-attribute-value html-resource-link=
" target=3D"_blank" href=3D"https://cdn.jsdelivr.net/npm/@supabase/supabase=
-js@2" rel=3D"noreferrer noopener">https://cdn.jsdelivr.net/npm/@supabase/s=
upabase-js@2</a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;</span>=
</td></tr><tr><td class=3D"line-number" value=3D"33"></td><td class=3D"line=
-content">    <span class=3D"html-comment">&lt;!-- Quill Rich Text Editor (=
Legacy Port) --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
34"></td><td class=3D"line-content">    <span class=3D"html-tag">&lt;script=
 <span class=3D"html-attribute-name">src</span>=3D"<a class=3D"html-attribu=
te-value html-resource-link" target=3D"_blank" href=3D"https://cdn.quilljs.=
com/1.3.6/quill.min.js" rel=3D"noreferrer noopener">https://cdn.quilljs.com=
/1.3.6/quill.min.js</a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"35"></td><td class=
=3D"line-content">    <span class=3D"html-tag">&lt;script <span class=3D"ht=
ml-attribute-name">src</span>=3D"<a class=3D"html-attribute-value html-reso=
urce-link" target=3D"_blank" href=3D"https://unpkg.com/turndown/dist/turndo=
wn.js" rel=3D"noreferrer noopener">https://unpkg.com/turndown/dist/turndown=
.js</a>"&gt;</span><span class=3D"html-tag">&lt;/script&gt;</span></td></tr=
><tr><td class=3D"line-number" value=3D"36"></td><td class=3D"line-content"=
>    <span class=3D"html-tag">&lt;script <span class=3D"html-attribute-name=
">src</span>=3D"<a class=3D"html-attribute-value html-resource-link" target=
=3D"_blank" href=3D"https://dwaugh-edsim.github.io/projectimages/HTMLs/supa=
base_bridge.js" rel=3D"noreferrer noopener">supabase_bridge.js</a>"&gt;</sp=
an><span class=3D"html-tag">&lt;/script&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"37"></td><td class=3D"line-content">    <span cla=
ss=3D"html-tag">&lt;link <span class=3D"html-attribute-name">href</span>=3D=
"<a class=3D"html-attribute-value html-resource-link" target=3D"_blank" hre=
f=3D"https://cdn.quilljs.com/1.3.6/quill.snow.css" rel=3D"noreferrer noopen=
er">https://cdn.quilljs.com/1.3.6/quill.snow.css</a>" <span class=3D"html-a=
ttribute-name">rel</span>=3D"<span class=3D"html-attribute-value">styleshee=
t</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"38"></=
td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" v=
alue=3D"39"></td><td class=3D"line-content">    <span class=3D"html-tag">&l=
t;style&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"40"></td=
><td class=3D"line-content">        body {</td></tr><tr><td class=3D"line-n=
umber" value=3D"41"></td><td class=3D"line-content">            font-family=
: 'Inter', sans-serif;</td></tr><tr><td class=3D"line-number" value=3D"42">=
</td><td class=3D"line-content">        }</td></tr><tr><td class=3D"line-nu=
mber" value=3D"43"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"44"></td><td class=3D"line-content">        .f=
ont-display {</td></tr><tr><td class=3D"line-number" value=3D"45"></td><td =
class=3D"line-content">            font-family: 'Oswald', sans-serif;</td><=
/tr><tr><td class=3D"line-number" value=3D"46"></td><td class=3D"line-conte=
nt">        }</td></tr><tr><td class=3D"line-number" value=3D"47"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"48"></td><td class=3D"line-content">        .font-mono {</td></tr><tr><td =
class=3D"line-number" value=3D"49"></td><td class=3D"line-content">        =
    font-family: 'JetBrains Mono', monospace;</td></tr><tr><td class=3D"lin=
e-number" value=3D"50"></td><td class=3D"line-content">        }</td></tr><=
tr><td class=3D"line-number" value=3D"51"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"52"></td><td class=3D"l=
ine-content">        /* Legacy Scrollbar Patch */</td></tr><tr><td class=3D=
"line-number" value=3D"53"></td><td class=3D"line-content">        ::-webki=
t-scrollbar {</td></tr><tr><td class=3D"line-number" value=3D"54"></td><td =
class=3D"line-content">            width: 8px;</td></tr><tr><td class=3D"li=
ne-number" value=3D"55"></td><td class=3D"line-content">            height:=
 8px;</td></tr><tr><td class=3D"line-number" value=3D"56"></td><td class=3D=
"line-content">        }</td></tr><tr><td class=3D"line-number" value=3D"57=
"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numbe=
r" value=3D"58"></td><td class=3D"line-content">        ::-webkit-scrollbar=
-track {</td></tr><tr><td class=3D"line-number" value=3D"59"></td><td class=
=3D"line-content">            background: #0f0f0f;</td></tr><tr><td class=
=3D"line-number" value=3D"60"></td><td class=3D"line-content">        }</td=
></tr><tr><td class=3D"line-number" value=3D"61"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"62"></td><td cla=
ss=3D"line-content">        ::-webkit-scrollbar-thumb {</td></tr><tr><td cl=
ass=3D"line-number" value=3D"63"></td><td class=3D"line-content">          =
  background: #333;</td></tr><tr><td class=3D"line-number" value=3D"64"></t=
d><td class=3D"line-content">            border-radius: 4px;</td></tr><tr><=
td class=3D"line-number" value=3D"65"></td><td class=3D"line-content">     =
   }</td></tr><tr><td class=3D"line-number" value=3D"66"></td><td class=3D"=
line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"67"></td=
><td class=3D"line-content">        ::-webkit-scrollbar-thumb:hover {</td><=
/tr><tr><td class=3D"line-number" value=3D"68"></td><td class=3D"line-conte=
nt">            background: #555;</td></tr><tr><td class=3D"line-number" va=
lue=3D"69"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"70"></td><td class=3D"line-content"><br></td></tr=
><tr><td class=3D"line-number" value=3D"71"></td><td class=3D"line-content"=
>        /* Smooth Tabs Transition */</td></tr><tr><td class=3D"line-number=
" value=3D"72"></td><td class=3D"line-content">        .tab-content {</td><=
/tr><tr><td class=3D"line-number" value=3D"73"></td><td class=3D"line-conte=
nt">            transition: all 0.2s ease-in-out;</td></tr><tr><td class=3D=
"line-number" value=3D"74"></td><td class=3D"line-content">        }</td></=
tr><tr><td class=3D"line-number" value=3D"75"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"76"></td><td class=
=3D"line-content">        /* Animations */</td></tr><tr><td class=3D"line-n=
umber" value=3D"77"></td><td class=3D"line-content">        @keyframes fade=
In {</td></tr><tr><td class=3D"line-number" value=3D"78"></td><td class=3D"=
line-content">            from {</td></tr><tr><td class=3D"line-number" val=
ue=3D"79"></td><td class=3D"line-content">                opacity: 0;</td><=
/tr><tr><td class=3D"line-number" value=3D"80"></td><td class=3D"line-conte=
nt">                transform: translateY(10px);</td></tr><tr><td class=3D"=
line-number" value=3D"81"></td><td class=3D"line-content">            }</td=
></tr><tr><td class=3D"line-number" value=3D"82"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"83"></td><td cla=
ss=3D"line-content">            to {</td></tr><tr><td class=3D"line-number"=
 value=3D"84"></td><td class=3D"line-content">                opacity: 1;</=
td></tr><tr><td class=3D"line-number" value=3D"85"></td><td class=3D"line-c=
ontent">                transform: translateY(0);</td></tr><tr><td class=3D=
"line-number" value=3D"86"></td><td class=3D"line-content">            }</t=
d></tr><tr><td class=3D"line-number" value=3D"87"></td><td class=3D"line-co=
ntent">        }</td></tr><tr><td class=3D"line-number" value=3D"88"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"89"></td><td class=3D"line-content">        .animate-fade-in {</td></tr=
><tr><td class=3D"line-number" value=3D"90"></td><td class=3D"line-content"=
>            animation: fadeIn 0.3s ease-out forwards;</td></tr><tr><td cla=
ss=3D"line-number" value=3D"91"></td><td class=3D"line-content">        }</=
td></tr><tr><td class=3D"line-number" value=3D"92"></td><td class=3D"line-c=
ontent">    <span class=3D"html-tag">&lt;/style&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"93"></td><td class=3D"line-content"><span c=
lass=3D"html-tag">&lt;/head&gt;</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"94"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"95"></td><td class=3D"line-content"><span class=
=3D"html-tag">&lt;body <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">min-h-screen bg-base-300 text-base-con=
tent overflow-hidden flex flex-col</span>"&gt;</span></td></tr><tr><td clas=
s=3D"line-number" value=3D"96"></td><td class=3D"line-content"><br></td></t=
r><tr><td class=3D"line-number" value=3D"97"></td><td class=3D"line-content=
">    <span class=3D"html-comment">&lt;!-- TOP NAVBAR --&gt;</span></td></t=
r><tr><td class=3D"line-number" value=3D"98"></td><td class=3D"line-content=
">    <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">=
class</span>=3D"<span class=3D"html-attribute-value">navbar bg-base-100 bor=
der-b border-base-content/10 px-4 h-16 flex-none z-50 shadow-md</span>"&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"99"></td><td class=
=3D"line-content">        <span class=3D"html-tag">&lt;div <span class=3D"h=
tml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">fl=
ex-1 gap-4 flex items-center</span>"&gt;</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"100"></td><td class=3D"line-content">            <span=
 class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span=
>=3D"<span class=3D"html-attribute-value">flex items-center gap-3 mr-4</spa=
n>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"101"></td><t=
d class=3D"line-content">                <span class=3D"html-tag">&lt;img <=
span class=3D"html-attribute-name">src</span>=3D"<a class=3D"html-attribute=
-value html-resource-link" target=3D"_blank" href=3D"https://dwaugh-edsim.g=
ithub.io/projectimages/HTMLs/images/logic_gear_logo.png" rel=3D"noreferrer =
noopener">images/logic_gear_logo.png</a>" <span class=3D"html-attribute-nam=
e">class</span>=3D"<span class=3D"html-attribute-value">h-8 w-8 drop-shadow=
-[0_0_5px_rgba(0,255,204,0.5)]</span>"&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"102"></td><td class=3D"line-content">               =
 <span class=3D"html-tag">&lt;div&gt;</span></td></tr><tr><td class=3D"line=
-number" value=3D"103"></td><td class=3D"line-content">                    =
<span class=3D"html-tag">&lt;h1 <span class=3D"html-attribute-name">class</=
span>=3D"<span class=3D"html-attribute-value">text-xl font-display tracking=
-widest text-primary leading-none</span>"&gt;</span>SITUATION ROOM<span cla=
ss=3D"html-tag">&lt;/h1&gt;</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"104"></td><td class=3D"line-content">                    <span clas=
s=3D"html-tag">&lt;button</span></td></tr><tr><td class=3D"line-number" val=
ue=3D"105"></td><td class=3D"line-content">                        <span cl=
ass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-v=
alue">btn btn-xs btn-ghost text-[0.6rem] font-mono opacity-50 tracking-wide=
st hover:opacity-100 hidden</span>"</td></tr><tr><td class=3D"line-number" =
value=3D"106"></td><td class=3D"line-content">                        <span=
 class=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-attrib=
ute-value">openSettings()</span>"&gt;COMMAND CENTER v3.0 // CONFIG<span cla=
ss=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"107"></td><td class=3D"line-content">                    <span =
class=3D"html-comment">&lt;!-- HIDDEN CONSOLE REFERENCE FOR JS --&gt;</span=
></td></tr><tr><td class=3D"line-number" value=3D"108"></td><td class=3D"li=
ne-content">                    <span class=3D"html-tag">&lt;div <span clas=
s=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-value"=
>log-parent</span>" <span class=3D"html-attribute-name">style</span>=3D"<sp=
an class=3D"html-attribute-value">display:none;</span>"&gt;</span></td></tr=
><tr><td class=3D"line-number" value=3D"109"></td><td class=3D"line-content=
">                        <span class=3D"html-tag">&lt;div <span class=3D"h=
tml-attribute-name">id</span>=3D"<span class=3D"html-attribute-value">sm-co=
nsole</span>"&gt;</span><span class=3D"html-tag">&lt;/div&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"110"></td><td class=3D"line-conte=
nt">                    <span class=3D"html-tag">&lt;/div&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"111"></td><td class=3D"line-conte=
nt">                <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"112"></td><td class=3D"line-content">=
            <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td c=
lass=3D"line-number" value=3D"113"></td><td class=3D"line-content"><br></td=
></tr><tr><td class=3D"line-number" value=3D"114"></td><td class=3D"line-co=
ntent">            <span class=3D"html-comment">&lt;!-- TAB NAVIGATION (MOV=
ED FROM SIDEBAR) --&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"115"></td><td class=3D"line-content">            <span class=3D"html-ta=
g">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">flex items-center gap-1 join</span>"&gt;</span></=
td></tr><tr><td class=3D"line-number" value=3D"116"></td><td class=3D"line-=
content">                <span class=3D"html-tag">&lt;button <span class=3D=
"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">=
btn btn-sm btn-ghost font-bold join-item</span>" <span class=3D"html-attrib=
ute-name">onclick</span>=3D"<span class=3D"html-attribute-value">switchMain=
Tab('dashboard')</span>"&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"117"></td><td class=3D"line-content">                    <span cla=
ss=3D"html-tag">&lt;svg <span class=3D"html-attribute-name">xmlns</span>=3D=
"<span class=3D"html-attribute-value">http://www.w3.org/2000/svg</span>" <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">h-4 w-4 mr-1</span>" <span class=3D"html-attribute-name">fill</=
span>=3D"<span class=3D"html-attribute-value">none</span>" <span class=3D"h=
tml-attribute-name">viewBox</span>=3D"<span class=3D"html-attribute-value">=
0 0 24 24</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"11=
8"></td><td class=3D"line-content">                        <span class=3D"h=
tml-attribute-name">stroke</span>=3D"<span class=3D"html-attribute-value">c=
urrentColor</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"119=
"></td><td class=3D"line-content">                        <span class=3D"ht=
ml-tag">&lt;path <span class=3D"html-attribute-name">stroke-linecap</span>=
=3D"<span class=3D"html-attribute-value">round</span>" <span class=3D"html-=
attribute-name">stroke-linejoin</span>=3D"<span class=3D"html-attribute-val=
ue">round</span>" <span class=3D"html-attribute-name">stroke-width</span>=
=3D"<span class=3D"html-attribute-value">2</span>"</span></td></tr><tr><td =
class=3D"line-number" value=3D"120"></td><td class=3D"line-content">       =
                     <span class=3D"html-attribute-name">d</span>=3D"<span =
class=3D"html-attribute-value">M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 =
2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 =
01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM=
14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z</span>" =
/&gt;</td></tr><tr><td class=3D"line-number" value=3D"121"></td><td class=
=3D"line-content">                    <span class=3D"html-tag">&lt;/svg&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"122"></td><td class=
=3D"line-content">                    DASHBOARD</td></tr><tr><td class=3D"l=
ine-number" value=3D"123"></td><td class=3D"line-content">                <=
span class=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"124"></td><td class=3D"line-content">                <s=
pan class=3D"html-tag">&lt;button <span class=3D"html-attribute-name">class=
</span>=3D"<span class=3D"html-attribute-value">btn btn-sm btn-ghost font-b=
old join-item</span>" <span class=3D"html-attribute-name">onclick</span>=3D=
"<span class=3D"html-attribute-value">switchMainTab('Builder')</span>"&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"125"></td><td class=
=3D"line-content">                    <span class=3D"html-tag">&lt;svg <spa=
n class=3D"html-attribute-name">xmlns</span>=3D"<span class=3D"html-attribu=
te-value">http://www.w3.org/2000/svg</span>" <span class=3D"html-attribute-=
name">class</span>=3D"<span class=3D"html-attribute-value">h-4 w-4 mr-1</sp=
an>" <span class=3D"html-attribute-name">fill</span>=3D"<span class=3D"html=
-attribute-value">none</span>" <span class=3D"html-attribute-name">viewBox<=
/span>=3D"<span class=3D"html-attribute-value">0 0 24 24</span>"</span></td=
></tr><tr><td class=3D"line-number" value=3D"126"></td><td class=3D"line-co=
ntent">                        <span class=3D"html-attribute-name">stroke</=
span>=3D"<span class=3D"html-attribute-value">currentColor</span>"&gt;</td>=
</tr><tr><td class=3D"line-number" value=3D"127"></td><td class=3D"line-con=
tent">                        <span class=3D"html-tag">&lt;path <span class=
=3D"html-attribute-name">stroke-linecap</span>=3D"<span class=3D"html-attri=
bute-value">round</span>" <span class=3D"html-attribute-name">stroke-linejo=
in</span>=3D"<span class=3D"html-attribute-value">round</span>" <span class=
=3D"html-attribute-name">stroke-width</span>=3D"<span class=3D"html-attribu=
te-value">2</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"=
128"></td><td class=3D"line-content">                            <span clas=
s=3D"html-attribute-name">d</span>=3D"<span class=3D"html-attribute-value">=
M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a=
6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.5=
86 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.4=
14-3.414l5-5A2 2 0 009 10.172V5L8 4z</span>" /&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"129"></td><td class=3D"line-content">            =
        <span class=3D"html-tag">&lt;/svg&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"130"></td><td class=3D"line-content">            =
        BUILDER</td></tr><tr><td class=3D"line-number" value=3D"131"></td><=
td class=3D"line-content">                <span class=3D"html-tag">&lt;/but=
ton&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"132"></td><t=
d class=3D"line-content">                <span class=3D"html-tag">&lt;butto=
n <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-a=
ttribute-value">btn btn-sm btn-ghost font-bold join-item</span>" <span clas=
s=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-attribute-v=
alue">switchMainTab('classes')</span>"&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"133"></td><td class=3D"line-content">               =
     <span class=3D"html-tag">&lt;svg <span class=3D"html-attribute-name">x=
mlns</span>=3D"<span class=3D"html-attribute-value">http://www.w3.org/2000/=
svg</span>" <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">h-4 w-4 mr-1</span>" <span class=3D"html-attribut=
e-name">fill</span>=3D"<span class=3D"html-attribute-value">none</span>" <s=
pan class=3D"html-attribute-name">viewBox</span>=3D"<span class=3D"html-att=
ribute-value">0 0 24 24</span>"</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"134"></td><td class=3D"line-content">                        <s=
pan class=3D"html-attribute-name">stroke</span>=3D"<span class=3D"html-attr=
ibute-value">currentColor</span>"&gt;</td></tr><tr><td class=3D"line-number=
" value=3D"135"></td><td class=3D"line-content">                        <sp=
an class=3D"html-tag">&lt;path <span class=3D"html-attribute-name">stroke-l=
inecap</span>=3D"<span class=3D"html-attribute-value">round</span>" <span c=
lass=3D"html-attribute-name">stroke-linejoin</span>=3D"<span class=3D"html-=
attribute-value">round</span>" <span class=3D"html-attribute-name">stroke-w=
idth</span>=3D"<span class=3D"html-attribute-value">2</span>"</span></td></=
tr><tr><td class=3D"line-number" value=3D"136"></td><td class=3D"line-conte=
nt">                            <span class=3D"html-attribute-name">d</span=
>=3D"<span class=3D"html-attribute-value">M12 4.354a4 4 0 110 5.292M15 21H3=
v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0=
z</span>" /&gt;</td></tr><tr><td class=3D"line-number" value=3D"137"></td><=
td class=3D"line-content">                    <span class=3D"html-tag">&lt;=
/svg&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"138"></td><=
td class=3D"line-content">                    CLASSES</td></tr><tr><td clas=
s=3D"line-number" value=3D"139"></td><td class=3D"line-content">           =
     <span class=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"140"></td><td class=3D"line-content">            =
    <span class=3D"html-tag">&lt;button <span class=3D"html-attribute-name"=
>class</span>=3D"<span class=3D"html-attribute-value">btn btn-sm btn-ghost =
font-bold join-item</span>" <span class=3D"html-attribute-name">onclick</sp=
an>=3D"<span class=3D"html-attribute-value">switchMainTab('library')</span>=
"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"141"></td><td =
class=3D"line-content">                    <span class=3D"html-tag">&lt;svg=
 <span class=3D"html-attribute-name">xmlns</span>=3D"<span class=3D"html-at=
tribute-value">http://www.w3.org/2000/svg</span>" <span class=3D"html-attri=
bute-name">class</span>=3D"<span class=3D"html-attribute-value">h-4 w-4 mr-=
1</span>" <span class=3D"html-attribute-name">fill</span>=3D"<span class=3D=
"html-attribute-value">none</span>" <span class=3D"html-attribute-name">vie=
wBox</span>=3D"<span class=3D"html-attribute-value">0 0 24 24</span>"</span=
></td></tr><tr><td class=3D"line-number" value=3D"142"></td><td class=3D"li=
ne-content">                        <span class=3D"html-attribute-name">str=
oke</span>=3D"<span class=3D"html-attribute-value">currentColor</span>"&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"143"></td><td class=3D"lin=
e-content">                        <span class=3D"html-tag">&lt;path <span =
class=3D"html-attribute-name">stroke-linecap</span>=3D"<span class=3D"html-=
attribute-value">round</span>" <span class=3D"html-attribute-name">stroke-l=
inejoin</span>=3D"<span class=3D"html-attribute-value">round</span>" <span =
class=3D"html-attribute-name">stroke-width</span>=3D"<span class=3D"html-at=
tribute-value">2</span>"</span></td></tr><tr><td class=3D"line-number" valu=
e=3D"144"></td><td class=3D"line-content">                            <span=
 class=3D"html-attribute-name">d</span>=3D"<span class=3D"html-attribute-va=
lue">M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z</span=
>" /&gt;</td></tr><tr><td class=3D"line-number" value=3D"145"></td><td clas=
s=3D"line-content">                    <span class=3D"html-tag">&lt;/svg&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"146"></td><td clas=
s=3D"line-content">                    LIBRARY</td></tr><tr><td class=3D"li=
ne-number" value=3D"147"></td><td class=3D"line-content">                <s=
pan class=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"lin=
e-number" value=3D"148"></td><td class=3D"line-content">            <span c=
lass=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"149"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"150"></td><td class=3D"line-content">            =
<span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class<=
/span>=3D"<span class=3D"html-attribute-value">flex-1</span>"&gt;</span><sp=
an class=3D"html-tag">&lt;/div&gt;</span> <span class=3D"html-comment">&lt;=
!-- Spacer --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"15=
1"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"152"></td><td class=3D"line-content">            <span class=
=3D"html-comment">&lt;!-- GLOBAL STATUS BADGES --&gt;</span></td></tr><tr><=
td class=3D"line-number" value=3D"153"></td><td class=3D"line-content">    =
        <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name=
">class</span>=3D"<span class=3D"html-attribute-value">flex gap-2</span>"&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"154"></td><td cla=
ss=3D"line-content">                <span class=3D"html-tag">&lt;div <span =
class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-va=
lue">status-badge-sb</span>" <span class=3D"html-attribute-name">class</spa=
n>=3D"<span class=3D"html-attribute-value">badge badge-outline badge-xs gap=
-1 font-mono</span>"&gt;</span></td></tr><tr><td class=3D"line-number" valu=
e=3D"155"></td><td class=3D"line-content">                    <span class=
=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<=
span class=3D"html-attribute-value">w-1.5 h-1.5 rounded-full bg-error</span=
>"&gt;</span><span class=3D"html-tag">&lt;/div&gt;</span> SB_OFFLINE</td></=
tr><tr><td class=3D"line-number" value=3D"156"></td><td class=3D"line-conte=
nt">                <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"157"></td><td class=3D"line-content">=
                <span class=3D"html-tag">&lt;div <span class=3D"html-attrib=
ute-name">id</span>=3D"<span class=3D"html-attribute-value">status-badge-au=
th</span>" <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">badge badge-outline badge-xs gap-1 font-mono opac=
ity-50</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"1=
58"></td><td class=3D"line-content">                    GUEST</td></tr><tr>=
<td class=3D"line-number" value=3D"159"></td><td class=3D"line-content">   =
             <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td =
class=3D"line-number" value=3D"160"></td><td class=3D"line-content">       =
     <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"161"></td><td class=3D"line-content">        <span c=
lass=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"162"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"163"></td><td class=3D"line-content">        <spa=
n class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</spa=
n>=3D"<span class=3D"html-attribute-value">flex-none gap-2</span>"&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"164"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"165"></td=
><td class=3D"line-content">            <span class=3D"html-tag">&lt;div <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">dropdown dropdown-end</span>"&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"166"></td><td class=3D"line-content">            =
    <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">ta=
bindex</span>=3D"<span class=3D"html-attribute-value">0</span>" <span class=
=3D"html-attribute-name">role</span>=3D"<span class=3D"html-attribute-value=
">button</span>" <span class=3D"html-attribute-name">class</span>=3D"<span =
class=3D"html-attribute-value">btn btn-ghost btn-circle avatar placeholder<=
/span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"167"></t=
d><td class=3D"line-content">                    <span class=3D"html-tag">&=
lt;div <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"h=
tml-attribute-value">bg-neutral text-neutral-content rounded-full w-8</span=
>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"168"></td><td=
 class=3D"line-content">                        <span class=3D"html-tag">&l=
t;span <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html=
-attribute-value">user-avatar-initials</span>"&gt;</span>G<span class=3D"ht=
ml-tag">&lt;/span&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"169"></td><td class=3D"line-content">                    <span class=3D=
"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"170"></td><td class=3D"line-content">                <span class=3D"htm=
l-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
171"></td><td class=3D"line-content">                <span class=3D"html-ta=
g">&lt;ul <span class=3D"html-attribute-name">tabindex</span>=3D"<span clas=
s=3D"html-attribute-value">0</span>"</span></td></tr><tr><td class=3D"line-=
number" value=3D"172"></td><td class=3D"line-content">                    <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-10=
0 rounded-box w-52</span>"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"173"></td><td class=3D"line-content">                    <span class=3D=
"html-tag">&lt;li&gt;</span><span class=3D"html-tag">&lt;a <span class=3D"h=
tml-attribute-name">onclick</span>=3D"<span class=3D"html-attribute-value">=
openAuthModal()</span>"&gt;</span>Google Sign-In<span class=3D"html-tag">&l=
t;/a&gt;</span><span class=3D"html-tag">&lt;/li&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"174"></td><td class=3D"line-content">      =
              <span class=3D"html-tag">&lt;li&gt;</span><span class=3D"html=
-tag">&lt;a <span class=3D"html-attribute-name">onclick</span>=3D"<span cla=
ss=3D"html-attribute-value">googleLogout()</span>" <span class=3D"html-attr=
ibute-name">class</span>=3D"<span class=3D"html-attribute-value">text-error=
</span>"&gt;</span>Log Out<span class=3D"html-tag">&lt;/a&gt;</span><span c=
lass=3D"html-tag">&lt;/li&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"175"></td><td class=3D"line-content">                    <span cl=
ass=3D"html-tag">&lt;li&gt;</span><span class=3D"html-tag">&lt;a <span clas=
s=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-attribute-v=
alue">toggleAboutModal()</span>"&gt;</span>About System<span class=3D"html-=
tag">&lt;/a&gt;</span><span class=3D"html-tag">&lt;/li&gt;</span></td></tr>=
<tr><td class=3D"line-number" value=3D"176"></td><td class=3D"line-content"=
>                    <span class=3D"html-tag">&lt;li&gt;</span><span class=
=3D"html-tag">&lt;a <span class=3D"html-attribute-name">onclick</span>=3D"<=
span class=3D"html-attribute-value">document.documentElement.setAttribute('=
data-theme', 'light')</span>"&gt;</span>Light Mode<span class=3D"html-tag">=
&lt;/a&gt;</span><span class=3D"html-tag">&lt;/li&gt;</span></td></tr><tr><=
td class=3D"line-number" value=3D"177"></td><td class=3D"line-content">    =
                <span class=3D"html-tag">&lt;li&gt;</span><span class=3D"ht=
ml-tag">&lt;a <span class=3D"html-attribute-name">onclick</span>=3D"<span c=
lass=3D"html-attribute-value">document.documentElement.setAttribute('data-t=
heme', 'dark')</span>"&gt;</span>Dark Mode<span class=3D"html-tag">&lt;/a&g=
t;</span><span class=3D"html-tag">&lt;/li&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"178"></td><td class=3D"line-content">            =
        <span class=3D"html-comment">&lt;!-- Hidden Admin Access --&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"179"></td><td class=3D"=
line-content">                    <span class=3D"html-tag">&lt;li&gt;</span=
><span class=3D"html-tag">&lt;a <span class=3D"html-attribute-name">onclick=
</span>=3D"<span class=3D"html-attribute-value">openSettings()</span>" <spa=
n class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribu=
te-value">text-xs opacity-20 hover:opacity-100</span>"&gt;</span>System Adm=
in<span class=3D"html-tag">&lt;/a&gt;</span><span class=3D"html-tag">&lt;/l=
i&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"180"></td><td =
class=3D"line-content">                <span class=3D"html-tag">&lt;/ul&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"181"></td><td class=
=3D"line-content">            <span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"182"></td><td class=3D"line=
-content">        <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr=
><td class=3D"line-number" value=3D"183"></td><td class=3D"line-content">  =
  <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"184"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"185"></td><td class=3D"line-content">   =
 <span class=3D"html-comment">&lt;!-- MAIN APP SHELL --&gt;</span></td></tr=
><tr><td class=3D"line-number" value=3D"186"></td><td class=3D"line-content=
">    <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">=
class</span>=3D"<span class=3D"html-attribute-value">flex-1 flex overflow-h=
idden</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"18=
7"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"188"></td><td class=3D"line-content">        <span class=3D"ht=
ml-comment">&lt;!-- SIDEBAR NAVIGATION --&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"189"></td><td class=3D"line-content"><br></td></t=
r><tr><td class=3D"line-number" value=3D"190"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"191"></td><td class=
=3D"line-content">        <span class=3D"html-comment">&lt;!-- MAIN CONTENT=
 AREA --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"192"></=
td><td class=3D"line-content">        <span class=3D"html-tag">&lt;div <spa=
n class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribu=
te-value">flex-1 bg-base-300 p-6 overflow-y-auto relative</span>" <span cla=
ss=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-value=
">main-scroll-area</span>"&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"193"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"194"></td><td class=3D"line-content">            =
<span class=3D"html-comment">&lt;!-- VIEW: DASHBOARD --&gt;</span></td></tr=
><tr><td class=3D"line-number" value=3D"195"></td><td class=3D"line-content=
">            <span class=3D"html-tag">&lt;div <span class=3D"html-attribut=
e-name">id</span>=3D"<span class=3D"html-attribute-value">view-dashboard</s=
pan>" <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"ht=
ml-attribute-value">space-y-6 max-w-7xl mx-auto tab-view</span>"&gt;</span>=
</td></tr><tr><td class=3D"line-number" value=3D"196"></td><td class=3D"lin=
e-content"><br></td></tr><tr><td class=3D"line-number" value=3D"197"></td><=
td class=3D"line-content">                <span class=3D"html-comment">&lt;=
!-- Quick Stats --&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"198"></td><td class=3D"line-content">                <span class=3D"htm=
l-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">grid grid-cols-1 md:grid-cols-3 gap-4</span>"&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"199"></td><td cl=
ass=3D"line-content">                    <span class=3D"html-tag">&lt;div <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">stat bg-base-100 shadow rounded-box border border-base-content=
/5</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"200">=
</td><td class=3D"line-content">                        <span class=3D"html=
-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cla=
ss=3D"html-attribute-value">stat-figure text-primary</span>"&gt;</span></td=
></tr><tr><td class=3D"line-number" value=3D"201"></td><td class=3D"line-co=
ntent">                            <span class=3D"html-tag">&lt;svg <span c=
lass=3D"html-attribute-name">xmlns</span>=3D"<span class=3D"html-attribute-=
value">http://www.w3.org/2000/svg</span>" <span class=3D"html-attribute-nam=
e">fill</span>=3D"<span class=3D"html-attribute-value">none</span>" <span c=
lass=3D"html-attribute-name">viewBox</span>=3D"<span class=3D"html-attribut=
e-value">0 0 24 24</span>"</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"202"></td><td class=3D"line-content">                               =
 <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-at=
tribute-value">inline-block w-8 h-8 stroke-current</span>"&gt;</td></tr><tr=
><td class=3D"line-number" value=3D"203"></td><td class=3D"line-content">  =
                              <span class=3D"html-tag">&lt;path <span class=
=3D"html-attribute-name">stroke-linecap</span>=3D"<span class=3D"html-attri=
bute-value">round</span>" <span class=3D"html-attribute-name">stroke-linejo=
in</span>=3D"<span class=3D"html-attribute-value">round</span>" <span class=
=3D"html-attribute-name">stroke-width</span>=3D"<span class=3D"html-attribu=
te-value">2</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"=
204"></td><td class=3D"line-content">                                    <s=
pan class=3D"html-attribute-name">d</span>=3D"<span class=3D"html-attribute=
-value">M13 10V3L4 14h7v7l9-11h-7z</span>"&gt;<span class=3D"html-tag">&lt;=
/path&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"205"></td>=
<td class=3D"line-content">                            <span class=3D"html-=
tag">&lt;/svg&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"20=
6"></td><td class=3D"line-content">                        <span class=3D"h=
tml-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"207"></td><td class=3D"line-content">                        <span clas=
s=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">stat-title font-display tracking-wide<=
/span>"&gt;</span>Active Missions<span class=3D"html-tag">&lt;/div&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"208"></td><td class=3D"l=
ine-content">                        <span class=3D"html-tag">&lt;div <span=
 class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribut=
e-value">stat-value text-primary mb-1</span>" <span class=3D"html-attribute=
-name">id</span>=3D"<span class=3D"html-attribute-value">dash-stat-missions=
</span>"&gt;</span>--<span class=3D"html-tag">&lt;/div&gt;</span></td></tr>=
<tr><td class=3D"line-number" value=3D"209"></td><td class=3D"line-content"=
>                        <span class=3D"html-tag">&lt;button <span class=3D=
"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">=
btn btn-xs btn-outline btn-accent font-mono tracking-widest</span>"</span><=
/td></tr><tr><td class=3D"line-number" value=3D"210"></td><td class=3D"line=
-content">                            <span class=3D"html-attribute-name">o=
nclick</span>=3D"<span class=3D"html-attribute-value">toggleProjector()</sp=
an>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"211"></td><td clas=
s=3D"line-content">                            LAUNCH PROJECTOR</td></tr><t=
r><td class=3D"line-number" value=3D"212"></td><td class=3D"line-content"> =
                       <span class=3D"html-tag">&lt;/button&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"213"></td><td class=3D"line-con=
tent">                    <span class=3D"html-tag">&lt;/div&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"214"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"215"></td><td cl=
ass=3D"line-content">                    <span class=3D"html-tag">&lt;div <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">stat bg-base-100 shadow rounded-box border border-base-content=
/5</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"216">=
</td><td class=3D"line-content">                        <span class=3D"html=
-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cla=
ss=3D"html-attribute-value">stat-figure text-secondary</span>"&gt;</span></=
td></tr><tr><td class=3D"line-number" value=3D"217"></td><td class=3D"line-=
content">                            <span class=3D"html-tag">&lt;svg <span=
 class=3D"html-attribute-name">xmlns</span>=3D"<span class=3D"html-attribut=
e-value">http://www.w3.org/2000/svg</span>" <span class=3D"html-attribute-n=
ame">fill</span>=3D"<span class=3D"html-attribute-value">none</span>" <span=
 class=3D"html-attribute-name">viewBox</span>=3D"<span class=3D"html-attrib=
ute-value">0 0 24 24</span>"</span></td></tr><tr><td class=3D"line-number" =
value=3D"218"></td><td class=3D"line-content">                             =
   <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-=
attribute-value">inline-block w-8 h-8 stroke-current</span>"&gt;</td></tr><=
tr><td class=3D"line-number" value=3D"219"></td><td class=3D"line-content">=
                                <span class=3D"html-tag">&lt;path <span cla=
ss=3D"html-attribute-name">stroke-linecap</span>=3D"<span class=3D"html-att=
ribute-value">round</span>" <span class=3D"html-attribute-name">stroke-line=
join</span>=3D"<span class=3D"html-attribute-value">round</span>" <span cla=
ss=3D"html-attribute-name">stroke-width</span>=3D"<span class=3D"html-attri=
bute-value">2</span>"</span></td></tr><tr><td class=3D"line-number" value=
=3D"220"></td><td class=3D"line-content">                                  =
  <span class=3D"html-attribute-name">d</span>=3D"<span class=3D"html-attri=
bute-value">M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6=
 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z</span>"&gt;</td></tr><tr><td=
 class=3D"line-number" value=3D"221"></td><td class=3D"line-content">      =
                          <span class=3D"html-tag">&lt;/path&gt;</span></td=
></tr><tr><td class=3D"line-number" value=3D"222"></td><td class=3D"line-co=
ntent">                            <span class=3D"html-tag">&lt;/svg&gt;</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"223"></td><td class=3D=
"line-content">                        <span class=3D"html-tag">&lt;/div&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"224"></td><td clas=
s=3D"line-content">                        <span class=3D"html-tag">&lt;div=
 <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-at=
tribute-value">stat-title font-display tracking-wide</span>"&gt;</span>Stud=
ents<span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"225"></td><td class=3D"line-content">                =
        <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name=
">class</span>=3D"<span class=3D"html-attribute-value">stat-value text-seco=
ndary</span>" <span class=3D"html-attribute-name">id</span>=3D"<span class=
=3D"html-attribute-value">dash-stat-students</span>"&gt;</span>--<span clas=
s=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"226"></td><td class=3D"line-content">                        <span =
class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">stat-desc</span>"&gt;</span>Regist=
ered seats<span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"227"></td><td class=3D"line-content">          =
          <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"228"></td><td class=3D"line-content"><br></td><=
/tr><tr><td class=3D"line-number" value=3D"229"></td><td class=3D"line-cont=
ent">                    <span class=3D"html-tag">&lt;div <span class=3D"ht=
ml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">sta=
t bg-base-100 shadow rounded-box border border-base-content/5</span>"&gt;</=
span></td></tr><tr><td class=3D"line-number" value=3D"230"></td><td class=
=3D"line-content">                        <span class=3D"html-tag">&lt;div =
<span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-att=
ribute-value">stat-figure text-accent</span>"&gt;</span></td></tr><tr><td c=
lass=3D"line-number" value=3D"231"></td><td class=3D"line-content">        =
                    <span class=3D"html-tag">&lt;div <span class=3D"html-at=
tribute-name">class</span>=3D"<span class=3D"html-attribute-value">radial-p=
rogress bg-base-200 text-success border-4 border-base-200</span>"</span></t=
d></tr><tr><td class=3D"line-number" value=3D"232"></td><td class=3D"line-c=
ontent">                                <span class=3D"html-attribute-name"=
>style</span>=3D"<span class=3D"html-attribute-value">--value:100; --size:2=
.5rem;</span>" <span class=3D"html-attribute-name">role</span>=3D"<span cla=
ss=3D"html-attribute-value">progressbar</span>"&gt;100%<span class=3D"html-=
tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"23=
3"></td><td class=3D"line-content">                        <span class=3D"h=
tml-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"234"></td><td class=3D"line-content">                        <span clas=
s=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">stat-title font-display tracking-wide<=
/span>"&gt;</span>System Health<span class=3D"html-tag">&lt;/div&gt;</span>=
</td></tr><tr><td class=3D"line-number" value=3D"235"></td><td class=3D"lin=
e-content">                        <span class=3D"html-tag">&lt;div <span c=
lass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-=
value">stat-value text-accent flex items-center gap-2</span>" <span class=
=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-value">=
dash-stat-sync</span>"&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"236"></td><td class=3D"line-content">                            <sp=
an class=3D"html-tag">&lt;span <span class=3D"html-attribute-name">class</s=
pan>=3D"<span class=3D"html-attribute-value">w-2 h-2 rounded-full bg-succes=
s animate-pulse</span>"&gt;</span><span class=3D"html-tag">&lt;/span&gt;</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"237"></td><td class=3D=
"line-content">                            LIVE</td></tr><tr><td class=3D"l=
ine-number" value=3D"238"></td><td class=3D"line-content">                 =
       <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"239"></td><td class=3D"line-content">            =
            <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-=
name">class</span>=3D"<span class=3D"html-attribute-value">stat-desc text-s=
uccess</span>"&gt;</span>Cloud Sync Optimal<span class=3D"html-tag">&lt;/di=
v&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"240"></td><td =
class=3D"line-content">                    <span class=3D"html-tag">&lt;/di=
v&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"241"></td><td =
class=3D"line-content">                <span class=3D"html-tag">&lt;/div&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"242"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"243=
"></td><td class=3D"line-content">                <span class=3D"html-comme=
nt">&lt;!-- Action Cards --&gt;</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"244"></td><td class=3D"line-content">                <span clas=
s=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">grid grid-cols-1 lg:grid-cols-2 gap-6<=
/span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"245"></t=
d><td class=3D"line-content">                    <span class=3D"html-commen=
t">&lt;!-- Create Card - Enhanced Design --&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"246"></td><td class=3D"line-content">          =
          <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-na=
me">class</span>=3D"<span class=3D"html-attribute-value">card bg-gradient-t=
o-br from-primary/90 via-indigo-600 to-purple-800 shadow-2xl h-64 group cur=
sor-pointer transition-all hover:scale-[1.02] hover:shadow-primary/30 hover=
:shadow-2xl overflow-hidden relative</span>"</span></td></tr><tr><td class=
=3D"line-number" value=3D"247"></td><td class=3D"line-content">            =
            <span class=3D"html-attribute-name">onclick</span>=3D"<span cla=
ss=3D"html-attribute-value">switchMainTab('Builder')</span>"&gt;</td></tr><=
tr><td class=3D"line-number" value=3D"248"></td><td class=3D"line-content">=
                        <span class=3D"html-comment">&lt;!-- Decorative bac=
kground elements --&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"249"></td><td class=3D"line-content">                        <span clas=
s=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D"line-number" value=
=3D"250"></td><td class=3D"line-content">                            <span =
class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute=
-value">absolute inset-0 bg-[url('https://images.unsplash.com/photo-1451187=
580459-43490279c0fa?w=3D800&amp;auto=3Dformat&amp;fit=3Dcrop')] bg-cover bg=
-center opacity-20 group-hover:opacity-30 transition-opacity</span>"&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"251"></td><td class=3D"line-c=
ontent">                        <span class=3D"html-tag">&lt;/div&gt;</span=
></td></tr><tr><td class=3D"line-number" value=3D"252"></td><td class=3D"li=
ne-content">                        <span class=3D"html-tag">&lt;div <span =
class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute=
-value">absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-=
transparent</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"253"></td><td class=3D"line-content">                        <span clas=
s=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"254"></td><td class=3D"line-content">                        <span =
class=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"255"></td><td class=3D"line-content">                            <sp=
an class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attrib=
ute-value">absolute -top-20 -right-20 w-48 h-48 bg-white/10 rounded-full bl=
ur-3xl group-hover:bg-white/20 transition-colors</span>"&gt;</td></tr><tr><=
td class=3D"line-number" value=3D"256"></td><td class=3D"line-content">    =
                    <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"257"></td><td class=3D"line-content">=
                        <span class=3D"html-tag">&lt;div <span class=3D"htm=
l-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">abso=
lute -bottom-10 -left-10 w-32 h-32 bg-primary/30 rounded-full blur-2xl</spa=
n>"&gt;</span><span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"258"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"259"></td><td class=3D"line-=
content">                        <span class=3D"html-tag">&lt;div <span cla=
ss=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-va=
lue">card-body justify-end relative z-10</span>"&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"260"></td><td class=3D"line-content">     =
                       <span class=3D"html-tag">&lt;div <span class=3D"html=
-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">flex =
items-center gap-3 mb-2</span>"&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"261"></td><td class=3D"line-content">                      =
          <span class=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D=
"line-number" value=3D"262"></td><td class=3D"line-content">               =
                     <span class=3D"html-attribute-name">class</span>=3D"<s=
pan class=3D"html-attribute-value">w-12 h-12 rounded-xl bg-white/20 backdro=
p-blur-sm flex items-center justify-center</span>"&gt;</td></tr><tr><td cla=
ss=3D"line-number" value=3D"263"></td><td class=3D"line-content">          =
                          <span class=3D"html-tag">&lt;svg <span class=3D"h=
tml-attribute-name">xmlns</span>=3D"<span class=3D"html-attribute-value">ht=
tp://www.w3.org/2000/svg</span>" <span class=3D"html-attribute-name">class<=
/span>=3D"<span class=3D"html-attribute-value">h-6 w-6 text-white</span>" <=
span class=3D"html-attribute-name">fill</span>=3D"<span class=3D"html-attri=
bute-value">none</span>"</span></td></tr><tr><td class=3D"line-number" valu=
e=3D"264"></td><td class=3D"line-content">                                 =
       <span class=3D"html-attribute-name">viewBox</span>=3D"<span class=3D=
"html-attribute-value">0 0 24 24</span>" <span class=3D"html-attribute-name=
">stroke</span>=3D"<span class=3D"html-attribute-value">currentColor</span>=
"&gt;</td></tr><tr><td class=3D"line-number" value=3D"265"></td><td class=
=3D"line-content">                                        <span class=3D"ht=
ml-tag">&lt;path <span class=3D"html-attribute-name">stroke-linecap</span>=
=3D"<span class=3D"html-attribute-value">round</span>" <span class=3D"html-=
attribute-name">stroke-linejoin</span>=3D"<span class=3D"html-attribute-val=
ue">round</span>" <span class=3D"html-attribute-name">stroke-width</span>=
=3D"<span class=3D"html-attribute-value">2</span>"</span></td></tr><tr><td =
class=3D"line-number" value=3D"266"></td><td class=3D"line-content">       =
                                     <span class=3D"html-attribute-name">d<=
/span>=3D"<span class=3D"html-attribute-value">M9.663 17h4.673M12 3v1m6.364=
 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117=
.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.35=
6-1.754-.988-2.386l-.548-.547z</span>" /&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"267"></td><td class=3D"line-content">                    =
                <span class=3D"html-tag">&lt;/svg&gt;</span></td></tr><tr><=
td class=3D"line-number" value=3D"268"></td><td class=3D"line-content">    =
                            <span class=3D"html-tag">&lt;/div&gt;</span></t=
d></tr><tr><td class=3D"line-number" value=3D"269"></td><td class=3D"line-c=
ontent">                                <span class=3D"html-tag">&lt;div&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"270"></td><td clas=
s=3D"line-content">                                    <span class=3D"html-=
tag">&lt;h2</span></td></tr><tr><td class=3D"line-number" value=3D"271"></t=
d><td class=3D"line-content">                                        <span =
class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute=
-value">card-title text-3xl font-display tracking-wider text-white drop-sha=
dow-lg</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"272"></t=
d><td class=3D"line-content">                                        MISSIO=
N BUILDER<span class=3D"html-tag">&lt;/h2&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"273"></td><td class=3D"line-content">            =
                        <span class=3D"html-tag">&lt;p <span class=3D"html-=
attribute-name">class</span>=3D"<span class=3D"html-attribute-value">text-w=
hite/70 text-sm</span>"&gt;</span>AI-Powered Curriculum Design<span class=
=3D"html-tag">&lt;/p&gt;</span></td></tr><tr><td class=3D"line-number" valu=
e=3D"274"></td><td class=3D"line-content">                                <=
span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-=
number" value=3D"275"></td><td class=3D"line-content">                     =
       <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"276"></td><td class=3D"line-content">            =
                <span class=3D"html-tag">&lt;p <span class=3D"html-attribut=
e-name">class</span>=3D"<span class=3D"html-attribute-value">grow-0 text-wh=
ite/80 text-sm mb-3</span>"&gt;</span>Create engaging, interactive lessons =
with your</td></tr><tr><td class=3D"line-number" value=3D"277"></td><td cla=
ss=3D"line-content">                                AI curriculum partner.<=
span class=3D"html-tag">&lt;/p&gt;</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"278"></td><td class=3D"line-content">                       =
     <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">c=
lass</span>=3D"<span class=3D"html-attribute-value">card-actions justify-en=
d</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"279"><=
/td><td class=3D"line-content">                                <span class=
=3D"html-tag">&lt;button <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">btn btn-white bg-white text-primar=
y hover:bg-white/90 gap-2 shadow-lg</span>"&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"280"></td><td class=3D"line-content">          =
                          <span class=3D"html-tag">&lt;svg <span class=3D"h=
tml-attribute-name">xmlns</span>=3D"<span class=3D"html-attribute-value">ht=
tp://www.w3.org/2000/svg</span>" <span class=3D"html-attribute-name">class<=
/span>=3D"<span class=3D"html-attribute-value">h-5 w-5</span>" <span class=
=3D"html-attribute-name">fill</span>=3D"<span class=3D"html-attribute-value=
">none</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"281">=
</td><td class=3D"line-content">                                        <sp=
an class=3D"html-attribute-name">viewBox</span>=3D"<span class=3D"html-attr=
ibute-value">0 0 24 24</span>" <span class=3D"html-attribute-name">stroke</=
span>=3D"<span class=3D"html-attribute-value">currentColor</span>"&gt;</td>=
</tr><tr><td class=3D"line-number" value=3D"282"></td><td class=3D"line-con=
tent">                                        <span class=3D"html-tag">&lt;=
path <span class=3D"html-attribute-name">stroke-linecap</span>=3D"<span cla=
ss=3D"html-attribute-value">round</span>" <span class=3D"html-attribute-nam=
e">stroke-linejoin</span>=3D"<span class=3D"html-attribute-value">round</sp=
an>" <span class=3D"html-attribute-name">stroke-width</span>=3D"<span class=
=3D"html-attribute-value">2</span>"</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"283"></td><td class=3D"line-content">                      =
                      <span class=3D"html-attribute-name">d</span>=3D"<span=
 class=3D"html-attribute-value">M12 6v6m0 0v6m0-6h6m-6 0H6</span>" /&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"284"></td><td class=3D"line-c=
ontent">                                    <span class=3D"html-tag">&lt;/s=
vg&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"285"></td><td=
 class=3D"line-content">                                    Start Creating<=
/td></tr><tr><td class=3D"line-number" value=3D"286"></td><td class=3D"line=
-content">                                <span class=3D"html-tag">&lt;/but=
ton&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"287"></td><t=
d class=3D"line-content">                            <span class=3D"html-ta=
g">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"288"=
></td><td class=3D"line-content">                        <span class=3D"htm=
l-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
289"></td><td class=3D"line-content">                    <span class=3D"htm=
l-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
290"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-nu=
mber" value=3D"291"></td><td class=3D"line-content">                    <sp=
an class=3D"html-comment">&lt;!-- Manage Card --&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"292"></td><td class=3D"line-content">     =
               <span class=3D"html-tag">&lt;div <span class=3D"html-attribu=
te-name">class</span>=3D"<span class=3D"html-attribute-value">card bg-base-=
100 shadow-xl border border-base-content/10 h-64</span>"&gt;</span></td></t=
r><tr><td class=3D"line-number" value=3D"293"></td><td class=3D"line-conten=
t">                        <span class=3D"html-tag">&lt;div <span class=3D"=
html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">c=
ard-body</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D=
"294"></td><td class=3D"line-content">                            <span cla=
ss=3D"html-tag">&lt;h2 <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">card-title font-display tracking-wide<=
/span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"295"></t=
d><td class=3D"line-content">                                <span class=3D=
"html-tag">&lt;svg <span class=3D"html-attribute-name">xmlns</span>=3D"<spa=
n class=3D"html-attribute-value">http://www.w3.org/2000/svg</span>" <span c=
lass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-=
value">h-6 w-6 text-secondary</span>" <span class=3D"html-attribute-name">f=
ill</span>=3D"<span class=3D"html-attribute-value">none</span>"</span></td>=
</tr><tr><td class=3D"line-number" value=3D"296"></td><td class=3D"line-con=
tent">                                    <span class=3D"html-attribute-nam=
e">viewBox</span>=3D"<span class=3D"html-attribute-value">0 0 24 24</span>"=
 <span class=3D"html-attribute-name">stroke</span>=3D"<span class=3D"html-a=
ttribute-value">currentColor</span>"&gt;</td></tr><tr><td class=3D"line-num=
ber" value=3D"297"></td><td class=3D"line-content">                        =
            <span class=3D"html-tag">&lt;path <span class=3D"html-attribute=
-name">stroke-linecap</span>=3D"<span class=3D"html-attribute-value">round<=
/span>" <span class=3D"html-attribute-name">stroke-linejoin</span>=3D"<span=
 class=3D"html-attribute-value">round</span>" <span class=3D"html-attribute=
-name">stroke-width</span>=3D"<span class=3D"html-attribute-value">2</span>=
"</span></td></tr><tr><td class=3D"line-number" value=3D"298"></td><td clas=
s=3D"line-content">                                        <span class=3D"h=
tml-attribute-name">d</span>=3D"<span class=3D"html-attribute-value">M9 5H7=
a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002=
 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h=
.01</span>" /&gt;</td></tr><tr><td class=3D"line-number" value=3D"299"></td=
><td class=3D"line-content">                                <span class=3D"=
html-tag">&lt;/svg&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"300"></td><td class=3D"line-content">                                Re=
cent Activity</td></tr><tr><td class=3D"line-number" value=3D"301"></td><td=
 class=3D"line-content">                            <span class=3D"html-tag=
">&lt;/h2&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"302"><=
/td><td class=3D"line-content">                            <span class=3D"h=
tml-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span =
class=3D"html-attribute-value">overflow-y-auto flex-1 -mx-4 px-4</span>"&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"303"></td><td clas=
s=3D"line-content">                                <span class=3D"html-tag"=
>&lt;ul <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"=
html-attribute-value">timeline timeline-vertical timeline-compact timeline-=
snap-icon w-full</span>"&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"304"></td><td class=3D"line-content">                             =
       <span class=3D"html-tag">&lt;li&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"305"></td><td class=3D"line-content">               =
                         <span class=3D"html-tag">&lt;hr <span class=3D"htm=
l-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">bg-p=
rimary</span>" /&gt;</span></td></tr><tr><td class=3D"line-number" value=3D=
"306"></td><td class=3D"line-content">                                     =
   <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">cla=
ss</span>=3D"<span class=3D"html-attribute-value">timeline-middle</span>"&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"307"></td><td cla=
ss=3D"line-content">                                            <span class=
=3D"html-tag">&lt;svg <span class=3D"html-attribute-name">xmlns</span>=3D"<=
span class=3D"html-attribute-value">http://www.w3.org/2000/svg</span>" <spa=
n class=3D"html-attribute-name">viewBox</span>=3D"<span class=3D"html-attri=
bute-value">0 0 20 20</span>"</span></td></tr><tr><td class=3D"line-number"=
 value=3D"308"></td><td class=3D"line-content">                            =
                    <span class=3D"html-attribute-name">fill</span>=3D"<spa=
n class=3D"html-attribute-value">currentColor</span>" <span class=3D"html-a=
ttribute-name">class</span>=3D"<span class=3D"html-attribute-value">h-5 w-5=
 text-primary</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"3=
09"></td><td class=3D"line-content">                                       =
         <span class=3D"html-tag">&lt;path <span class=3D"html-attribute-na=
me">fill-rule</span>=3D"<span class=3D"html-attribute-value">evenodd</span>=
"</span></td></tr><tr><td class=3D"line-number" value=3D"310"></td><td clas=
s=3D"line-content">                                                    <spa=
n class=3D"html-attribute-name">d</span>=3D"<span class=3D"html-attribute-v=
alue">M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l=
-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l=
4-5.5z</span>"</td></tr><tr><td class=3D"line-number" value=3D"311"></td><t=
d class=3D"line-content">                                                  =
  <span class=3D"html-attribute-name">clip-rule</span>=3D"<span class=3D"ht=
ml-attribute-value">evenodd</span>" /&gt;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"312"></td><td class=3D"line-content">                       =
                     <span class=3D"html-tag">&lt;/svg&gt;</span></td></tr>=
<tr><td class=3D"line-number" value=3D"313"></td><td class=3D"line-content"=
>                                        <span class=3D"html-tag">&lt;/div&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"314"></td><td cl=
ass=3D"line-content">                                        <span class=3D=
"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<spa=
n class=3D"html-attribute-value">timeline-end mb-2</span>"&gt;</span></td><=
/tr><tr><td class=3D"line-number" value=3D"315"></td><td class=3D"line-cont=
ent">                                            <span class=3D"html-tag">&=
lt;time <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"=
html-attribute-value">font-mono italic text-xs opacity-50</span>"&gt;</span=
>Just now<span class=3D"html-tag">&lt;/time&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"316"></td><td class=3D"line-content">          =
                                  <span class=3D"html-tag">&lt;div <span cl=
ass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-v=
alue">text-sm font-bold text-base-content</span>"&gt;</span>System Ready<sp=
an class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"317"></td><td class=3D"line-content">                       =
                     <span class=3D"html-tag">&lt;div <span class=3D"html-a=
ttribute-name">class</span>=3D"<span class=3D"html-attribute-value">text-xs=
 opacity-70</span>"&gt;</span>Dashboard initialized successfully.<span clas=
s=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"318"></td><td class=3D"line-content">                              =
          <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"319"></td><td class=3D"line-content">          =
                              <span class=3D"html-tag">&lt;hr /&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"320"></td><td class=3D"line=
-content">                                    <span class=3D"html-tag">&lt;=
/li&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"321"></td><t=
d class=3D"line-content">                                <span class=3D"htm=
l-tag">&lt;/ul&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"3=
22"></td><td class=3D"line-content">                            <span class=
=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"323"></td><td class=3D"line-content">                        <span c=
lass=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"324"></td><td class=3D"line-content">                    <span c=
lass=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"325"></td><td class=3D"line-content">                <span class=
=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"326"></td><td class=3D"line-content">            <span class=3D"html=
-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"3=
27"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-num=
ber" value=3D"328"></td><td class=3D"line-content">            <span class=
=3D"html-comment">&lt;!-- VIEW: Builder (Placeholder for Logic Transplant) =
--&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"329"></td><td=
 class=3D"line-content">            <span class=3D"html-tag">&lt;div <span =
class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-va=
lue">view-Builder</span>" <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">hidden tab-view min-h-full flex fl=
ex-col</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"3=
30"></td><td class=3D"line-content">                <span class=3D"html-com=
ment">&lt;!-- Builder Header --&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"331"></td><td class=3D"line-content">                <span =
class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">flex justify-between items-center =
mb-6</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"332=
"></td><td class=3D"line-content">                    <span class=3D"html-t=
ag">&lt;div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"333"=
></td><td class=3D"line-content">                        <span class=3D"htm=
l-tag">&lt;h2 <span class=3D"html-attribute-name">class</span>=3D"<span cla=
ss=3D"html-attribute-value">text-2xl font-display tracking-widest text-prim=
ary flex items-center gap-2</span>"&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"334"></td><td class=3D"line-content">                  =
          MISSION BUILDER</td></tr><tr><td class=3D"line-number" value=3D"3=
35"></td><td class=3D"line-content">                            <span class=
=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<=
span class=3D"html-attribute-value">badge badge-warning badge-sm font-mono =
align-top animate-pulse</span>"&gt;</span>AI ALPHA<span class=3D"html-tag">=
&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"336"></=
td><td class=3D"line-content">                        <span class=3D"html-t=
ag">&lt;/h2&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"337"=
></td><td class=3D"line-content">                        <span class=3D"htm=
l-tag">&lt;p <span class=3D"html-attribute-name">class</span>=3D"<span clas=
s=3D"html-attribute-value">text-sm opacity-60</span>"&gt;</span>Modular Mis=
sion Construction Pipeline<span class=3D"html-tag">&lt;/p&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"338"></td><td class=3D"line-conte=
nt">                    <span class=3D"html-tag">&lt;/div&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"339"></td><td class=3D"line-conte=
nt">                    <span class=3D"html-comment">&lt;!-- Pipeline Stepp=
er Container (matches Logic ID) --&gt;</span></td></tr><tr><td class=3D"lin=
e-number" value=3D"340"></td><td class=3D"line-content">                   =
 <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">id</s=
pan>=3D"<span class=3D"html-attribute-value">pipeline-stepper</span>" <span=
 class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribut=
e-value">steps</span>"&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"341"></td><td class=3D"line-content">                        <span c=
lass=3D"html-comment">&lt;!-- Injected by JS --&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"342"></td><td class=3D"line-content">      =
              <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"343"></td><td class=3D"line-content">      =
          <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"344"></td><td class=3D"line-content"><br></td><=
/tr><tr><td class=3D"line-number" value=3D"345"></td><td class=3D"line-cont=
ent">                <span class=3D"html-comment">&lt;!-- Builder Main Area=
 --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"346"></td><t=
d class=3D"line-content">                <span class=3D"html-tag">&lt;div</=
span></td></tr><tr><td class=3D"line-number" value=3D"347"></td><td class=
=3D"line-content">                    <span class=3D"html-attribute-name">c=
lass</span>=3D"<span class=3D"html-attribute-value">bg-base-100 rounded-xl =
shadow-xl border border-base-content/10 overflow-hidden relative flex flex-=
col lg:flex-row h-auto lg:h-[max(600px,calc(100vh-250px))]</span>"&gt;</td>=
</tr><tr><td class=3D"line-number" value=3D"348"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"349"></td><td cl=
ass=3D"line-content">                    <span class=3D"html-comment">&lt;!=
-- Builder Panel (Inputs) --&gt;</span></td></tr><tr><td class=3D"line-numb=
er" value=3D"350"></td><td class=3D"line-content">                    <span=
 class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">id</span>=
=3D"<span class=3D"html-attribute-value">Builder-panel</span>"</span></td><=
/tr><tr><td class=3D"line-number" value=3D"351"></td><td class=3D"line-cont=
ent">                        <span class=3D"html-attribute-name">class</spa=
n>=3D"<span class=3D"html-attribute-value">w-full lg:w-96 lg:min-w-[384px] =
border-b lg:border-b-0 lg:border-r border-base-content/10 p-6 flex flex-col=
 gap-4 overflow-y-auto overflow-x-hidden bg-base-200/50 h-[500px] lg:h-full=
 custom-scrollbar</span>"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"352"></td><td class=3D"line-content">                        <span clas=
s=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">flex justify-between items-end</span>"=
&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"353"></td><td c=
lass=3D"line-content">                            <span class=3D"html-tag">=
&lt;span <span class=3D"html-attribute-name">class</span>=3D"<span class=3D=
"html-attribute-value">text-xs font-bold tracking-widest text-primary</span=
>"&gt;</span>CURRENT PHASE<span class=3D"html-tag">&lt;/span&gt;</span></td=
></tr><tr><td class=3D"line-number" value=3D"354"></td><td class=3D"line-co=
ntent">                            <span class=3D"html-tag">&lt;div <span c=
lass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-=
value">flex gap-1</span>"&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"355"></td><td class=3D"line-content">                            =
    <span class=3D"html-tag">&lt;button <span class=3D"html-attribute-name"=
>class</span>=3D"<span class=3D"html-attribute-value">btn btn-ghost btn-xs =
px-1</span>" <span class=3D"html-attribute-name">onclick</span>=3D"<span cl=
ass=3D"html-attribute-value">resetBuilder()</span>"&gt;</span>RESET<span cl=
ass=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-numb=
er" value=3D"356"></td><td class=3D"line-content">                         =
       <span class=3D"html-tag">&lt;button <span class=3D"html-attribute-na=
me">class</span>=3D"<span class=3D"html-attribute-value">btn btn-ghost btn-=
xs px-1</span>" <span class=3D"html-attribute-name">onclick</span>=3D"<span=
 class=3D"html-attribute-value">saveIdea()</span>"&gt;</span>SAVE<span clas=
s=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"357"></td><td class=3D"line-content">                           =
     <span class=3D"html-tag">&lt;button <span class=3D"html-attribute-name=
">class</span>=3D"<span class=3D"html-attribute-value">btn btn-ghost btn-xs=
 px-1</span>" <span class=3D"html-attribute-name">onclick</span>=3D"<span c=
lass=3D"html-attribute-value">openIdeaLoader()</span>"&gt;</span>LOAD<span =
class=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"358"></td><td class=3D"line-content">                       =
     <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"359"></td><td class=3D"line-content">               =
             <span class=3D"html-tag">&lt;button <span class=3D"html-attrib=
ute-name">class</span>=3D"<span class=3D"html-attribute-value">btn btn-seco=
ndary btn-outline btn-xs gap-1</span>" <span class=3D"html-attribute-name">=
onclick</span>=3D"<span class=3D"html-attribute-value">openHospital()</span=
>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"360"></td><td=
 class=3D"line-content">                                <span class=3D"html=
-tag">&lt;svg <span class=3D"html-attribute-name">xmlns</span>=3D"<span cla=
ss=3D"html-attribute-value">http://www.w3.org/2000/svg</span>" <span class=
=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-valu=
e">h-3 w-3</span>" <span class=3D"html-attribute-name">viewBox</span>=3D"<s=
pan class=3D"html-attribute-value">0 0 20 20</span>"</span></td></tr><tr><t=
d class=3D"line-number" value=3D"361"></td><td class=3D"line-content">     =
                               <span class=3D"html-attribute-name">fill</sp=
an>=3D"<span class=3D"html-attribute-value">currentColor</span>"&gt;</td></=
tr><tr><td class=3D"line-number" value=3D"362"></td><td class=3D"line-conte=
nt">                                    <span class=3D"html-tag">&lt;path</=
span></td></tr><tr><td class=3D"line-number" value=3D"363"></td><td class=
=3D"line-content">                                        <span class=3D"ht=
ml-attribute-name">d</span>=3D"<span class=3D"html-attribute-value">M17.414=
 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z</spa=
n>" /&gt;</td></tr><tr><td class=3D"line-number" value=3D"364"></td><td cla=
ss=3D"line-content">                                    <span class=3D"html=
-tag">&lt;path <span class=3D"html-attribute-name">fill-rule</span>=3D"<spa=
n class=3D"html-attribute-value">evenodd</span>"</span></td></tr><tr><td cl=
ass=3D"line-number" value=3D"365"></td><td class=3D"line-content">         =
                               <span class=3D"html-attribute-name">d</span>=
=3D"<span class=3D"html-attribute-value">M2 6a2 2 0 012-2h4a1 1 0 010 2H4v1=
0h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z</span>"</td></tr><tr><=
td class=3D"line-number" value=3D"366"></td><td class=3D"line-content">    =
                                    <span class=3D"html-attribute-name">cli=
p-rule</span>=3D"<span class=3D"html-attribute-value">evenodd</span>" /&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"367"></td><td class=3D"lin=
e-content">                                <span class=3D"html-tag">&lt;/sv=
g&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"368"></td><td =
class=3D"line-content">                                WORKSHOP</td></tr><t=
r><td class=3D"line-number" value=3D"369"></td><td class=3D"line-content"> =
                           <span class=3D"html-tag">&lt;/button&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"370"></td><td class=3D"line=
-content">                        <span class=3D"html-tag">&lt;/div&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"371"></td><td class=3D"=
line-content">                        <span class=3D"html-tag">&lt;h2 <span=
 class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-v=
alue">Builder-title</span>"</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"372"></td><td class=3D"line-content">                            <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">text-xl md:text-2xl lg:text-3xl font-display uppercase leading-=
tight</span>"&gt;INITIALIZING...</td></tr><tr><td class=3D"line-number" val=
ue=3D"373"></td><td class=3D"line-content">                        <span cl=
ass=3D"html-tag">&lt;/h2&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"374"></td><td class=3D"line-content">                        <span=
 class=3D"html-tag">&lt;p <span class=3D"html-attribute-name">id</span>=3D"=
<span class=3D"html-attribute-value">Builder-desc</span>" <span class=3D"ht=
ml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">tex=
t-sm opacity-70 mb-4</span>"&gt;</span>Establishing secure connection to ne=
ural</td></tr><tr><td class=3D"line-number" value=3D"375"></td><td class=3D=
"line-content">                            core...<span class=3D"html-tag">=
&lt;/p&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"376"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"377"></td><td class=3D"line-content">                        <span cl=
ass=3D"html-comment">&lt;!-- Dynamic Input Zones --&gt;</span></td></tr><tr=
><td class=3D"line-number" value=3D"378"></td><td class=3D"line-content">  =
                      <span class=3D"html-tag">&lt;div <span class=3D"html-=
attribute-name">id</span>=3D"<span class=3D"html-attribute-value">curriculu=
m-zone</span>" <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">card bg-base-100 border border-base-300 p-4 sh=
adow-sm text-sm</span>"&gt;</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"379"></td><td class=3D"line-content">                            <s=
pan class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</s=
pan>=3D"<span class=3D"html-attribute-value">flex justify-between mb-2</spa=
n>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"380"></td><t=
d class=3D"line-content">                                <span class=3D"htm=
l-tag">&lt;span <span class=3D"html-attribute-name">class</span>=3D"<span c=
lass=3D"html-attribute-value">font-bold text-xs uppercase opacity-50</span>=
"&gt;</span>Learning Outcomes<span class=3D"html-tag">&lt;/span&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"381"></td><td class=3D"line=
-content">                            <span class=3D"html-tag">&lt;/div&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"382"></td><td class=
=3D"line-content">                            <span class=3D"html-comment">=
&lt;!-- Selects (IDs match old logic) --&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"383"></td><td class=3D"line-content">            =
                <span class=3D"html-tag">&lt;select <span class=3D"html-att=
ribute-name">id</span>=3D"<span class=3D"html-attribute-value">f-country</s=
pan>" <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"ht=
ml-attribute-value">select select-bordered select-xs w-full mb-2</span>"</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"384"></td><td class=3D=
"line-content">                                <span class=3D"html-attribut=
e-name">onchange</span>=3D"<span class=3D"html-attribute-value">updateBuild=
erRegions()</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"385=
"></td><td class=3D"line-content">                                <span cla=
ss=3D"html-tag">&lt;option <span class=3D"html-attribute-name">value</span>=
=3D""&gt;</span>Select Country...<span class=3D"html-tag">&lt;/option&gt;</=
span></td></tr><tr><td class=3D"line-number" value=3D"386"></td><td class=
=3D"line-content">                            <span class=3D"html-tag">&lt;=
/select&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"387"></t=
d><td class=3D"line-content">                            <span class=3D"htm=
l-tag">&lt;select <span class=3D"html-attribute-name">id</span>=3D"<span cl=
ass=3D"html-attribute-value">f-region</span>" <span class=3D"html-attribute=
-name">class</span>=3D"<span class=3D"html-attribute-value">select select-b=
ordered select-xs w-full mb-2 hidden</span>"</span></td></tr><tr><td class=
=3D"line-number" value=3D"388"></td><td class=3D"line-content">            =
                    <span class=3D"html-attribute-name">onchange</span>=3D"=
<span class=3D"html-attribute-value">updateBuilderCourses()</span>"&gt;<spa=
n class=3D"html-tag">&lt;/select&gt;</span></td></tr><tr><td class=3D"line-=
number" value=3D"389"></td><td class=3D"line-content">                     =
       <span class=3D"html-tag">&lt;select <span class=3D"html-attribute-na=
me">id</span>=3D"<span class=3D"html-attribute-value">f-course</span>" <spa=
n class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribu=
te-value">select select-bordered select-xs w-full mb-2 hidden</span>"</span=
></td></tr><tr><td class=3D"line-number" value=3D"390"></td><td class=3D"li=
ne-content">                                <span class=3D"html-attribute-n=
ame">onchange</span>=3D"<span class=3D"html-attribute-value">updateBuilderO=
utcomes()</span>"&gt;<span class=3D"html-tag">&lt;/select&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"391"></td><td class=3D"line-conte=
nt"><br></td></tr><tr><td class=3D"line-number" value=3D"392"></td><td clas=
s=3D"line-content">                            <span class=3D"html-tag">&lt=
;input <span class=3D"html-attribute-name">type</span>=3D"<span class=3D"ht=
ml-attribute-value">hidden</span>" <span class=3D"html-attribute-name">id</=
span>=3D"<span class=3D"html-attribute-value">f-model</span>" <span class=
=3D"html-attribute-name">value</span>=3D"<span class=3D"html-attribute-valu=
e">xiaomi/mimo-v2-flash:free</span>"&gt;</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"393"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"394"></td><td class=3D"line-content">  =
                          <span class=3D"html-tag">&lt;div <span class=3D"h=
tml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">di=
vider text-[0.6rem] opacity-30 my-1 flex items-center justify-between</span=
>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"395"></td><td=
 class=3D"line-content">                                <span class=3D"html=
-tag">&lt;span&gt;</span>TARGET OUTCOMES<span class=3D"html-tag">&lt;/span&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"396"></td><td cl=
ass=3D"line-content">                                <span class=3D"html-ta=
g">&lt;button <span class=3D"html-attribute-name">class</span>=3D"<span cla=
ss=3D"html-attribute-value">btn btn-ghost btn-xs text-[9px] opacity-60 hove=
r:opacity-100</span>"</span></td></tr><tr><td class=3D"line-number" value=
=3D"397"></td><td class=3D"line-content">                                  =
  <span class=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html=
-attribute-value">toggleAllOutcomes()</span>"&gt;SELECT ALL<span class=3D"h=
tml-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" valu=
e=3D"398"></td><td class=3D"line-content">                            <span=
 class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-numb=
er" value=3D"399"></td><td class=3D"line-content">                         =
   <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">id<=
/span>=3D"<span class=3D"html-attribute-value">f-outcomes</span>" <span cla=
ss=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-va=
lue">max-h-40 overflow-y-auto space-y-1 pr-2 custom-scrollbar</span>"&gt;</=
span></td></tr><tr><td class=3D"line-number" value=3D"400"></td><td class=
=3D"line-content">                                <span class=3D"html-tag">=
&lt;p <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"ht=
ml-attribute-value">text-center opacity-30 text-[0.6rem] py-4</span>"&gt;</=
span>SELECT COURSE TO LOAD OUTCOMES<span class=3D"html-tag">&lt;/p&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"401"></td><td class=3D"l=
ine-content">                            <span class=3D"html-tag">&lt;/div&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"402"></td><td cl=
ass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"4=
03"></td><td class=3D"line-content">                            <span class=
=3D"html-comment">&lt;!-- Custom Add Lab (Legacy Port) --&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"404"></td><td class=3D"line-conte=
nt">                            <span class=3D"html-tag">&lt;div <span clas=
s=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-value"=
>custom-add-zone</span>" <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">mt-4 pt-4 border-t border-base-con=
tent/10 hidden</span>"&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"405"></td><td class=3D"line-content">                               =
 <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class=
</span>=3D"<span class=3D"html-attribute-value">space-y-2</span>"&gt;</span=
></td></tr><tr><td class=3D"line-number" value=3D"406"></td><td class=3D"li=
ne-content">                                    <span class=3D"html-tag">&l=
t;input <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"htm=
l-attribute-value">custom-country</span>" <span class=3D"html-attribute-nam=
e">type</span>=3D"<span class=3D"html-attribute-value">text</span>" <span c=
lass=3D"html-attribute-name">placeholder</span>=3D"<span class=3D"html-attr=
ibute-value">COUNTRY (e.g. Canada)</span>"</span></td></tr><tr><td class=3D=
"line-number" value=3D"407"></td><td class=3D"line-content">               =
                         <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">input input-bordered input-xs w-fu=
ll</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"408"></td><t=
d class=3D"line-content">                                    <span class=3D=
"html-tag">&lt;input <span class=3D"html-attribute-name">id</span>=3D"<span=
 class=3D"html-attribute-value">custom-region</span>" <span class=3D"html-a=
ttribute-name">type</span>=3D"<span class=3D"html-attribute-value">text</sp=
an>" <span class=3D"html-attribute-name">placeholder</span>=3D"<span class=
=3D"html-attribute-value">REGION (e.g. Ontario)</span>"</span></td></tr><tr=
><td class=3D"line-number" value=3D"409"></td><td class=3D"line-content">  =
                                      <span class=3D"html-attribute-name">c=
lass</span>=3D"<span class=3D"html-attribute-value">input input-bordered in=
put-xs w-full</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"4=
10"></td><td class=3D"line-content">                                    <sp=
an class=3D"html-tag">&lt;input <span class=3D"html-attribute-name">id</spa=
n>=3D"<span class=3D"html-attribute-value">custom-course-name</span>" <span=
 class=3D"html-attribute-name">type</span>=3D"<span class=3D"html-attribute=
-value">text</span>" <span class=3D"html-attribute-name">placeholder</span>=
=3D"<span class=3D"html-attribute-value">COURSE NAME</span>"</span></td></t=
r><tr><td class=3D"line-number" value=3D"411"></td><td class=3D"line-conten=
t">                                        <span class=3D"html-attribute-na=
me">class</span>=3D"<span class=3D"html-attribute-value">input input-border=
ed input-xs w-full</span>"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"412"></td><td class=3D"line-content">                                  =
  <span class=3D"html-tag">&lt;textarea <span class=3D"html-attribute-name"=
>id</span>=3D"<span class=3D"html-attribute-value">custom-outcomes-raw</spa=
n>" <span class=3D"html-attribute-name">placeholder</span>=3D"<span class=
=3D"html-attribute-value">OUTCOMES (ONE PER LINE)</span>"</span></td></tr><=
tr><td class=3D"line-number" value=3D"413"></td><td class=3D"line-content">=
                                        <span class=3D"html-attribute-name"=
>class</span>=3D"<span class=3D"html-attribute-value">textarea textarea-bor=
dered textarea-xs w-full h-20</span>"&gt;<span class=3D"html-tag">&lt;/text=
area&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"414"></td><=
td class=3D"line-content">                                    <span class=
=3D"html-tag">&lt;button <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">btn btn-xs btn-primary w-full</spa=
n>" <span class=3D"html-attribute-name">onclick</span>=3D"<span class=3D"ht=
ml-attribute-value">saveCustomCourse()</span>"&gt;</span>SAVE TO</td></tr><=
tr><td class=3D"line-number" value=3D"415"></td><td class=3D"line-content">=
                                        LOCAL LAB<span class=3D"html-tag">&=
lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"416">=
</td><td class=3D"line-content">                                <span class=
=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"417"></td><td class=3D"line-content">                            <sp=
an class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"418"></td><td class=3D"line-content">                       =
     <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">c=
lass</span>=3D"<span class=3D"html-attribute-value">text-center mt-2</span>=
"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"419"></td><td =
class=3D"line-content">                                <span class=3D"html-=
tag">&lt;button <span class=3D"html-attribute-name">id</span>=3D"<span clas=
s=3D"html-attribute-value">custom-toggle-btn</span>" <span class=3D"html-at=
tribute-name">onclick</span>=3D"<span class=3D"html-attribute-value">toggle=
CustomAdd()</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"=
420"></td><td class=3D"line-content">                                    <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">btn btn-link btn-xs no-underline opacity-50 hover:opacity-100</=
span>"&gt;+ ADD CUSTOM</td></tr><tr><td class=3D"line-number" value=3D"421"=
></td><td class=3D"line-content">                                    COURSE=
<span class=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"422"></td><td class=3D"line-content">                 =
           <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td cl=
ass=3D"line-number" value=3D"423"></td><td class=3D"line-content">         =
               <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"424"></td><td class=3D"line-content"><br><=
/td></tr><tr><td class=3D"line-number" value=3D"425"></td><td class=3D"line=
-content">                        <span class=3D"html-tag">&lt;div <span cl=
ass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-v=
alue">form-control flex-1</span>"&gt;</span></td></tr><tr><td class=3D"line=
-number" value=3D"426"></td><td class=3D"line-content">                    =
        <span class=3D"html-tag">&lt;textarea <span class=3D"html-attribute=
-name">id</span>=3D"<span class=3D"html-attribute-value">f-input</span>"</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"427"></td><td class=3D=
"line-content">                                <span class=3D"html-attribut=
e-name">class</span>=3D"<span class=3D"html-attribute-value">textarea texta=
rea-bordered h-full font-mono text-sm leading-relaxed</span>"</td></tr><tr>=
<td class=3D"line-number" value=3D"428"></td><td class=3D"line-content">   =
                             <span class=3D"html-attribute-name">placeholde=
r</span>=3D"<span class=3D"html-attribute-value">Enter command context...</=
span>"&gt;<span class=3D"html-tag">&lt;/textarea&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"429"></td><td class=3D"line-content">     =
                   <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><t=
r><td class=3D"line-number" value=3D"430"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"431"></td><td class=3D"=
line-content">                        <span class=3D"html-tag">&lt;div <spa=
n class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribu=
te-value">flex flex-wrap gap-2 mt-auto</span>"&gt;</span></td></tr><tr><td =
class=3D"line-number" value=3D"432"></td><td class=3D"line-content">       =
                     <span class=3D"html-tag">&lt;button <span class=3D"htm=
l-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">btn =
btn-neutral btn-sm flex-1</span>" <span class=3D"html-attribute-name">oncli=
ck</span>=3D"<span class=3D"html-attribute-value">BuilderBack()</span>"&gt;=
</span>Back<span class=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"433"></td><td class=3D"line-content">      =
                      <span class=3D"html-tag">&lt;button <span class=3D"ht=
ml-attribute-name">id</span>=3D"<span class=3D"html-attribute-value">f-subm=
it</span>" <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">btn btn-primary btn-sm flex-1</span>"</span></td>=
</tr><tr><td class=3D"line-number" value=3D"434"></td><td class=3D"line-con=
tent">                                <span class=3D"html-attribute-name">o=
nclick</span>=3D"<span class=3D"html-attribute-value">processBuilder()</spa=
n>"&gt;Submit</td></tr><tr><td class=3D"line-number" value=3D"435"></td><td=
 class=3D"line-content">                                Command<span class=
=3D"html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"436"></td><td class=3D"line-content">                            =
<span class=3D"html-tag">&lt;button <span class=3D"html-attribute-name">id<=
/span>=3D"<span class=3D"html-attribute-value">f-next-phase</span>" <span c=
lass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-=
value">btn btn-success btn-sm flex-1 gap-1</span>"</span></td></tr><tr><td =
class=3D"line-number" value=3D"437"></td><td class=3D"line-content">       =
                         <span class=3D"html-attribute-name">onclick</span>=
=3D"<span class=3D"html-attribute-value">advancePhase()</span>"&gt;</td></t=
r><tr><td class=3D"line-number" value=3D"438"></td><td class=3D"line-conten=
t">                                Authorize Next =E2=86=92</td></tr><tr><t=
d class=3D"line-number" value=3D"439"></td><td class=3D"line-content">     =
                       <span class=3D"html-tag">&lt;/button&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"440"></td><td class=3D"line-con=
tent">                        <span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"441"></td><td class=3D"line=
-content">                    <span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"442"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"443"></td><t=
d class=3D"line-content">                    <span class=3D"html-comment">&=
lt;!-- Builder Output (Chat) --&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"444"></td><td class=3D"line-content">                    <s=
pan class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">id</span=
>=3D"<span class=3D"html-attribute-value">Builder-output</span>" <span clas=
s=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-val=
ue">flex-1 bg-base-100 relative flex flex-col</span>"&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"445"></td><td class=3D"line-content">=
                        <span class=3D"html-tag">&lt;div <span class=3D"htm=
l-attribute-name">id</span>=3D"<span class=3D"html-attribute-value">Builder=
-chat</span>" <span class=3D"html-attribute-name">class</span>=3D"<span cla=
ss=3D"html-attribute-value">flex-1 p-6 overflow-y-auto space-y-4</span>"&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"446"></td><td clas=
s=3D"line-content">                            <span class=3D"html-tag">&lt=
;div <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"htm=
l-attribute-value">chat chat-start</span>"&gt;</span></td></tr><tr><td clas=
s=3D"line-number" value=3D"447"></td><td class=3D"line-content">           =
                     <span class=3D"html-tag">&lt;div <span class=3D"html-a=
ttribute-name">class</span>=3D"<span class=3D"html-attribute-value">chat-im=
age avatar placeholder</span>"&gt;</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"448"></td><td class=3D"line-content">                       =
             <span class=3D"html-tag">&lt;div <span class=3D"html-attribute=
-name">class</span>=3D"<span class=3D"html-attribute-value">w-10 rounded-fu=
ll bg-neutral text-neutral-content</span>"&gt;</span></td></tr><tr><td clas=
s=3D"line-number" value=3D"449"></td><td class=3D"line-content">           =
                             <span class=3D"html-tag">&lt;span&gt;</span>AI=
<span class=3D"html-tag">&lt;/span&gt;</span></td></tr><tr><td class=3D"lin=
e-number" value=3D"450"></td><td class=3D"line-content">                   =
                 <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"451"></td><td class=3D"line-content">   =
                             <span class=3D"html-tag">&lt;/div&gt;</span></=
td></tr><tr><td class=3D"line-number" value=3D"452"></td><td class=3D"line-=
content">                                <span class=3D"html-tag">&lt;div <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">chat-bubble chat-bubble-primary font-mono text-sm</span>"&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"453"></td><td class=
=3D"line-content">                                    <span class=3D"html-t=
ag">&lt;strong&gt;</span>Hello, Teacher!<span class=3D"html-tag">&lt;/stron=
g&gt;</span><span class=3D"html-tag">&lt;br&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"454"></td><td class=3D"line-content">          =
                          I'm here to help you create an engaging lesson. S=
tart by selecting your curriculum</td></tr><tr><td class=3D"line-number" va=
lue=3D"455"></td><td class=3D"line-content">                               =
     context, then tell me about the topic you'd like to explore.</td></tr>=
<tr><td class=3D"line-number" value=3D"456"></td><td class=3D"line-content"=
>                                <span class=3D"html-tag">&lt;/div&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"457"></td><td class=3D"l=
ine-content">                            <span class=3D"html-tag">&lt;/div&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"458"></td><td cl=
ass=3D"line-content">                        <span class=3D"html-tag">&lt;/=
div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"459"></td><t=
d class=3D"line-content">                    <span class=3D"html-tag">&lt;/=
div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"460"></td><t=
d class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"461"></td><td class=3D"line-content">                    <span class=3D=
"html-comment">&lt;!-- Builder Loading Overlay --&gt;</span></td></tr><tr><=
td class=3D"line-number" value=3D"462"></td><td class=3D"line-content">    =
                <span class=3D"html-tag">&lt;div <span class=3D"html-attrib=
ute-name">id</span>=3D"<span class=3D"html-attribute-value">Builder-loader<=
/span>"</span></td></tr><tr><td class=3D"line-number" value=3D"463"></td><t=
d class=3D"line-content">                        <span class=3D"html-attrib=
ute-name">class</span>=3D"<span class=3D"html-attribute-value">absolute ins=
et-0 bg-black/70 flex-col items-center justify-center z-50 hidden</span>"</=
td></tr><tr><td class=3D"line-number" value=3D"464"></td><td class=3D"line-=
content">                        <span class=3D"html-attribute-name">style<=
/span>=3D"<span class=3D"html-attribute-value">display:none;</span>"&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"465"></td><td class=3D"line-c=
ontent">                        <span class=3D"html-tag">&lt;span <span cla=
ss=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-va=
lue">loading loading-spinner loading-lg text-primary mb-4</span>"&gt;</span=
><span class=3D"html-tag">&lt;/span&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"466"></td><td class=3D"line-content">                  =
      <span class=3D"html-tag">&lt;span <span class=3D"html-attribute-name"=
>id</span>=3D"<span class=3D"html-attribute-value">Builder-loader-text</spa=
n>"</span></td></tr><tr><td class=3D"line-number" value=3D"467"></td><td cl=
ass=3D"line-content">                            <span class=3D"html-attrib=
ute-name">class</span>=3D"<span class=3D"html-attribute-value">text-primary=
 font-display text-sm tracking-widest animate-pulse</span>"&gt;PROCESSING..=
.<span class=3D"html-tag">&lt;/span&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"468"></td><td class=3D"line-content">                  =
  <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"469"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"470"></td><td class=3D"line-content">   =
             <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td =
class=3D"line-number" value=3D"471"></td><td class=3D"line-content">       =
     <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"472"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"473"></td><td class=3D"line-content">=
            <span class=3D"html-comment">&lt;!-- VIEW: CLASS DIRECTORY --&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"474"></td><td cla=
ss=3D"line-content">            <span class=3D"html-tag">&lt;div <span clas=
s=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-value"=
>view-classes</span>" <span class=3D"html-attribute-name">class</span>=3D"<=
span class=3D"html-attribute-value">hidden tab-view max-w-7xl mx-auto</span=
>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"475"></td><td=
 class=3D"line-content">                <span class=3D"html-tag">&lt;div <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">flex justify-between items-center mb-6</span>"&gt;</span></td><=
/tr><tr><td class=3D"line-number" value=3D"476"></td><td class=3D"line-cont=
ent">                    <span class=3D"html-tag">&lt;div&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"477"></td><td class=3D"line-conte=
nt">                        <span class=3D"html-tag">&lt;h2 <span class=3D"=
html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">t=
ext-2xl font-display tracking-widest text-secondary</span>"&gt;</span>CLASS=
 DIRECTORY<span class=3D"html-tag">&lt;/h2&gt;</span></td></tr><tr><td clas=
s=3D"line-number" value=3D"478"></td><td class=3D"line-content">           =
             <span class=3D"html-tag">&lt;p <span class=3D"html-attribute-n=
ame">class</span>=3D"<span class=3D"html-attribute-value">text-sm opacity-6=
0</span>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"h=
tml-attribute-value">class-count-header</span>"&gt;</span>Manage student co=
horts and assigned</td></tr><tr><td class=3D"line-number" value=3D"479"></t=
d><td class=3D"line-content">                            missions.<span cla=
ss=3D"html-tag">&lt;/p&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"480"></td><td class=3D"line-content">                    <span class=
=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"481"></td><td class=3D"line-content">                    <span class=
=3D"html-tag">&lt;button <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">btn btn-secondary gap-2</span>" <s=
pan class=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-att=
ribute-value">registerClass()</span>"&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"482"></td><td class=3D"line-content">                =
        <span class=3D"html-tag">&lt;svg <span class=3D"html-attribute-name=
">xmlns</span>=3D"<span class=3D"html-attribute-value">http://www.w3.org/20=
00/svg</span>" <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">h-5 w-5</span>" <span class=3D"html-attribute-=
name">fill</span>=3D"<span class=3D"html-attribute-value">none</span>" <spa=
n class=3D"html-attribute-name">viewBox</span>=3D"<span class=3D"html-attri=
bute-value">0 0 24 24</span>"</span></td></tr><tr><td class=3D"line-number"=
 value=3D"483"></td><td class=3D"line-content">                            =
<span class=3D"html-attribute-name">stroke</span>=3D"<span class=3D"html-at=
tribute-value">currentColor</span>"&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"484"></td><td class=3D"line-content">                         =
   <span class=3D"html-tag">&lt;path <span class=3D"html-attribute-name">st=
roke-linecap</span>=3D"<span class=3D"html-attribute-value">round</span>" <=
span class=3D"html-attribute-name">stroke-linejoin</span>=3D"<span class=3D=
"html-attribute-value">round</span>" <span class=3D"html-attribute-name">st=
roke-width</span>=3D"<span class=3D"html-attribute-value">2</span>" <span c=
lass=3D"html-attribute-name">d</span>=3D"<span class=3D"html-attribute-valu=
e">M12 4v16m8-8H4</span>" /&gt;</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"485"></td><td class=3D"line-content">                        <s=
pan class=3D"html-tag">&lt;/svg&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"486"></td><td class=3D"line-content">                      =
  New Class</td></tr><tr><td class=3D"line-number" value=3D"487"></td><td c=
lass=3D"line-content">                    <span class=3D"html-tag">&lt;/but=
ton&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"488"></td><t=
d class=3D"line-content">                <span class=3D"html-tag">&lt;/div&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"489"></td><td cl=
ass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"4=
90"></td><td class=3D"line-content">                <span class=3D"html-tag=
">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">card bg-base-100 shadow-xl border border-base-con=
tent/10</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
491"></td><td class=3D"line-content">                    <span class=3D"htm=
l-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">overflow-x-auto</span>"&gt;</span></td></tr><t=
r><td class=3D"line-number" value=3D"492"></td><td class=3D"line-content"> =
                       <span class=3D"html-tag">&lt;table <span class=3D"ht=
ml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">tab=
le table-zebra w-full</span>" <span class=3D"html-attribute-name">id</span>=
=3D"<span class=3D"html-attribute-value">class-table-v3</span>"&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"493"></td><td class=3D"line=
-content">                            <span class=3D"html-tag">&lt;thead&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"494"></td><td clas=
s=3D"line-content">                                <span class=3D"html-tag"=
>&lt;tr <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"=
html-attribute-value">bg-base-200 uppercase text-xs font-bold tracking-wide=
r opacity-70</span>"&gt;</span></td></tr><tr><td class=3D"line-number" valu=
e=3D"495"></td><td class=3D"line-content">                                 =
   <span class=3D"html-tag">&lt;th&gt;</span>Class Name<span class=3D"html-=
tag">&lt;/th&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"496=
"></td><td class=3D"line-content">                                    <span=
 class=3D"html-tag">&lt;th&gt;</span>Access Code<span class=3D"html-tag">&l=
t;/th&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"497"></td>=
<td class=3D"line-content">                                    <span class=
=3D"html-tag">&lt;th&gt;</span>Students<span class=3D"html-tag">&lt;/th&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"498"></td><td class=
=3D"line-content">                                    <span class=3D"html-t=
ag">&lt;th&gt;</span>Missions<span class=3D"html-tag">&lt;/th&gt;</span></t=
d></tr><tr><td class=3D"line-number" value=3D"499"></td><td class=3D"line-c=
ontent">                                    <span class=3D"html-tag">&lt;th=
&gt;</span>Actions<span class=3D"html-tag">&lt;/th&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"500"></td><td class=3D"line-content">   =
                             <span class=3D"html-tag">&lt;/tr&gt;</span></t=
d></tr><tr><td class=3D"line-number" value=3D"501"></td><td class=3D"line-c=
ontent">                            <span class=3D"html-tag">&lt;/thead&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"502"></td><td class=
=3D"line-content">                            <span class=3D"html-tag">&lt;=
tbody <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-=
attribute-value">class-directory-list-body</span>"&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"503"></td><td class=3D"line-content">   =
                             <span class=3D"html-comment">&lt;!-- JS Inject=
s Rows Here --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"5=
04"></td><td class=3D"line-content">                                <span c=
lass=3D"html-tag">&lt;tr&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"505"></td><td class=3D"line-content">                             =
       <span class=3D"html-tag">&lt;td <span class=3D"html-attribute-name">=
colspan</span>=3D"<span class=3D"html-attribute-value">5</span>" <span clas=
s=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-val=
ue">text-center py-8 opacity-50</span>"&gt;</span>Loading class registry...=
<span class=3D"html-tag">&lt;/td&gt;</span></td></tr><tr><td class=3D"line-=
number" value=3D"506"></td><td class=3D"line-content">                     =
           <span class=3D"html-tag">&lt;/tr&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"507"></td><td class=3D"line-content">          =
                  <span class=3D"html-tag">&lt;/tbody&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"508"></td><td class=3D"line-content">=
                        <span class=3D"html-tag">&lt;/table&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"509"></td><td class=3D"line-con=
tent">                    <span class=3D"html-tag">&lt;/div&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"510"></td><td class=3D"line-con=
tent">                <span class=3D"html-tag">&lt;/div&gt;</span></td></tr=
><tr><td class=3D"line-number" value=3D"511"></td><td class=3D"line-content=
">            <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"512"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"513"></td><td class=3D"line-=
content">            <span class=3D"html-comment">&lt;!-- VIEW: LIBRARY --&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"514"></td><td cl=
ass=3D"line-content">            <span class=3D"html-tag">&lt;div <span cla=
ss=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-value=
">view-library</span>" <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">hidden tab-view max-w-7xl mx-auto</spa=
n>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"515"></td><t=
d class=3D"line-content">                <span class=3D"html-tag">&lt;div <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">flex justify-between items-center mb-6</span>"&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"516"></td><td class=3D"line-con=
tent">                    <span class=3D"html-tag">&lt;div&gt;</span></td><=
/tr><tr><td class=3D"line-number" value=3D"517"></td><td class=3D"line-cont=
ent">                        <span class=3D"html-tag">&lt;h2 <span class=3D=
"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">=
text-2xl font-display tracking-widest text-accent</span>"&gt;</span>MISSION=
 LIBRARY<span class=3D"html-tag">&lt;/h2&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"518"></td><td class=3D"line-content">            =
            <span class=3D"html-tag">&lt;p <span class=3D"html-attribute-na=
me">class</span>=3D"<span class=3D"html-attribute-value">text-sm opacity-60=
</span>"&gt;</span>Archive of all generated and deployed simulations.<span =
class=3D"html-tag">&lt;/p&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"519"></td><td class=3D"line-content">                    <span cl=
ass=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"520"></td><td class=3D"line-content">                    <span cl=
ass=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">flex gap-2</span>"&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"521"></td><td class=3D"line-con=
tent">                        <span class=3D"html-tag">&lt;button <span cla=
ss=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-va=
lue">btn btn-outline btn-sm</span>" <span class=3D"html-attribute-name">onc=
lick</span>=3D"<span class=3D"html-attribute-value">fetchMissions()</span>"=
&gt;</span>Refresh<span class=3D"html-tag">&lt;/button&gt;</span></td></tr>=
<tr><td class=3D"line-number" value=3D"522"></td><td class=3D"line-content"=
>                        <span class=3D"html-tag">&lt;button <span class=3D=
"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">=
btn btn-accent btn-sm gap-2</span>"</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"523"></td><td class=3D"line-content">                      =
      <span class=3D"html-attribute-name">onclick</span>=3D"<span class=3D"=
html-attribute-value">document.getElementById('file-input').click()</span>"=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"524"></td><td class=3D=
"line-content">                            <span class=3D"html-tag">&lt;svg=
 <span class=3D"html-attribute-name">xmlns</span>=3D"<span class=3D"html-at=
tribute-value">http://www.w3.org/2000/svg</span>" <span class=3D"html-attri=
bute-name">class</span>=3D"<span class=3D"html-attribute-value">h-4 w-4</sp=
an>" <span class=3D"html-attribute-name">fill</span>=3D"<span class=3D"html=
-attribute-value">none</span>" <span class=3D"html-attribute-name">viewBox<=
/span>=3D"<span class=3D"html-attribute-value">0 0 24 24</span>"</span></td=
></tr><tr><td class=3D"line-number" value=3D"525"></td><td class=3D"line-co=
ntent">                                <span class=3D"html-attribute-name">=
stroke</span>=3D"<span class=3D"html-attribute-value">currentColor</span>"&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"526"></td><td class=3D"=
line-content">                                <span class=3D"html-tag">&lt;=
path <span class=3D"html-attribute-name">stroke-linecap</span>=3D"<span cla=
ss=3D"html-attribute-value">round</span>" <span class=3D"html-attribute-nam=
e">stroke-linejoin</span>=3D"<span class=3D"html-attribute-value">round</sp=
an>" <span class=3D"html-attribute-name">stroke-width</span>=3D"<span class=
=3D"html-attribute-value">2</span>"</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"527"></td><td class=3D"line-content">                      =
              <span class=3D"html-attribute-name">d</span>=3D"<span class=
=3D"html-attribute-value">M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0=
 0L8 8m4-4v12</span>" /&gt;</td></tr><tr><td class=3D"line-number" value=3D=
"528"></td><td class=3D"line-content">                            <span cla=
ss=3D"html-tag">&lt;/svg&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"529"></td><td class=3D"line-content">                            U=
pload .BLOB</td></tr><tr><td class=3D"line-number" value=3D"530"></td><td c=
lass=3D"line-content">                        <span class=3D"html-tag">&lt;=
/button&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"531"></t=
d><td class=3D"line-content">                        <span class=3D"html-ta=
g">&lt;input <span class=3D"html-attribute-name">type</span>=3D"<span class=
=3D"html-attribute-value">file</span>" <span class=3D"html-attribute-name">=
id</span>=3D"<span class=3D"html-attribute-value">file-input</span>" <span =
class=3D"html-attribute-name">accept</span>=3D"<span class=3D"html-attribut=
e-value">.blob</span>" <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">hidden</span>"</span></td></tr><tr><td=
 class=3D"line-number" value=3D"532"></td><td class=3D"line-content">      =
                      <span class=3D"html-attribute-name">onchange</span>=
=3D"<span class=3D"html-attribute-value">handleFile(this.files[0])</span>"&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"533"></td><td class=3D"=
line-content">                    <span class=3D"html-tag">&lt;/div&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"534"></td><td class=3D"=
line-content">                <span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"535"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"536"></td><t=
d class=3D"line-content">                <span class=3D"html-tag">&lt;div <=
span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribu=
te-value">hub-grid</span>" <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">grid grid-cols-1 md:grid-cols-2 lg=
:grid-cols-3 gap-6</span>"&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"537"></td><td class=3D"line-content">                    <span c=
lass=3D"html-comment">&lt;!-- JS Injects Mission Cards Here --&gt;</span></=
td></tr><tr><td class=3D"line-number" value=3D"538"></td><td class=3D"line-=
content">                <span class=3D"html-tag">&lt;/div&gt;</span></td><=
/tr><tr><td class=3D"line-number" value=3D"539"></td><td class=3D"line-cont=
ent">            <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"540"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"541"></td><td class=3D"li=
ne-content">        <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"542"></td><td class=3D"line-content">=
    <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"543"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"544"></td><td class=3D"line-content"> =
   <span class=3D"html-comment">&lt;!-- Hidden Modals (DaisyUI Format) --&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"545"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"54=
6"></td><td class=3D"line-content">    <span class=3D"html-comment">&lt;!--=
 SETTINGS MODAL --&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"547"></td><td class=3D"line-content">    <span class=3D"html-tag">&lt;d=
ialog <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-=
attribute-value">settings_modal</span>" <span class=3D"html-attribute-name"=
>class</span>=3D"<span class=3D"html-attribute-value">modal</span>"&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"548"></td><td class=3D"=
line-content">        <span class=3D"html-tag">&lt;div <span class=3D"html-=
attribute-name">class</span>=3D"<span class=3D"html-attribute-value">modal-=
box bg-base-100 border border-base-content/10</span>"&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"549"></td><td class=3D"line-content">=
            <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-=
name">class</span>=3D"<span class=3D"html-attribute-value">space-y-4</span>=
"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"550"></td><td =
class=3D"line-content">                <span class=3D"html-tag">&lt;div <sp=
an class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attrib=
ute-value">form-control</span>"&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"551"></td><td class=3D"line-content">                    <s=
pan class=3D"html-tag">&lt;label <span class=3D"html-attribute-name">class<=
/span>=3D"<span class=3D"html-attribute-value">label</span>"&gt;</span><spa=
n class=3D"html-tag">&lt;span</span></td></tr><tr><td class=3D"line-number"=
 value=3D"552"></td><td class=3D"line-content">                            =
<span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-att=
ribute-value">label-text text-xs font-bold opacity-70 text-success uppercas=
e tracking-widest</span>"&gt;Global</td></tr><tr><td class=3D"line-number" =
value=3D"553"></td><td class=3D"line-content">                            A=
I Proxy (Hardwired)<span class=3D"html-tag">&lt;/span&gt;</span><span class=
=3D"html-tag">&lt;/label&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"554"></td><td class=3D"line-content">                    <span cla=
ss=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D"line-number" value=
=3D"555"></td><td class=3D"line-content">                        <span clas=
s=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-val=
ue">bg-black/20 p-2 rounded border border-white/5 font-mono text-[10px] opa=
city-60 truncate</span>"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"556"></td><td class=3D"line-content">                        https://ne=
xtjs-basic-lemon-one.vercel.app/api/chat</td></tr><tr><td class=3D"line-num=
ber" value=3D"557"></td><td class=3D"line-content">                    <spa=
n class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-num=
ber" value=3D"558"></td><td class=3D"line-content">                <span cl=
ass=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"559"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"560"></td><td class=3D"line-content">            =
    <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">cl=
ass</span>=3D"<span class=3D"html-attribute-value">divider text-xs opacity-=
50</span>"&gt;</span>CLARK DIRECT (BACKUP)<span class=3D"html-tag">&lt;/div=
&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"561"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
562"></td><td class=3D"line-content">                <span class=3D"html-ta=
g">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">form-control</span>"&gt;</span></td></tr><tr><td =
class=3D"line-number" value=3D"563"></td><td class=3D"line-content">       =
             <span class=3D"html-tag">&lt;label <span class=3D"html-attribu=
te-name">class</span>=3D"<span class=3D"html-attribute-value">label</span>"=
&gt;</span><span class=3D"html-tag">&lt;span <span class=3D"html-attribute-=
name">class</span>=3D"<span class=3D"html-attribute-value">label-text text-=
xs font-bold opacity-70</span>"&gt;</span>GOOGLE CLOUD API KEY</td></tr><tr=
><td class=3D"line-number" value=3D"564"></td><td class=3D"line-content">  =
                          (Gemini)<span class=3D"html-tag">&lt;/span&gt;</s=
pan><span class=3D"html-tag">&lt;/label&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"565"></td><td class=3D"line-content">            =
        <span class=3D"html-tag">&lt;input <span class=3D"html-attribute-na=
me">type</span>=3D"<span class=3D"html-attribute-value">password</span>" <s=
pan class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribut=
e-value">cfg-gcp-key</span>"</span></td></tr><tr><td class=3D"line-number" =
value=3D"566"></td><td class=3D"line-content">                        <span=
 class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribut=
e-value">input input-bordered input-sm font-mono tracking-widest text-xs</s=
pan>" <span class=3D"html-attribute-name">placeholder</span>=3D"<span class=
=3D"html-attribute-value">AIZA...</span>"&gt;</td></tr><tr><td class=3D"lin=
e-number" value=3D"567"></td><td class=3D"line-content">                <sp=
an class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"568"></td><td class=3D"line-content"><br></td></tr><tr><td c=
lass=3D"line-number" value=3D"569"></td><td class=3D"line-content">        =
        <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name=
">class</span>=3D"<span class=3D"html-attribute-value">form-control</span>"=
&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"570"></td><td c=
lass=3D"line-content">                    <span class=3D"html-tag">&lt;labe=
l <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-a=
ttribute-value">label</span>"&gt;</span><span class=3D"html-tag">&lt;span <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">label-text text-xs font-bold opacity-70</span>"&gt;</span>GCP =
PROJECT</td></tr><tr><td class=3D"line-number" value=3D"571"></td><td class=
=3D"line-content">                            ID<span class=3D"html-tag">&l=
t;/span&gt;</span><span class=3D"html-tag">&lt;/label&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"572"></td><td class=3D"line-content">=
                    <span class=3D"html-tag">&lt;input <span class=3D"html-=
attribute-name">type</span>=3D"<span class=3D"html-attribute-value">text</s=
pan>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-=
attribute-value">cfg-gcp-project</span>" <span class=3D"html-attribute-name=
">class</span>=3D"<span class=3D"html-attribute-value">input input-bordered=
 input-sm font-mono text-xs</span>"</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"573"></td><td class=3D"line-content">                      =
  <span class=3D"html-attribute-name">placeholder</span>=3D"<span class=3D"=
html-attribute-value">my-project-123</span>"&gt;</td></tr><tr><td class=3D"=
line-number" value=3D"574"></td><td class=3D"line-content">                =
<span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line=
-number" value=3D"575"></td><td class=3D"line-content">                <spa=
n class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</spa=
n>=3D"<span class=3D"html-attribute-value">grid grid-cols-2 gap-2</span>"&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"576"></td><td cla=
ss=3D"line-content">                    <span class=3D"html-tag">&lt;div <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">form-control</span>"&gt;</span></td></tr><tr><td class=3D"line-=
number" value=3D"577"></td><td class=3D"line-content">                     =
   <span class=3D"html-tag">&lt;label <span class=3D"html-attribute-name">c=
lass</span>=3D"<span class=3D"html-attribute-value">label</span>"&gt;</span=
><span class=3D"html-tag">&lt;span</span></td></tr><tr><td class=3D"line-nu=
mber" value=3D"578"></td><td class=3D"line-content">                       =
         <span class=3D"html-attribute-name">class</span>=3D"<span class=3D=
"html-attribute-value">label-text text-xs font-bold opacity-70</span>"&gt;L=
OCATION<span class=3D"html-tag">&lt;/span&gt;</span><span class=3D"html-tag=
">&lt;/label&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"579=
"></td><td class=3D"line-content">                        <span class=3D"ht=
ml-tag">&lt;input <span class=3D"html-attribute-name">type</span>=3D"<span =
class=3D"html-attribute-value">text</span>" <span class=3D"html-attribute-n=
ame">id</span>=3D"<span class=3D"html-attribute-value">cfg-gcp-location</sp=
an>" <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"htm=
l-attribute-value">input input-bordered input-sm font-mono text-xs</span>"<=
/span></td></tr><tr><td class=3D"line-number" value=3D"580"></td><td class=
=3D"line-content">                            <span class=3D"html-attribute=
-name">placeholder</span>=3D"<span class=3D"html-attribute-value">us-centra=
l1</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"581"></td><t=
d class=3D"line-content">                    <span class=3D"html-tag">&lt;/=
div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"582"></td><t=
d class=3D"line-content">                    <span class=3D"html-tag">&lt;d=
iv <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-=
attribute-value">form-control</span>"&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"583"></td><td class=3D"line-content">                =
        <span class=3D"html-tag">&lt;label <span class=3D"html-attribute-na=
me">class</span>=3D"<span class=3D"html-attribute-value">label</span>"&gt;<=
/span><span class=3D"html-tag">&lt;span <span class=3D"html-attribute-name"=
>class</span>=3D"<span class=3D"html-attribute-value">label-text text-xs fo=
nt-bold opacity-70</span>"&gt;</span>MODEL<span class=3D"html-tag">&lt;/spa=
n&gt;</span><span class=3D"html-tag">&lt;/label&gt;</span></td></tr><tr><td=
 class=3D"line-number" value=3D"584"></td><td class=3D"line-content">      =
                  <span class=3D"html-tag">&lt;input <span class=3D"html-at=
tribute-name">type</span>=3D"<span class=3D"html-attribute-value">text</spa=
n>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-at=
tribute-value">cfg-gcp-model</span>" <span class=3D"html-attribute-name">cl=
ass</span>=3D"<span class=3D"html-attribute-value">input input-bordered inp=
ut-sm font-mono text-xs</span>"</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"585"></td><td class=3D"line-content">                          =
  <span class=3D"html-attribute-name">placeholder</span>=3D"<span class=3D"=
html-attribute-value">gemini-1.5-flash</span>"&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"586"></td><td class=3D"line-content">            =
        <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"587"></td><td class=3D"line-content">            =
    <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"588"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"589"></td><td class=3D"line-content"> =
               <span class=3D"html-tag">&lt;div <span class=3D"html-attribu=
te-name">class</span>=3D"<span class=3D"html-attribute-value">divider text-=
xs opacity-50</span>"&gt;</span>IDENTITY &amp; DATABASE<span class=3D"html-=
tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"59=
0"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"591"></td><td class=3D"line-content">                <span cla=
ss=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D=
"<span class=3D"html-attribute-value">form-control</span>"&gt;</span></td><=
/tr><tr><td class=3D"line-number" value=3D"592"></td><td class=3D"line-cont=
ent">                    <span class=3D"html-tag">&lt;label <span class=3D"=
html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">l=
abel</span>"&gt;</span><span class=3D"html-tag">&lt;span <span class=3D"htm=
l-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">labe=
l-text text-xs font-bold opacity-70</span>"&gt;</span>TEACHER HANDLE</td></=
tr><tr><td class=3D"line-number" value=3D"593"></td><td class=3D"line-conte=
nt">                            (ID)<span class=3D"html-tag">&lt;/span&gt;<=
/span><span class=3D"html-tag">&lt;/label&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"594"></td><td class=3D"line-content">            =
        <span class=3D"html-tag">&lt;input <span class=3D"html-attribute-na=
me">type</span>=3D"<span class=3D"html-attribute-value">text</span>" <span =
class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-va=
lue">cfg-teacher-id</span>"</span></td></tr><tr><td class=3D"line-number" v=
alue=3D"595"></td><td class=3D"line-content">                        <span =
class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute=
-value">input input-bordered input-sm font-mono text-xs uppercase</span>" <=
span class=3D"html-attribute-name">placeholder</span>=3D"<span class=3D"htm=
l-attribute-value">SMITH_01</span>"&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"596"></td><td class=3D"line-content">                <span cla=
ss=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" =
value=3D"597"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"598"></td><td class=3D"line-content">            =
    <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">cl=
ass</span>=3D"<span class=3D"html-attribute-value">divider text-xs opacity-=
50 uppercase</span>"&gt;</span>Builder Settings<span class=3D"html-tag">&lt=
;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"599"></td>=
<td class=3D"line-content">                <span class=3D"html-tag">&lt;div=
 <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-at=
tribute-value">form-control</span>"&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"600"></td><td class=3D"line-content">                  =
  <span class=3D"html-tag">&lt;label <span class=3D"html-attribute-name">cl=
ass</span>=3D"<span class=3D"html-attribute-value">label</span>"&gt;</span>=
<span class=3D"html-tag">&lt;span <span class=3D"html-attribute-name">class=
</span>=3D"<span class=3D"html-attribute-value">label-text text-xs font-bol=
d opacity-70</span>"&gt;</span>AI MODEL</td></tr><tr><td class=3D"line-numb=
er" value=3D"601"></td><td class=3D"line-content">                         =
   (BUILDER)<span class=3D"html-tag">&lt;/span&gt;</span><span class=3D"htm=
l-tag">&lt;/label&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"602"></td><td class=3D"line-content">                    <span class=3D=
"html-tag">&lt;select <span class=3D"html-attribute-name">id</span>=3D"<spa=
n class=3D"html-attribute-value">cfg-builder-model</span>" <span class=3D"h=
tml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">se=
lect select-bordered select-sm font-mono text-xs</span>"&gt;</span></td></t=
r><tr><td class=3D"line-number" value=3D"603"></td><td class=3D"line-conten=
t">                        <span class=3D"html-tag">&lt;option <span class=
=3D"html-attribute-name">value</span>=3D"<span class=3D"html-attribute-valu=
e">xiaomi/mimo-v2-flash:free</span>" <span class=3D"html-attribute-name">se=
lected</span>&gt;</span>Xiaomi MiMo V2 (China)<span class=3D"html-tag">&lt;=
/option&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"604"></t=
d><td class=3D"line-content">                        <span class=3D"html-ta=
g">&lt;option <span class=3D"html-attribute-name">value</span>=3D"<span cla=
ss=3D"html-attribute-value">google/gemini-2.0-flash-exp:free</span>"&gt;</s=
pan>Gemini 2.0 Flash (Exp)<span class=3D"html-tag">&lt;/option&gt;</span></=
td></tr><tr><td class=3D"line-number" value=3D"605"></td><td class=3D"line-=
content">                        <span class=3D"html-tag">&lt;option <span =
class=3D"html-attribute-name">value</span>=3D"<span class=3D"html-attribute=
-value">mistralai/devstral-2512:free</span>"&gt;</span>Mistral 2512 (France=
)<span class=3D"html-tag">&lt;/option&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"606"></td><td class=3D"line-content">                =
        <span class=3D"html-tag">&lt;option <span class=3D"html-attribute-n=
ame">value</span>=3D"<span class=3D"html-attribute-value">nvidia/nemotron-n=
ano-9b-v2:free</span>"&gt;</span>Nemotron Nano (US)<span class=3D"html-tag"=
>&lt;/option&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"607=
"></td><td class=3D"line-content">                        <span class=3D"ht=
ml-tag">&lt;option <span class=3D"html-attribute-name">value</span>=3D"<spa=
n class=3D"html-attribute-value">meta-llama/llama-3.2-3b-instruct:free</spa=
n>"&gt;</span>Llama 3.2 3B (US)<span class=3D"html-tag">&lt;/option&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"608"></td><td class=3D"=
line-content">                        <span class=3D"html-tag">&lt;option <=
span class=3D"html-attribute-name">value</span>=3D"<span class=3D"html-attr=
ibute-value">openai/gpt-4o</span>"&gt;</span>GPT-4o (Standard)<span class=
=3D"html-tag">&lt;/option&gt;</span></td></tr><tr><td class=3D"line-number"=
 value=3D"609"></td><td class=3D"line-content">                        <spa=
n class=3D"html-tag">&lt;option <span class=3D"html-attribute-name">value</=
span>=3D"<span class=3D"html-attribute-value">anthropic/claude-3-5-sonnet</=
span>"&gt;</span>Claude 3.5 Sonnet<span class=3D"html-tag">&lt;/option&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"610"></td><td class=
=3D"line-content">                    <span class=3D"html-tag">&lt;/select&=
gt;</span></td></tr><tr><td class=3D"line-number" value=3D"611"></td><td cl=
ass=3D"line-content">                <span class=3D"html-tag">&lt;/div&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"612"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"613"=
></td><td class=3D"line-content">                <span class=3D"html-tag">&=
lt;div <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"h=
tml-attribute-value">divider text-xs opacity-50 uppercase</span>"&gt;</span=
>Global Data Link<span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"614"></td><td class=3D"line-content">   =
             <span class=3D"html-tag">&lt;div <span class=3D"html-attribute=
-name">class</span>=3D"<span class=3D"html-attribute-value">form-control</s=
pan>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"615"></td>=
<td class=3D"line-content">                    <span class=3D"html-tag">&lt=
;label <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"h=
tml-attribute-value">label</span>"&gt;</span><span class=3D"html-tag">&lt;s=
pan <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html=
-attribute-value">label-text text-xs font-bold opacity-70</span>"&gt;</span=
>SUPABASE</td></tr><tr><td class=3D"line-number" value=3D"616"></td><td cla=
ss=3D"line-content">                            UPLINK<span class=3D"html-t=
ag">&lt;/span&gt;</span><span class=3D"html-tag">&lt;/label&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"617"></td><td class=3D"line-con=
tent">                    <span class=3D"html-tag">&lt;div <span class=3D"h=
tml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">bg=
-black/20 p-2 rounded border border-white/5 font-mono text-[10px] opacity-6=
0</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"618"><=
/td><td class=3D"line-content">                        https://zwujpkuguevn=
kcqrkhas...</td></tr><tr><td class=3D"line-number" value=3D"619"></td><td c=
lass=3D"line-content">                    <span class=3D"html-tag">&lt;/div=
&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"620"></td><td c=
lass=3D"line-content">                <span class=3D"html-tag">&lt;/div&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"621"></td><td class=
=3D"line-content">                <span class=3D"html-tag">&lt;div <span cl=
ass=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-v=
alue">form-control</span>"&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"622"></td><td class=3D"line-content">                    <span c=
lass=3D"html-tag">&lt;label <span class=3D"html-attribute-name">class</span=
>=3D"<span class=3D"html-attribute-value">label</span>"&gt;</span><span cla=
ss=3D"html-tag">&lt;span <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">label-text text-xs font-bold opaci=
ty-70</span>"&gt;</span>GCP CLIENT ID</td></tr><tr><td class=3D"line-number=
" value=3D"623"></td><td class=3D"line-content">                           =
 (Auth)<span class=3D"html-tag">&lt;/span&gt;</span><span class=3D"html-tag=
">&lt;/label&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"624=
"></td><td class=3D"line-content">                    <span class=3D"html-t=
ag">&lt;input <span class=3D"html-attribute-name">type</span>=3D"<span clas=
s=3D"html-attribute-value">text</span>" <span class=3D"html-attribute-name"=
>id</span>=3D"<span class=3D"html-attribute-value">cfg-gcp-client-id</span>=
" <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-a=
ttribute-value">input input-bordered input-sm font-mono text-xs</span>"</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"625"></td><td class=3D"=
line-content">                        <span class=3D"html-attribute-name">p=
laceholder</span>=3D"<span class=3D"html-attribute-value">9859...apps.googl=
eusercontent.com</span>"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"626"></td><td class=3D"line-content">                <span class=3D"htm=
l-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
627"></td><td class=3D"line-content">            <span class=3D"html-tag">&=
lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"628"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"629"></td><td class=3D"line-content">            <span class=3D"html=
-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cla=
ss=3D"html-attribute-value">modal-action</span>"&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"630"></td><td class=3D"line-content">     =
           <span class=3D"html-tag">&lt;button <span class=3D"html-attribut=
e-name">class</span>=3D"<span class=3D"html-attribute-value">btn btn-ghost =
btn-sm</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"631">=
</td><td class=3D"line-content">                    <span class=3D"html-att=
ribute-name">onclick</span>=3D"<span class=3D"html-attribute-value">documen=
t.getElementById('settings_modal').close()</span>"&gt;Cancel<span class=3D"=
html-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" val=
ue=3D"632"></td><td class=3D"line-content">                <span class=3D"h=
tml-tag">&lt;button <span class=3D"html-attribute-name">class</span>=3D"<sp=
an class=3D"html-attribute-value">btn btn-primary btn-sm</span>" <span clas=
s=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-attribute-v=
alue">saveSettings()</span>"&gt;</span>SAVE CONFIG<span class=3D"html-tag">=
&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"633"=
></td><td class=3D"line-content">            <span class=3D"html-tag">&lt;/=
div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"634"></td><t=
d class=3D"line-content">        <span class=3D"html-tag">&lt;/div&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"635"></td><td class=3D"l=
ine-content">        <span class=3D"html-tag">&lt;form <span class=3D"html-=
attribute-name">method</span>=3D"<span class=3D"html-attribute-value">dialo=
g</span>" <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">modal-backdrop</span>"&gt;</span></td></tr><tr><t=
d class=3D"line-number" value=3D"636"></td><td class=3D"line-content">     =
       <span class=3D"html-tag">&lt;button&gt;</span>close<span class=3D"ht=
ml-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"637"></td><td class=3D"line-content">        <span class=3D"html-tag">&=
lt;/form&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"638"></=
td><td class=3D"line-content">    <span class=3D"html-tag">&lt;/dialog&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"639"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"640"=
></td><td class=3D"line-content">    <span class=3D"html-comment">&lt;!-- A=
UTH MODAL --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"641=
"></td><td class=3D"line-content">    <span class=3D"html-tag">&lt;dialog <=
span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribu=
te-value">auth_modal</span>" <span class=3D"html-attribute-name">class</spa=
n>=3D"<span class=3D"html-attribute-value">modal modal-bottom sm:modal-midd=
le</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"642">=
</td><td class=3D"line-content">        <span class=3D"html-tag">&lt;div <s=
pan class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attri=
bute-value">modal-box bg-base-100 border border-primary/20</span>"&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"643"></td><td class=3D"l=
ine-content">            <span class=3D"html-tag">&lt;h3 <span class=3D"htm=
l-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">font=
-bold text-lg font-display text-primary tracking-widest text-center mb-4</s=
pan>"&gt;</span>IDENTITY</td></tr><tr><td class=3D"line-number" value=3D"64=
4"></td><td class=3D"line-content">                VERIFICATION<span class=
=3D"html-tag">&lt;/h3&gt;</span></td></tr><tr><td class=3D"line-number" val=
ue=3D"645"></td><td class=3D"line-content">            <span class=3D"html-=
tag">&lt;div <span class=3D"html-attribute-name">id</span>=3D"<span class=
=3D"html-attribute-value">google-signin-container</span>" <span class=3D"ht=
ml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">fle=
x justify-center my-4</span>"&gt;</span><span class=3D"html-tag">&lt;/div&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"646"></td><td cla=
ss=3D"line-content">            <span class=3D"html-tag">&lt;p <span class=
=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-valu=
e">py-4 text-center text-xs opacity-60</span>"&gt;</span>Secure Teacher Acc=
ess Required<span class=3D"html-tag">&lt;/p&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"647"></td><td class=3D"line-content">        <s=
pan class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"648"></td><td class=3D"line-content">    <span class=3D"htm=
l-tag">&lt;/dialog&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"649"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"lin=
e-number" value=3D"650"></td><td class=3D"line-content">    <span class=3D"=
html-comment">&lt;!-- HOSPITAL MODAL (Node Editor) --&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"651"></td><td class=3D"line-content">=
    <span class=3D"html-tag">&lt;dialog <span class=3D"html-attribute-name"=
>id</span>=3D"<span class=3D"html-attribute-value">hospital_modal</span>" <=
span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attr=
ibute-value">modal modal-bottom sm:modal-middle</span>"&gt;</span></td></tr=
><tr><td class=3D"line-number" value=3D"652"></td><td class=3D"line-content=
">        <span class=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D=
"line-number" value=3D"653"></td><td class=3D"line-content">            <sp=
an class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attrib=
ute-value">modal-box w-11/12 max-w-7xl h-[90vh] bg-base-100 border border-s=
econdary/20 p-0 flex flex-col overflow-hidden</span>"&gt;</td></tr><tr><td =
class=3D"line-number" value=3D"654"></td><td class=3D"line-content">       =
     <span class=3D"html-comment">&lt;!-- Modal Header --&gt;</span></td></=
tr><tr><td class=3D"line-number" value=3D"655"></td><td class=3D"line-conte=
nt">            <span class=3D"html-tag">&lt;div <span class=3D"html-attrib=
ute-name">class</span>=3D"<span class=3D"html-attribute-value">bg-base-200 =
px-6 py-4 border-b border-base-content/10 flex justify-between items-center=
</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"656"></=
td><td class=3D"line-content">                <span class=3D"html-tag">&lt;=
h3 <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-=
attribute-value">font-bold text-lg font-display tracking-widest text-second=
ary flex items-center gap-2</span>"&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"657"></td><td class=3D"line-content">                  =
  MISSION HOSPITAL <span class=3D"html-tag">&lt;span <span class=3D"html-at=
tribute-name">class</span>=3D"<span class=3D"html-attribute-value">badge ba=
dge-outline badge-xs font-mono opacity-50</span>"&gt;</span>SURGICAL</td></=
tr><tr><td class=3D"line-number" value=3D"658"></td><td class=3D"line-conte=
nt">                        THEATER<span class=3D"html-tag">&lt;/span&gt;</=
span></td></tr><tr><td class=3D"line-number" value=3D"659"></td><td class=
=3D"line-content">                <span class=3D"html-tag">&lt;/h3&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"660"></td><td class=3D"l=
ine-content">                <span class=3D"html-tag">&lt;div <span class=
=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-valu=
e">flex gap-2</span>"&gt;</span></td></tr><tr><td class=3D"line-number" val=
ue=3D"661"></td><td class=3D"line-content">                    <span class=
=3D"html-tag">&lt;button <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">btn btn-sm btn-ghost</span>" <span=
 class=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-attrib=
ute-value">closeHospital()</span>"&gt;</span>CANCEL<span class=3D"html-tag"=
>&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"662=
"></td><td class=3D"line-content">                    <span class=3D"html-t=
ag">&lt;button <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">btn btn-sm btn-secondary</span>" <span class=
=3D"html-attribute-name">onclick</span>=3D"<span class=3D"html-attribute-va=
lue">saveHospitalChanges()</span>"&gt;</span>SAVE CHANGES<span class=3D"htm=
l-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"663"></td><td class=3D"line-content">                <span class=3D"htm=
l-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
664"></td><td class=3D"line-content">            <span class=3D"html-tag">&=
lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"665"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"666"></td><td class=3D"line-content">            <span class=3D"html=
-comment">&lt;!-- Modal Body --&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"667"></td><td class=3D"line-content">            <span clas=
s=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"=
<span class=3D"html-attribute-value">flex-1 flex overflow-hidden</span>"&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"668"></td><td clas=
s=3D"line-content">                <span class=3D"html-comment">&lt;!-- Sli=
de List Sidebar --&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"669"></td><td class=3D"line-content">                <span class=3D"htm=
l-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">w-64 bg-base-200/50 border-r border-base-conte=
nt/10 overflow-y-auto p-4 space-y-1</span>"</span></td></tr><tr><td class=
=3D"line-number" value=3D"670"></td><td class=3D"line-content">            =
        <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"htm=
l-attribute-value">h-slide-list</span>"&gt;</td></tr><tr><td class=3D"line-=
number" value=3D"671"></td><td class=3D"line-content">                    <=
span class=3D"html-comment">&lt;!-- Injected JS --&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"672"></td><td class=3D"line-content">   =
             <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td =
class=3D"line-number" value=3D"673"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"674"></td><td class=3D"line-c=
ontent">                <span class=3D"html-comment">&lt;!-- Main Surgical =
Area --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"675"></t=
d><td class=3D"line-content">                <span class=3D"html-tag">&lt;d=
iv <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-=
attribute-value">flex-1 flex overflow-hidden</span>" <span class=3D"html-at=
tribute-name">id</span>=3D"<span class=3D"html-attribute-value">h-surgical-=
area</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"676=
"></td><td class=3D"line-content">                    <span class=3D"html-c=
omment">&lt;!-- Left: Visual Monitor --&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"677"></td><td class=3D"line-content">            =
        <span class=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"678"></td><td class=3D"line-content">                 =
       <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"h=
tml-attribute-value">w-1/3 border-r border-base-content/10 flex flex-col p-=
4 space-y-4 overflow-y-auto bg-black/10</span>"&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"679"></td><td class=3D"line-content">            =
            <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-=
name">class</span>=3D"<span class=3D"html-attribute-value">text-[10px] font=
-bold text-secondary tracking-widest uppercase opacity-50</span>"&gt;</span=
>Visual</td></tr><tr><td class=3D"line-number" value=3D"680"></td><td class=
=3D"line-content">                            Sensor Feed<span class=3D"htm=
l-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"=
681"></td><td class=3D"line-content">                        <span class=3D=
"html-tag">&lt;div <span class=3D"html-attribute-name">id</span>=3D"<span c=
lass=3D"html-attribute-value">h-visual-preview</span>"</span></td></tr><tr>=
<td class=3D"line-number" value=3D"682"></td><td class=3D"line-content">   =
                         <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">bg-black/40 rounded border border-=
white/5 aspect-video flex items-center justify-center overflow-hidden</span=
>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"683"></td><td class=
=3D"line-content">                            <span class=3D"html-tag">&lt;=
span <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"htm=
l-attribute-value">text-xs opacity-20 font-mono</span>"&gt;</span>NO SIGNAL=
<span class=3D"html-tag">&lt;/span&gt;</span></td></tr><tr><td class=3D"lin=
e-number" value=3D"684"></td><td class=3D"line-content">                   =
     <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"685"></td><td class=3D"line-content">               =
         <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-nam=
e">class</span>=3D"<span class=3D"html-attribute-value">space-y-3</span>"&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"686"></td><td cla=
ss=3D"line-content">                            <span class=3D"html-tag">&l=
t;div <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"ht=
ml-attribute-value">form-control</span>"&gt;</span></td></tr><tr><td class=
=3D"line-number" value=3D"687"></td><td class=3D"line-content">            =
                    <span class=3D"html-tag">&lt;label <span class=3D"html-=
attribute-name">class</span>=3D"<span class=3D"html-attribute-value">label =
py-1</span>"&gt;</span><span class=3D"html-tag">&lt;span</span></td></tr><t=
r><td class=3D"line-number" value=3D"688"></td><td class=3D"line-content"> =
                                       <span class=3D"html-attribute-name">=
class</span>=3D"<span class=3D"html-attribute-value">label-text-alt text-[1=
0px] font-bold opacity-50 uppercase</span>"&gt;Slide</td></tr><tr><td class=
=3D"line-number" value=3D"689"></td><td class=3D"line-content">            =
                            Title<span class=3D"html-tag">&lt;/span&gt;</sp=
an><span class=3D"html-tag">&lt;/label&gt;</span></td></tr><tr><td class=3D=
"line-number" value=3D"690"></td><td class=3D"line-content">               =
                 <span class=3D"html-tag">&lt;input <span class=3D"html-att=
ribute-name">type</span>=3D"<span class=3D"html-attribute-value">text</span=
>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-att=
ribute-value">h-title</span>" <span class=3D"html-attribute-name">class</sp=
an>=3D"<span class=3D"html-attribute-value">input input-bordered input-sm f=
ont-display</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"=
691"></td><td class=3D"line-content">                                    <s=
pan class=3D"html-attribute-name">placeholder</span>=3D"<span class=3D"html=
-attribute-value">Node Title</span>"&gt;</td></tr><tr><td class=3D"line-num=
ber" value=3D"692"></td><td class=3D"line-content">                        =
    <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"=
line-number" value=3D"693"></td><td class=3D"line-content">                =
            <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-=
name">class</span>=3D"<span class=3D"html-attribute-value">form-control</sp=
an>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"694"></td><=
td class=3D"line-content">                                <span class=3D"ht=
ml-tag">&lt;label <span class=3D"html-attribute-name">class</span>=3D"<span=
 class=3D"html-attribute-value">label py-1</span>"&gt;</span><span class=3D=
"html-tag">&lt;span</span></td></tr><tr><td class=3D"line-number" value=3D"=
695"></td><td class=3D"line-content">                                      =
  <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-a=
ttribute-value">label-text-alt text-[10px] font-bold opacity-50 uppercase</=
span>"&gt;Media URL</td></tr><tr><td class=3D"line-number" value=3D"696"></=
td><td class=3D"line-content">                                        (IMG/=
YT/PDF)<span class=3D"html-tag">&lt;/span&gt;</span><span class=3D"html-tag=
">&lt;/label&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"697=
"></td><td class=3D"line-content">                                <span cla=
ss=3D"html-tag">&lt;input <span class=3D"html-attribute-name">type</span>=
=3D"<span class=3D"html-attribute-value">text</span>" <span class=3D"html-a=
ttribute-name">id</span>=3D"<span class=3D"html-attribute-value">h-media-ur=
l</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"698"></td>=
<td class=3D"line-content">                                    <span class=
=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribute-valu=
e">input input-bordered input-sm font-mono text-[10px]</span>"</td></tr><tr=
><td class=3D"line-number" value=3D"699"></td><td class=3D"line-content">  =
                                  <span class=3D"html-attribute-name">oncha=
nge</span>=3D"<span class=3D"html-attribute-value">updateHospitalPreview(th=
is.value)</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"700">=
</td><td class=3D"line-content">                            <span class=3D"=
html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"701"></td><td class=3D"line-content">                            <span =
class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">form-control</span>"&gt;</span></t=
d></tr><tr><td class=3D"line-number" value=3D"702"></td><td class=3D"line-c=
ontent">                                <span class=3D"html-tag">&lt;label =
<span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-att=
ribute-value">label py-1</span>"&gt;</span><span class=3D"html-tag">&lt;spa=
n</span></td></tr><tr><td class=3D"line-number" value=3D"703"></td><td clas=
s=3D"line-content">                                        <span class=3D"h=
tml-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">la=
bel-text-alt text-[10px] font-bold opacity-50 uppercase</span>"&gt;Visual P=
rompt</td></tr><tr><td class=3D"line-number" value=3D"704"></td><td class=
=3D"line-content">                                        (AI Reference)<sp=
an class=3D"html-tag">&lt;/span&gt;</span><span class=3D"html-tag">&lt;/lab=
el&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"705"></td><td=
 class=3D"line-content">                                <span class=3D"html=
-tag">&lt;textarea <span class=3D"html-attribute-name">id</span>=3D"<span c=
lass=3D"html-attribute-value">h-visual-prompt</span>"</span></td></tr><tr><=
td class=3D"line-number" value=3D"706"></td><td class=3D"line-content">    =
                                <span class=3D"html-attribute-name">class</=
span>=3D"<span class=3D"html-attribute-value">textarea textarea-bordered h-=
20 font-mono text-xs</span>"&gt;<span class=3D"html-tag">&lt;/textarea&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"707"></td><td class=
=3D"line-content">                            <span class=3D"html-tag">&lt;=
/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"708"></td><=
td class=3D"line-content">                        <span class=3D"html-tag">=
&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"709"></=
td><td class=3D"line-content">                    <span class=3D"html-tag">=
&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"710"></=
td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" v=
alue=3D"711"></td><td class=3D"line-content">                    <span clas=
s=3D"html-comment">&lt;!-- Right: Narrative Input (Quill) --&gt;</span></td=
></tr><tr><td class=3D"line-number" value=3D"712"></td><td class=3D"line-co=
ntent">                    <span class=3D"html-tag">&lt;div <span class=3D"=
html-attribute-name">class</span>=3D"<span class=3D"html-attribute-value">f=
lex-1 flex flex-col overflow-hidden</span>"&gt;</span></td></tr><tr><td cla=
ss=3D"line-number" value=3D"713"></td><td class=3D"line-content">          =
              <span class=3D"html-comment">&lt;!-- Tab Navigation --&gt;</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"714"></td><td class=3D=
"line-content">                        <span class=3D"html-tag">&lt;div <sp=
an class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attrib=
ute-value">flex bg-base-300/50 p-1 gap-1 border-b border-base-content/10</s=
pan>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-=
attribute-value">h-tabs-nav</span>"&gt;</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"715"></td><td class=3D"line-content">                  =
          <span class=3D"html-comment">&lt;!-- Injected JS Tabs --&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"716"></td><td class=3D"l=
ine-content">                        <span class=3D"html-tag">&lt;/div&gt;<=
/span></td></tr><tr><td class=3D"line-number" value=3D"717"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"718"=
></td><td class=3D"line-content">                        <span class=3D"htm=
l-tag">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span cl=
ass=3D"html-attribute-value">flex-1 flex flex-col overflow-hidden bg-base-1=
00</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"719">=
</td><td class=3D"line-content">                            <span class=3D"=
html-tag">&lt;div <span class=3D"html-attribute-name">id</span>=3D"<span cl=
ass=3D"html-attribute-value">quill-editor</span>" <span class=3D"html-attri=
bute-name">class</span>=3D"<span class=3D"html-attribute-value">flex-1 over=
flow-y-auto</span>"&gt;</span><span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"720"></td><td class=3D"line=
-content">                        <span class=3D"html-tag">&lt;/div&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"721"></td><td class=3D"=
line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"722"></t=
d><td class=3D"line-content">                        <span class=3D"html-co=
mment">&lt;!-- Footer metadata --&gt;</span></td></tr><tr><td class=3D"line=
-number" value=3D"723"></td><td class=3D"line-content">                    =
    <span class=3D"html-tag">&lt;div</span></td></tr><tr><td class=3D"line-=
number" value=3D"724"></td><td class=3D"line-content">                     =
       <span class=3D"html-attribute-name">class</span>=3D"<span class=3D"h=
tml-attribute-value">bg-base-200 p-2 flex justify-between items-center text=
-[10px] font-mono opacity-50 border-t border-base-content/10</span>"&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"725"></td><td class=3D"line-c=
ontent">                            <span class=3D"html-tag">&lt;div&gt;</s=
pan>PATH: <span class=3D"html-tag">&lt;span <span class=3D"html-attribute-n=
ame">id</span>=3D"<span class=3D"html-attribute-value">h-path</span>"&gt;</=
span>SLIDE -&gt; CONTENT<span class=3D"html-tag">&lt;/span&gt;</span><span =
class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-numbe=
r" value=3D"726"></td><td class=3D"line-content">                          =
  <span class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">clas=
s</span>=3D"<span class=3D"html-attribute-value">flex gap-4</span>"&gt;</sp=
an></td></tr><tr><td class=3D"line-number" value=3D"727"></td><td class=3D"=
line-content">                                <span class=3D"html-tag">&lt;=
div&gt;</span>DECISION A: <span class=3D"html-tag">&lt;input <span class=3D=
"html-attribute-name">type</span>=3D"<span class=3D"html-attribute-value">t=
ext</span>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D=
"html-attribute-value">h-choice-a</span>"</span></td></tr><tr><td class=3D"=
line-number" value=3D"728"></td><td class=3D"line-content">                =
                        <span class=3D"html-attribute-name">class</span>=3D=
"<span class=3D"html-attribute-value">bg-transparent border-b border-white/=
10 outline-none w-24</span>"&gt;<span class=3D"html-tag">&lt;/div&gt;</span=
></td></tr><tr><td class=3D"line-number" value=3D"729"></td><td class=3D"li=
ne-content">                                <span class=3D"html-tag">&lt;di=
v&gt;</span>DECISION B: <span class=3D"html-tag">&lt;input <span class=3D"h=
tml-attribute-name">type</span>=3D"<span class=3D"html-attribute-value">tex=
t</span>" <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"h=
tml-attribute-value">h-choice-b</span>"</span></td></tr><tr><td class=3D"li=
ne-number" value=3D"730"></td><td class=3D"line-content">                  =
                      <span class=3D"html-attribute-name">class</span>=3D"<=
span class=3D"html-attribute-value">bg-transparent border-b border-white/10=
 outline-none w-24</span>"&gt;<span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"731"></td><td class=3D"line=
-content">                            <span class=3D"html-tag">&lt;/div&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"732"></td><td class=
=3D"line-content">                        <span class=3D"html-tag">&lt;/div=
&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"733"></td><td c=
lass=3D"line-content">                    <span class=3D"html-tag">&lt;/div=
&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"734"></td><td c=
lass=3D"line-content">                <span class=3D"html-tag">&lt;/div&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"735"></td><td class=
=3D"line-content">            <span class=3D"html-tag">&lt;/div&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"736"></td><td class=3D"line=
-content">        <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr=
><td class=3D"line-number" value=3D"737"></td><td class=3D"line-content">  =
      <span class=3D"html-tag">&lt;form <span class=3D"html-attribute-name"=
>method</span>=3D"<span class=3D"html-attribute-value">dialog</span>" <span=
 class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-attribut=
e-value">modal-backdrop</span>"&gt;</span></td></tr><tr><td class=3D"line-n=
umber" value=3D"738"></td><td class=3D"line-content">            <span clas=
s=3D"html-tag">&lt;button&gt;</span>close<span class=3D"html-tag">&lt;/butt=
on&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"739"></td><td=
 class=3D"line-content">        <span class=3D"html-tag">&lt;/form&gt;</spa=
n></td></tr><tr><td class=3D"line-number" value=3D"740"></td><td class=3D"l=
ine-content">    <span class=3D"html-tag">&lt;/dialog&gt;</span></td></tr><=
tr><td class=3D"line-number" value=3D"741"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"742"></td><td class=3D=
"line-content">    <span class=3D"html-comment">&lt;!-- INTEL MODAL (Narrat=
ive Viewer) --&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"7=
43"></td><td class=3D"line-content">    <span class=3D"html-tag">&lt;dialog=
 <span class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attri=
bute-value">intel_modal</span>" <span class=3D"html-attribute-name">class</=
span>=3D"<span class=3D"html-attribute-value">modal</span>"&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"744"></td><td class=3D"line-con=
tent">        <span class=3D"html-tag">&lt;div <span class=3D"html-attribut=
e-name">class</span>=3D"<span class=3D"html-attribute-value">modal-box bg-b=
ase-100 border border-primary/20 max-w-2xl</span>"&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"745"></td><td class=3D"line-content">   =
         <span class=3D"html-tag">&lt;h3 <span class=3D"html-attribute-name=
">id</span>=3D"<span class=3D"html-attribute-value">intel-modal-title</span=
>"</span></td></tr><tr><td class=3D"line-number" value=3D"746"></td><td cla=
ss=3D"line-content">                <span class=3D"html-attribute-name">cla=
ss</span>=3D"<span class=3D"html-attribute-value">font-bold text-lg font-di=
splay text-primary tracking-widest mb-4 uppercase</span>"&gt;SLIDE INTEL<sp=
an class=3D"html-tag">&lt;/h3&gt;</span></td></tr><tr><td class=3D"line-num=
ber" value=3D"747"></td><td class=3D"line-content">            <span class=
=3D"html-tag">&lt;div <span class=3D"html-attribute-name">id</span>=3D"<spa=
n class=3D"html-attribute-value">intel-modal-content</span>"</span></td></t=
r><tr><td class=3D"line-number" value=3D"748"></td><td class=3D"line-conten=
t">                <span class=3D"html-attribute-name">class</span>=3D"<spa=
n class=3D"html-attribute-value">prose prose-sm font-mono text-sm leading-r=
elaxed max-h-[60vh] overflow-y-auto bg-black/20 p-4 rounded border border-w=
hite/5</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"749"></t=
d><td class=3D"line-content">                <span class=3D"html-comment">&=
lt;!-- Injected content --&gt;</span></td></tr><tr><td class=3D"line-number=
" value=3D"750"></td><td class=3D"line-content">            <span class=3D"=
html-tag">&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"751"></td><td class=3D"line-content">            <span class=3D"html-ta=
g">&lt;div <span class=3D"html-attribute-name">class</span>=3D"<span class=
=3D"html-attribute-value">modal-action</span>"&gt;</span></td></tr><tr><td =
class=3D"line-number" value=3D"752"></td><td class=3D"line-content">       =
         <span class=3D"html-tag">&lt;form <span class=3D"html-attribute-na=
me">method</span>=3D"<span class=3D"html-attribute-value">dialog</span>"&gt=
;</span></td></tr><tr><td class=3D"line-number" value=3D"753"></td><td clas=
s=3D"line-content">                    <span class=3D"html-tag">&lt;button =
<span class=3D"html-attribute-name">class</span>=3D"<span class=3D"html-att=
ribute-value">btn btn-sm btn-ghost</span>"&gt;</span>CLOSE<span class=3D"ht=
ml-tag">&lt;/button&gt;</span></td></tr><tr><td class=3D"line-number" value=
=3D"754"></td><td class=3D"line-content">                <span class=3D"htm=
l-tag">&lt;/form&gt;</span></td></tr><tr><td class=3D"line-number" value=3D=
"755"></td><td class=3D"line-content">            <span class=3D"html-tag">=
&lt;/div&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"756"></=
td><td class=3D"line-content">        <span class=3D"html-tag">&lt;/div&gt;=
</span></td></tr><tr><td class=3D"line-number" value=3D"757"></td><td class=
=3D"line-content">    <span class=3D"html-tag">&lt;/dialog&gt;</span></td><=
/tr><tr><td class=3D"line-number" value=3D"758"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"759"></td><td cla=
ss=3D"line-content">    <span class=3D"html-tag">&lt;script&gt;</span></td>=
</tr><tr><td class=3D"line-number" value=3D"760"></td><td class=3D"line-con=
tent">        // --- INTEL VIEWER LOGIC ---</td></tr><tr><td class=3D"line-=
number" value=3D"761"></td><td class=3D"line-content">        function open=
IntelModal(slideIdx) {</td></tr><tr><td class=3D"line-number" value=3D"762"=
></td><td class=3D"line-content">            const slide =3D accumulatedDat=
a.slides[slideIdx];</td></tr><tr><td class=3D"line-number" value=3D"763"></=
td><td class=3D"line-content">            if (!slide) return;</td></tr><tr>=
<td class=3D"line-number" value=3D"764"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"765"></td><td class=3D"li=
ne-content">            const modal =3D document.getElementById('intel_moda=
l');</td></tr><tr><td class=3D"line-number" value=3D"766"></td><td class=3D=
"line-content">            const title =3D document.getElementById('intel-m=
odal-title');</td></tr><tr><td class=3D"line-number" value=3D"767"></td><td=
 class=3D"line-content">            const content =3D document.getElementBy=
Id('intel-modal-content');</td></tr><tr><td class=3D"line-number" value=3D"=
768"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-nu=
mber" value=3D"769"></td><td class=3D"line-content">            const slide=
Title =3D slide.title || slide.shortTitle || `Slide ${slideIdx + 1}`;</td><=
/tr><tr><td class=3D"line-number" value=3D"770"></td><td class=3D"line-cont=
ent">            title.innerText =3D `INTEL: ${slideTitle.toUpperCase()}`;<=
/td></tr><tr><td class=3D"line-number" value=3D"771"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"772"></td><t=
d class=3D"line-content">            // Show content, prefer tabs.primary.c=
ontent then brief/content</td></tr><tr><td class=3D"line-number" value=3D"7=
73"></td><td class=3D"line-content">            const fullContent =3D slide=
.tabs?.primary?.content || slide.content || slide.brief || "*NO NARRATIVE D=
ATA DETECTED*";</td></tr><tr><td class=3D"line-number" value=3D"774"></td><=
td class=3D"line-content">            content.innerHTML =3D (typeof marked =
!=3D=3D 'undefined') ? marked.parse(fullContent) : fullContent;</td></tr><t=
r><td class=3D"line-number" value=3D"775"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"776"></td><td class=3D"=
line-content">            modal.showModal();</td></tr><tr><td class=3D"line=
-number" value=3D"777"></td><td class=3D"line-content">        }</td></tr><=
tr><td class=3D"line-number" value=3D"778"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"779"></td><td class=3D=
"line-content">        // --- UX GLUE CODE (V3) ---</td></tr><tr><td class=
=3D"line-number" value=3D"780"></td><td class=3D"line-content"><br></td></t=
r><tr><td class=3D"line-number" value=3D"781"></td><td class=3D"line-conten=
t">        function switchMainTab(tabName) {</td></tr><tr><td class=3D"line=
-number" value=3D"782"></td><td class=3D"line-content">            // Hide =
all views</td></tr><tr><td class=3D"line-number" value=3D"783"></td><td cla=
ss=3D"line-content">            document.querySelectorAll('.tab-view').forE=
ach(el =3D&gt; el.classList.add('hidden'));</td></tr><tr><td class=3D"line-=
number" value=3D"784"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"785"></td><td class=3D"line-content">      =
      // Show target</td></tr><tr><td class=3D"line-number" value=3D"786"><=
/td><td class=3D"line-content">            document.getElementById(`view-${=
tabName}`).classList.remove('hidden');</td></tr><tr><td class=3D"line-numbe=
r" value=3D"787"></td><td class=3D"line-content"><br></td></tr><tr><td clas=
s=3D"line-number" value=3D"788"></td><td class=3D"line-content">           =
 // Update Sidebar Active State</td></tr><tr><td class=3D"line-number" valu=
e=3D"789"></td><td class=3D"line-content">            document.querySelecto=
rAll('.menu a').forEach(el =3D&gt; el.classList.remove('active'));</td></tr=
><tr><td class=3D"line-number" value=3D"790"></td><td class=3D"line-content=
">            // (Simplified: In prod, map tabName to index or specific ID)=
</td></tr><tr><td class=3D"line-number" value=3D"791"></td><td class=3D"lin=
e-content">        }</td></tr><tr><td class=3D"line-number" value=3D"792"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"793"></td><td class=3D"line-content">        function log(msg, typ=
e =3D 'info') {</td></tr><tr><td class=3D"line-number" value=3D"794"></td><=
td class=3D"line-content">            const c =3D document.getElementById('=
sm-console');</td></tr><tr><td class=3D"line-number" value=3D"795"></td><td=
 class=3D"line-content">            const time =3D new Date().toLocaleTimeS=
tring();</td></tr><tr><td class=3D"line-number" value=3D"796"></td><td clas=
s=3D"line-content">            let color =3D 'text-base-content';</td></tr>=
<tr><td class=3D"line-number" value=3D"797"></td><td class=3D"line-content"=
>            if (type =3D=3D=3D 'error') color =3D 'text-error';</td></tr><=
tr><td class=3D"line-number" value=3D"798"></td><td class=3D"line-content">=
            if (type =3D=3D=3D 'success') color =3D 'text-success';</td></t=
r><tr><td class=3D"line-number" value=3D"799"></td><td class=3D"line-conten=
t">            if (type =3D=3D=3D 'warning') color =3D 'text-warning';</td>=
</tr><tr><td class=3D"line-number" value=3D"800"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"801"></td><td cl=
ass=3D"line-content">            c.innerHTML +=3D `&lt;div class=3D"${color=
} hover:bg-base-content/5 px-1 rounded font-mono"&gt;&gt; [${time}] ${msg}&=
lt;/div&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"802"></td><td=
 class=3D"line-content">            c.scrollTop =3D c.scrollHeight;</td></t=
r><tr><td class=3D"line-number" value=3D"803"></td><td class=3D"line-conten=
t">        }</td></tr><tr><td class=3D"line-number" value=3D"804"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"805"></td><td class=3D"line-content">        function toggleSystemLog() {<=
/td></tr><tr><td class=3D"line-number" value=3D"806"></td><td class=3D"line=
-content">            const parent =3D document.getElementById('log-parent'=
);</td></tr><tr><td class=3D"line-number" value=3D"807"></td><td class=3D"l=
ine-content">            const console =3D document.getElementById('sm-cons=
ole');</td></tr><tr><td class=3D"line-number" value=3D"808"></td><td class=
=3D"line-content">            const btn =3D document.getElementById('log-to=
ggle-btn');</td></tr><tr><td class=3D"line-number" value=3D"809"></td><td c=
lass=3D"line-content">            const isShrunk =3D parent.classList.conta=
ins('flex-none');</td></tr><tr><td class=3D"line-number" value=3D"810"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"811"></td><td class=3D"line-content">            if (isShrunk) {</td>=
</tr><tr><td class=3D"line-number" value=3D"812"></td><td class=3D"line-con=
tent">                parent.classList.remove('flex-none', 'h-10');</td></t=
r><tr><td class=3D"line-number" value=3D"813"></td><td class=3D"line-conten=
t">                parent.classList.add('flex-1');</td></tr><tr><td class=
=3D"line-number" value=3D"814"></td><td class=3D"line-content">            =
    console.classList.remove('hidden');</td></tr><tr><td class=3D"line-numb=
er" value=3D"815"></td><td class=3D"line-content">                btn.inner=
Text =3D 'SHRINK';</td></tr><tr><td class=3D"line-number" value=3D"816"></t=
d><td class=3D"line-content">            } else {</td></tr><tr><td class=3D=
"line-number" value=3D"817"></td><td class=3D"line-content">               =
 parent.classList.remove('flex-1');</td></tr><tr><td class=3D"line-number" =
value=3D"818"></td><td class=3D"line-content">                parent.classL=
ist.add('flex-none', 'h-10');</td></tr><tr><td class=3D"line-number" value=
=3D"819"></td><td class=3D"line-content">                console.classList.=
add('hidden');</td></tr><tr><td class=3D"line-number" value=3D"820"></td><t=
d class=3D"line-content">                btn.innerText =3D 'EXPAND';</td></=
tr><tr><td class=3D"line-number" value=3D"821"></td><td class=3D"line-conte=
nt">            }</td></tr><tr><td class=3D"line-number" value=3D"822"></td=
><td class=3D"line-content">        }</td></tr><tr><td class=3D"line-number=
" value=3D"823"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"824"></td><td class=3D"line-content">        // O=
verwrite legacy Alert logic with DaisyUI Toasts (if we had them implemented=
 fully, for now just custom log)</td></tr><tr><td class=3D"line-number" val=
ue=3D"825"></td><td class=3D"line-content">        // window.alert =3D func=
tion(msg) { log(`ALERT: ${msg}`, 'warning'); }</td></tr><tr><td class=3D"li=
ne-number" value=3D"826"></td><td class=3D"line-content">    <span class=3D=
"html-tag">&lt;/script&gt;</span></td></tr><tr><td class=3D"line-number" va=
lue=3D"827"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"=
line-number" value=3D"828"></td><td class=3D"line-content">    <span class=
=3D"html-comment">&lt;!-- CORE LOGIC TRANSPLANT --&gt;</span></td></tr><tr>=
<td class=3D"line-number" value=3D"829"></td><td class=3D"line-content">   =
 <span class=3D"html-tag">&lt;script&gt;</span></td></tr><tr><td class=3D"l=
ine-number" value=3D"830"></td><td class=3D"line-content">        // --- GL=
OBAL STATE ---</td></tr><tr><td class=3D"line-number" value=3D"831"></td><t=
d class=3D"line-content">        let googleUser =3D null;</td></tr><tr><td =
class=3D"line-number" value=3D"832"></td><td class=3D"line-content">       =
 let accumulatedData =3D {</td></tr><tr><td class=3D"line-number" value=3D"=
833"></td><td class=3D"line-content">            metadata: {},</td></tr><tr=
><td class=3D"line-number" value=3D"834"></td><td class=3D"line-content">  =
          slides: [],</td></tr><tr><td class=3D"line-number" value=3D"835">=
</td><td class=3D"line-content">            intelligenceGlossary: {},</td><=
/tr><tr><td class=3D"line-number" value=3D"836"></td><td class=3D"line-cont=
ent">            aiPromptsExtracted: false</td></tr><tr><td class=3D"line-n=
umber" value=3D"837"></td><td class=3D"line-content">        };</td></tr><t=
r><td class=3D"line-number" value=3D"838"></td><td class=3D"line-content"> =
       let currentMissions =3D [];</td></tr><tr><td class=3D"line-number" v=
alue=3D"839"></td><td class=3D"line-content">        let allProgress =3D []=
;</td></tr><tr><td class=3D"line-number" value=3D"840"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"841"></td>=
<td class=3D"line-content">        // --- Builder PIPELINE CONFIG ---</td><=
/tr><tr><td class=3D"line-number" value=3D"842"></td><td class=3D"line-cont=
ent">        const Builder_PHASES =3D {</td></tr><tr><td class=3D"line-numb=
er" value=3D"843"></td><td class=3D"line-content">            'brainstorm':=
 { id: 'brainstorm', title: "MISSION BRAINSTORM", label: "INTEL", desc: "De=
fine core learning objectives and scenario parameters.", prompt: "Analyze t=
he requested curriculum parameters. Suggest 3 distinct, high-stakes mission=
 scenarios that fit the topic. Focus on 'Situation Room' style dilemmas." }=
,</td></tr><tr><td class=3D"line-number" value=3D"844"></td><td class=3D"li=
ne-content">            'research': { id: 'research', title: "DEEP SEARCH I=
NTEL", label: "RESEARCH", desc: "Gather real-world context and source mater=
ial.", prompt: "Identify key historical or geopolitical events relevant to =
the chosen scenario. Suggest search queries." },</td></tr><tr><td class=3D"=
line-number" value=3D"845"></td><td class=3D"line-content">            'nar=
rative': { id: 'narrative', title: "NARRATIVE ARCHITECTURE", label: "BRIEF"=
, desc: "Structuring the mission beat-sheet.", prompt: "Develop the chosen =
scenario into a 10-slide beat sheet. SLIDE 1: Briefing, SLIDES 2-9: Inciden=
ts/Intel, SLIDE 10: Final Decision." },</td></tr><tr><td class=3D"line-numb=
er" value=3D"846"></td><td class=3D"line-content">            'scripting': =
{ id: 'scripting', title: "MISSION SCRIPTING", label: "TEXT", desc: "Drafti=
ng the full slide content.", prompt: "Write the detailed content for each o=
f the 10 slides. Include the 'Situation Report' text, the 'Intel Data' to b=
e displayed, and the specific 'Action Options' for the students." },</td></=
tr><tr><td class=3D"line-number" value=3D"847"></td><td class=3D"line-conte=
nt">            'assets': { id: 'assets', title: "VISUAL ASSETS", label: "V=
ISUALS", desc: "Generating field imagery and evidence.", prompt: "Suggest i=
mage prompts for each slide. Focus on 'satellite view', 'CCTV footage', 'cl=
assified documents', and 'tactical maps'." },</td></tr><tr><td class=3D"lin=
e-number" value=3D"848"></td><td class=3D"line-content">            'deploy=
': { id: 'deploy', title: "FINAL ASSEMBLY", label: "DEPLOY", desc: "Compile=
 and publish mission dossier.", prompt: "Finalize the JSON structure." }</t=
d></tr><tr><td class=3D"line-number" value=3D"849"></td><td class=3D"line-c=
ontent">        };</td></tr><tr><td class=3D"line-number" value=3D"850"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"851"></td><td class=3D"line-content">        const Builder_SYSTEM_CO=
RE =3D `YOU ARE 'MOTHER', A SUPPORTIVE CURRICULUM DESIGN PARTNER.</td></tr>=
<tr><td class=3D"line-number" value=3D"852"></td><td class=3D"line-content"=
>Your goal is to help teachers build engaging, thought-provoking educationa=
l simulations ("Missions") for students.</td></tr><tr><td class=3D"line-num=
ber" value=3D"853"></td><td class=3D"line-content">Tone: Warm, helpful, enc=
ouraging - like a knowledgeable colleague.</td></tr><tr><td class=3D"line-n=
umber" value=3D"854"></td><td class=3D"line-content">Address the user as "T=
eacher" or by their role. Celebrate their ideas and offer constructive sugg=
estions.</td></tr><tr><td class=3D"line-number" value=3D"855"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"856=
"></td><td class=3D"line-content">SAFETY &amp; ETHICS PROTOCOLS (STRICT ENF=
ORCEMENT):</td></tr><tr><td class=3D"line-number" value=3D"857"></td><td cl=
ass=3D"line-content">1. REFUSAL RULES: Do NOT generate scenarios involving:=
 Sexual violence, Holocaust realization, "Slavery" as a game mechanic, Cana=
dian Residential Schools, or any scenario where students play as oppressors=
 or victims of trauma.</td></tr><tr><td class=3D"line-number" value=3D"858"=
></td><td class=3D"line-content">2. ROLE RULES: Students MUST NOT play as N=
azis, Soviet Leaders, Terrorists, or advocates for crimes against humanity.=
 They must operate as ethical decision-makers (Commanders, Scientists, Dipl=
omats).</td></tr><tr><td class=3D"line-number" value=3D"859"></td><td class=
=3D"line-content">3. CONTENT: Ensure all scenarios are age-appropriate and =
focused on critical thinking, not shock value.</td></tr><tr><td class=3D"li=
ne-number" value=3D"860"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"861"></td><td class=3D"line-content">Out=
put: Clear, well-structured, practical.</td></tr><tr><td class=3D"line-numb=
er" value=3D"862"></td><td class=3D"line-content">Format: Use Markdown. Use=
 **bold** for key terms and concepts.`;</td></tr><tr><td class=3D"line-numb=
er" value=3D"863"></td><td class=3D"line-content"><br></td></tr><tr><td cla=
ss=3D"line-number" value=3D"864"></td><td class=3D"line-content">        le=
t BuilderPipeline =3D ['brainstorm', 'research', 'narrative', 'scripting', =
'assets', 'deploy'];</td></tr><tr><td class=3D"line-number" value=3D"865"><=
/td><td class=3D"line-content">        let currentPhaseIndex =3D 0;</td></t=
r><tr><td class=3D"line-number" value=3D"866"></td><td class=3D"line-conten=
t">        let BuilderHistory =3D [];</td></tr><tr><td class=3D"line-number=
" value=3D"867"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"868"></td><td class=3D"line-content">        // -=
-- PROXY CONFIG ---</td></tr><tr><td class=3D"line-number" value=3D"869"></=
td><td class=3D"line-content">        // Placeholder for direct AI calls. R=
eal implementation would likely use `callGoogleImageAPI` or similar structu=
re from original file.</td></tr><tr><td class=3D"line-number" value=3D"870"=
></td><td class=3D"line-content">        // For V3 v1.0, we will assume the=
 environment provides a 'callAI' or similar, or we replicate the fetch logi=
c.</td></tr><tr><td class=3D"line-number" value=3D"871"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"872"></td=
><td class=3D"line-content">        function getCurrentPhase() {</td></tr><=
tr><td class=3D"line-number" value=3D"873"></td><td class=3D"line-content">=
            const phaseId =3D BuilderPipeline[currentPhaseIndex];</td></tr>=
<tr><td class=3D"line-number" value=3D"874"></td><td class=3D"line-content"=
>            return Builder_PHASES[phaseId];</td></tr><tr><td class=3D"line=
-number" value=3D"875"></td><td class=3D"line-content">        }</td></tr><=
tr><td class=3D"line-number" value=3D"876"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"877"></td><td class=3D=
"line-content">        // --- Builder RENDER LOGIC (DAISYUI V3) ---</td></t=
r><tr><td class=3D"line-number" value=3D"878"></td><td class=3D"line-conten=
t">        function renderPipelineStepper() {</td></tr><tr><td class=3D"lin=
e-number" value=3D"879"></td><td class=3D"line-content">            const c=
ontainer =3D document.getElementById('pipeline-stepper');</td></tr><tr><td =
class=3D"line-number" value=3D"880"></td><td class=3D"line-content">       =
     if (!container) return;</td></tr><tr><td class=3D"line-number" value=
=3D"881"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"lin=
e-number" value=3D"882"></td><td class=3D"line-content">            let htm=
l =3D '';</td></tr><tr><td class=3D"line-number" value=3D"883"></td><td cla=
ss=3D"line-content">            BuilderPipeline.forEach((phaseId, index) =
=3D&gt; {</td></tr><tr><td class=3D"line-number" value=3D"884"></td><td cla=
ss=3D"line-content">                const phase =3D Builder_PHASES[phaseId]=
;</td></tr><tr><td class=3D"line-number" value=3D"885"></td><td class=3D"li=
ne-content">                // Status Logic: 'step-primary' for completed/c=
urrent</td></tr><tr><td class=3D"line-number" value=3D"886"></td><td class=
=3D"line-content">                let statusClass =3D (index &lt;=3D curren=
tPhaseIndex) ? 'step-primary' : '';</td></tr><tr><td class=3D"line-number" =
value=3D"887"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"888"></td><td class=3D"line-content">            =
    let badgeHtml =3D '';</td></tr><tr><td class=3D"line-number" value=3D"8=
89"></td><td class=3D"line-content">                if (phaseId =3D=3D=3D '=
narrative' &amp;&amp; accumulatedData?.slides?.length &gt; 0) {</td></tr><t=
r><td class=3D"line-number" value=3D"890"></td><td class=3D"line-content"> =
                   badgeHtml =3D ` &lt;div class=3D"badge badge-accent badg=
e-xs border-none font-bold"&gt;${accumulatedData.slides.length}&lt;/div&gt;=
`;</td></tr><tr><td class=3D"line-number" value=3D"891"></td><td class=3D"l=
ine-content">                }</td></tr><tr><td class=3D"line-number" value=
=3D"892"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"lin=
e-number" value=3D"893"></td><td class=3D"line-content">                // =
DaisyUI Step Item - Clickable for jumpToPhase</td></tr><tr><td class=3D"lin=
e-number" value=3D"894"></td><td class=3D"line-content">                htm=
l +=3D `&lt;li class=3D"step ${statusClass} text-[0.6rem] font-bold trackin=
g-wider cursor-pointer hover:text-primary transition-colors" data-content=
=3D"${index + 1}" onclick=3D"jumpToPhase(${index})"&gt;${phase.label}${badg=
eHtml}&lt;/li&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"895"></=
td><td class=3D"line-content">            });</td></tr><tr><td class=3D"lin=
e-number" value=3D"896"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"897"></td><td class=3D"line-content">    =
        container.innerHTML =3D html;</td></tr><tr><td class=3D"line-number=
" value=3D"898"></td><td class=3D"line-content">        }</td></tr><tr><td =
class=3D"line-number" value=3D"899"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"900"></td><td class=3D"line-c=
ontent">        function updateBuilderUI() {</td></tr><tr><td class=3D"line=
-number" value=3D"901"></td><td class=3D"line-content">            const ph=
ase =3D getCurrentPhase();</td></tr><tr><td class=3D"line-number" value=3D"=
902"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-nu=
mber" value=3D"903"></td><td class=3D"line-content">            // 1. Updat=
e Header Info</td></tr><tr><td class=3D"line-number" value=3D"904"></td><td=
 class=3D"line-content">            const titleEl =3D document.getElementBy=
Id('Builder-title');</td></tr><tr><td class=3D"line-number" value=3D"905"><=
/td><td class=3D"line-content">            const descEl =3D document.getEle=
mentById('Builder-desc');</td></tr><tr><td class=3D"line-number" value=3D"9=
06"></td><td class=3D"line-content">            const submitBtn =3D documen=
t.getElementById('f-submit');</td></tr><tr><td class=3D"line-number" value=
=3D"907"></td><td class=3D"line-content">            const inputEl =3D docu=
ment.getElementById('f-input');</td></tr><tr><td class=3D"line-number" valu=
e=3D"908"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"909"></td><td class=3D"line-content">            if (ti=
tleEl) {</td></tr><tr><td class=3D"line-number" value=3D"910"></td><td clas=
s=3D"line-content">                titleEl.innerText =3D phase.title;</td><=
/tr><tr><td class=3D"line-number" value=3D"911"></td><td class=3D"line-cont=
ent">                if (phase.id =3D=3D=3D 'brainstorm') {</td></tr><tr><t=
d class=3D"line-number" value=3D"912"></td><td class=3D"line-content">     =
               titleEl.classList.remove('text-xl', 'md:text-2xl', 'lg:text-=
3xl');</td></tr><tr><td class=3D"line-number" value=3D"913"></td><td class=
=3D"line-content">                    titleEl.classList.add('text-lg', 'md:=
text-xl', 'lg:text-2xl');</td></tr><tr><td class=3D"line-number" value=3D"9=
14"></td><td class=3D"line-content">                } else {</td></tr><tr><=
td class=3D"line-number" value=3D"915"></td><td class=3D"line-content">    =
                titleEl.classList.remove('text-lg', 'md:text-xl', 'lg:text-=
2xl');</td></tr><tr><td class=3D"line-number" value=3D"916"></td><td class=
=3D"line-content">                    titleEl.classList.add('text-xl', 'md:=
text-2xl', 'lg:text-3xl');</td></tr><tr><td class=3D"line-number" value=3D"=
917"></td><td class=3D"line-content">                }</td></tr><tr><td cla=
ss=3D"line-number" value=3D"918"></td><td class=3D"line-content">          =
  }</td></tr><tr><td class=3D"line-number" value=3D"919"></td><td class=3D"=
line-content">            if (descEl) descEl.innerText =3D phase.desc;</td>=
</tr><tr><td class=3D"line-number" value=3D"920"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"921"></td><td cl=
ass=3D"line-content">            // Special Handling for Deep Search &amp; =
Assets</td></tr><tr><td class=3D"line-number" value=3D"922"></td><td class=
=3D"line-content">            const outputArea =3D document.getElementById(=
'Builder-output');</td></tr><tr><td class=3D"line-number" value=3D"923"></t=
d><td class=3D"line-content">            if (phase.id =3D=3D=3D 'research' =
|| phase.id =3D=3D=3D 'deepsearch') {</td></tr><tr><td class=3D"line-number=
" value=3D"924"></td><td class=3D"line-content">                renderDeepS=
earch(outputArea);</td></tr><tr><td class=3D"line-number" value=3D"925"></t=
d><td class=3D"line-content">            } else if (phase.id =3D=3D=3D 'ass=
ets') {</td></tr><tr><td class=3D"line-number" value=3D"926"></td><td class=
=3D"line-content">                renderAssetsScreen(outputArea);</td></tr>=
<tr><td class=3D"line-number" value=3D"927"></td><td class=3D"line-content"=
>            } else if (phase.id =3D=3D=3D 'deploy') {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"928"></td><td class=3D"line-content">          =
      renderBirthScreen(outputArea);</td></tr><tr><td class=3D"line-number"=
 value=3D"929"></td><td class=3D"line-content">            } else {</td></t=
r><tr><td class=3D"line-number" value=3D"930"></td><td class=3D"line-conten=
t">                // Restore Chat View if not already there</td></tr><tr><=
td class=3D"line-number" value=3D"931"></td><td class=3D"line-content">    =
            if (!document.getElementById('Builder-chat')) {</td></tr><tr><t=
d class=3D"line-number" value=3D"932"></td><td class=3D"line-content">     =
               outputArea.innerHTML =3D `&lt;div id=3D"Builder-chat" class=
=3D"flex-1 p-6 overflow-y-auto space-y-4"&gt;&lt;/div&gt;`;</td></tr><tr><t=
d class=3D"line-number" value=3D"933"></td><td class=3D"line-content">     =
               // Restore history</td></tr><tr><td class=3D"line-number" va=
lue=3D"934"></td><td class=3D"line-content">                    BuilderHist=
ory.forEach(h =3D&gt; addBuilderChat(h.role, h.content));</td></tr><tr><td =
class=3D"line-number" value=3D"935"></td><td class=3D"line-content">       =
         }</td></tr><tr><td class=3D"line-number" value=3D"936"></td><td cl=
ass=3D"line-content">            }</td></tr><tr><td class=3D"line-number" v=
alue=3D"937"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D=
"line-number" value=3D"938"></td><td class=3D"line-content">            // =
2. Button State</td></tr><tr><td class=3D"line-number" value=3D"939"></td><=
td class=3D"line-content">            if (submitBtn) {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"940"></td><td class=3D"line-content">          =
      if (phase.id =3D=3D=3D 'deploy') {</td></tr><tr><td class=3D"line-num=
ber" value=3D"941"></td><td class=3D"line-content">                    subm=
itBtn.innerText =3D "DEPLOY MISSION";</td></tr><tr><td class=3D"line-number=
" value=3D"942"></td><td class=3D"line-content">                    submitB=
tn.classList.add('btn-warning');</td></tr><tr><td class=3D"line-number" val=
ue=3D"943"></td><td class=3D"line-content">                    submitBtn.on=
click =3D deployMission;</td></tr><tr><td class=3D"line-number" value=3D"94=
4"></td><td class=3D"line-content">                } else {</td></tr><tr><t=
d class=3D"line-number" value=3D"945"></td><td class=3D"line-content">     =
               submitBtn.innerText =3D "SUBMIT COMMAND";</td></tr><tr><td c=
lass=3D"line-number" value=3D"946"></td><td class=3D"line-content">        =
            submitBtn.classList.remove('btn-warning');</td></tr><tr><td cla=
ss=3D"line-number" value=3D"947"></td><td class=3D"line-content">          =
          submitBtn.onclick =3D processBuilder;</td></tr><tr><td class=3D"l=
ine-number" value=3D"948"></td><td class=3D"line-content">                }=
</td></tr><tr><td class=3D"line-number" value=3D"949"></td><td class=3D"lin=
e-content">            }</td></tr><tr><td class=3D"line-number" value=3D"95=
0"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"951"></td><td class=3D"line-content">            // 3. Input P=
laceholder</td></tr><tr><td class=3D"line-number" value=3D"952"></td><td cl=
ass=3D"line-content">            if (inputEl) {</td></tr><tr><td class=3D"l=
ine-number" value=3D"953"></td><td class=3D"line-content">                i=
nputEl.placeholder =3D `Enter orders for ${phase.label} phase...`;</td></tr=
><tr><td class=3D"line-number" value=3D"954"></td><td class=3D"line-content=
">            }</td></tr><tr><td class=3D"line-number" value=3D"955"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"956"></td><td class=3D"line-content">            // 4. Update Visual St=
epper</td></tr><tr><td class=3D"line-number" value=3D"957"></td><td class=
=3D"line-content">            renderPipelineStepper();</td></tr><tr><td cla=
ss=3D"line-number" value=3D"958"></td><td class=3D"line-content"><br></td><=
/tr><tr><td class=3D"line-number" value=3D"959"></td><td class=3D"line-cont=
ent">            // 5. Scroll Chat</td></tr><tr><td class=3D"line-number" v=
alue=3D"960"></td><td class=3D"line-content">            const chat =3D doc=
ument.getElementById('Builder-chat');</td></tr><tr><td class=3D"line-number=
" value=3D"961"></td><td class=3D"line-content">            if (chat) chat.=
scrollTop =3D chat.scrollHeight;</td></tr><tr><td class=3D"line-number" val=
ue=3D"962"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"963"></td><td class=3D"line-content">            log(`=
Builder UI Updated: Phase ${currentPhaseIndex + 1}/${BuilderPipeline.length=
} [${phase.label}]`);</td></tr><tr><td class=3D"line-number" value=3D"964">=
</td><td class=3D"line-content">        }</td></tr><tr><td class=3D"line-nu=
mber" value=3D"965"></td><td class=3D"line-content"><br></td></tr><tr><td c=
lass=3D"line-number" value=3D"966"></td><td class=3D"line-content">        =
function addBuilderChat(role, message, options =3D {}) {</td></tr><tr><td c=
lass=3D"line-number" value=3D"967"></td><td class=3D"line-content">        =
    const chat =3D document.getElementById('Builder-chat');</td></tr><tr><t=
d class=3D"line-number" value=3D"968"></td><td class=3D"line-content">     =
       if (!chat) return;</td></tr><tr><td class=3D"line-number" value=3D"9=
69"></td><td class=3D"line-content">            const isAI =3D role =3D=3D=
=3D 'ai' || role =3D=3D=3D 'assistant';</td></tr><tr><td class=3D"line-numb=
er" value=3D"970"></td><td class=3D"line-content">            const bubbleC=
lass =3D isAI ? 'chat-bubble-primary' : 'chat-bubble-neutral';</td></tr><tr=
><td class=3D"line-number" value=3D"971"></td><td class=3D"line-content">  =
          const alignClass =3D isAI ? 'chat-start' : 'chat-end';</td></tr><=
tr><td class=3D"line-number" value=3D"972"></td><td class=3D"line-content">=
            const avatarTxt =3D isAI ? 'AI' : 'OP';</td></tr><tr><td class=
=3D"line-number" value=3D"973"></td><td class=3D"line-content">            =
const avatarBg =3D isAI ? 'bg-primary text-primary-content' : 'bg-neutral t=
ext-neutral-content';</td></tr><tr><td class=3D"line-number" value=3D"974">=
</td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number"=
 value=3D"975"></td><td class=3D"line-content">            // Parse Markdow=
n (using marked.js if available, else text)</td></tr><tr><td class=3D"line-=
number" value=3D"976"></td><td class=3D"line-content">            const htm=
lContent =3D (typeof marked !=3D=3D 'undefined') ? marked.parse(message) : =
message;</td></tr><tr><td class=3D"line-number" value=3D"977"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"978=
"></td><td class=3D"line-content">            let nextBtnHtml =3D '';</td><=
/tr><tr><td class=3D"line-number" value=3D"979"></td><td class=3D"line-cont=
ent">            if (options.showNextPhaseButton) {</td></tr><tr><td class=
=3D"line-number" value=3D"980"></td><td class=3D"line-content">            =
    nextBtnHtml =3D `</td></tr><tr><td class=3D"line-number" value=3D"981">=
</td><td class=3D"line-content">                    &lt;div class=3D"mt-4 f=
lex justify-end"&gt;</td></tr><tr><td class=3D"line-number" value=3D"982"><=
/td><td class=3D"line-content">                        &lt;button class=3D"=
btn btn-xs btn-outline btn-success gap-1 border-white/20 hover:border-white=
/40" onclick=3D"advancePhase()"&gt;</td></tr><tr><td class=3D"line-number" =
value=3D"983"></td><td class=3D"line-content">                            A=
UTHORIZE NEXT PHASE =E2=86=92</td></tr><tr><td class=3D"line-number" value=
=3D"984"></td><td class=3D"line-content">                        &lt;/butto=
n&gt;</td></tr><tr><td class=3D"line-number" value=3D"985"></td><td class=
=3D"line-content">                    &lt;/div&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"986"></td><td class=3D"line-content">            =
    `;</td></tr><tr><td class=3D"line-number" value=3D"987"></td><td class=
=3D"line-content">            }</td></tr><tr><td class=3D"line-number" valu=
e=3D"988"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"989"></td><td class=3D"line-content">            const =
html =3D `</td></tr><tr><td class=3D"line-number" value=3D"990"></td><td cl=
ass=3D"line-content">            &lt;div class=3D"chat ${alignClass} animat=
e-fade-in"&gt;</td></tr><tr><td class=3D"line-number" value=3D"991"></td><t=
d class=3D"line-content">                &lt;div class=3D"chat-image avatar=
 placeholder"&gt;</td></tr><tr><td class=3D"line-number" value=3D"992"></td=
><td class=3D"line-content">                    &lt;div class=3D"w-8 rounde=
d-full ${avatarBg}"&gt;</td></tr><tr><td class=3D"line-number" value=3D"993=
"></td><td class=3D"line-content">                        &lt;span class=3D=
"text-xs"&gt;${avatarTxt}&lt;/span&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"994"></td><td class=3D"line-content">                    &lt;/d=
iv&gt;</td></tr><tr><td class=3D"line-number" value=3D"995"></td><td class=
=3D"line-content">                &lt;/div&gt;</td></tr><tr><td class=3D"li=
ne-number" value=3D"996"></td><td class=3D"line-content">                &l=
t;div class=3D"chat-bubble ${bubbleClass} text-sm font-mono leading-relaxed=
 shadow-md"&gt;</td></tr><tr><td class=3D"line-number" value=3D"997"></td><=
td class=3D"line-content">                    ${htmlContent}</td></tr><tr><=
td class=3D"line-number" value=3D"998"></td><td class=3D"line-content">    =
                ${nextBtnHtml}</td></tr><tr><td class=3D"line-number" value=
=3D"999"></td><td class=3D"line-content">                &lt;/div&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"1000"></td><td class=3D"line-con=
tent">                &lt;div class=3D"chat-footer opacity-50 text-[0.6rem]=
 mt-1"&gt;</td></tr><tr><td class=3D"line-number" value=3D"1001"></td><td c=
lass=3D"line-content">                    ${new Date().toLocaleTimeString()=
}</td></tr><tr><td class=3D"line-number" value=3D"1002"></td><td class=3D"l=
ine-content">                &lt;/div&gt;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1003"></td><td class=3D"line-content">            &lt;/div&g=
t;`;</td></tr><tr><td class=3D"line-number" value=3D"1004"></td><td class=
=3D"line-content">            chat.insertAdjacentHTML('beforeend', html);</=
td></tr><tr><td class=3D"line-number" value=3D"1005"></td><td class=3D"line=
-content">            chat.scrollTop =3D chat.scrollHeight;</td></tr><tr><t=
d class=3D"line-number" value=3D"1006"></td><td class=3D"line-content">    =
    }</td></tr><tr><td class=3D"line-number" value=3D"1007"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1008=
"></td><td class=3D"line-content">        // --- DEEP SEARCH LOGIC (Restore=
d) ---</td></tr><tr><td class=3D"line-number" value=3D"1009"></td><td class=
=3D"line-content">        function renderDeepSearch(container) {</td></tr><=
tr><td class=3D"line-number" value=3D"1010"></td><td class=3D"line-content"=
>            container.innerHTML =3D `</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1011"></td><td class=3D"line-content">                &lt;div c=
lass=3D"h-full flex flex-col p-6 bg-base-100 gap-6 overflow-y-auto"&gt;</td=
></tr><tr><td class=3D"line-number" value=3D"1012"></td><td class=3D"line-c=
ontent">                    &lt;div class=3D"grid grid-cols-1 lg:grid-cols-=
2 gap-6 flex-1"&gt;</td></tr><tr><td class=3D"line-number" value=3D"1013"><=
/td><td class=3D"line-content">                        &lt;!-- Setup Panel =
--&gt;</td></tr><tr><td class=3D"line-number" value=3D"1014"></td><td class=
=3D"line-content">                        &lt;div class=3D"card bg-base-200=
 shadow-md border border-base-content/10 flex flex-col"&gt;</td></tr><tr><t=
d class=3D"line-number" value=3D"1015"></td><td class=3D"line-content">    =
                        &lt;div class=3D"card-body p-4 flex flex-col gap-4"=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"1016"></td><td class=
=3D"line-content">                                &lt;h3 class=3D"card-titl=
e text-xs font-bold text-secondary tracking-widest uppercase"&gt;Research T=
arget&lt;/h3&gt;</td></tr><tr><td class=3D"line-number" value=3D"1017"></td=
><td class=3D"line-content">                                &lt;p class=3D"=
text-[10px] opacity-60"&gt;AI will generate a tailored prompt for Gemini De=
ep Research based on your brainstorm history.&lt;/p&gt;</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1018"></td><td class=3D"line-content">        =
                        &lt;div id=3D"deepsearch-prompt" contenteditable=3D=
"true" class=3D"flex-1 bg-black/40 border border-white/5 p-4 rounded font-m=
ono text-xs text-secondary-focus overflow-y-auto min-h-[200px] leading-rela=
xed outline-none"&gt;</td></tr><tr><td class=3D"line-number" value=3D"1019"=
></td><td class=3D"line-content">                                    ${getB=
uilderContextForResearch()}</td></tr><tr><td class=3D"line-number" value=3D=
"1020"></td><td class=3D"line-content">                                &lt;=
/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"1021"></td><td cla=
ss=3D"line-content">                                &lt;div class=3D"flex g=
ap-2"&gt;</td></tr><tr><td class=3D"line-number" value=3D"1022"></td><td cl=
ass=3D"line-content">                                    &lt;button class=
=3D"btn btn-sm btn-secondary flex-1 font-bold" onclick=3D"tailorDeepSearchP=
rompt()"&gt;TAILOR WITH AI&lt;/button&gt;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1023"></td><td class=3D"line-content">                      =
              &lt;button class=3D"btn btn-sm btn-primary flex-1 font-bold" =
onclick=3D"copyDeepSearchPrompt()"&gt;COPY PROMPT&lt;/button&gt;</td></tr><=
tr><td class=3D"line-number" value=3D"1024"></td><td class=3D"line-content"=
>                                &lt;/div&gt;</td></tr><tr><td class=3D"lin=
e-number" value=3D"1025"></td><td class=3D"line-content">                  =
          &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"1026=
"></td><td class=3D"line-content">                        &lt;/div&gt;</td>=
</tr><tr><td class=3D"line-number" value=3D"1027"></td><td class=3D"line-co=
ntent"><br></td></tr><tr><td class=3D"line-number" value=3D"1028"></td><td =
class=3D"line-content">                        &lt;!-- Harvest Panel --&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"1029"></td><td class=3D"li=
ne-content">                        &lt;div class=3D"card bg-base-200 shado=
w-md border border-base-content/10 flex flex-col"&gt;</td></tr><tr><td clas=
s=3D"line-number" value=3D"1030"></td><td class=3D"line-content">          =
                  &lt;div class=3D"card-body p-4 flex flex-col gap-4"&gt;</=
td></tr><tr><td class=3D"line-number" value=3D"1031"></td><td class=3D"line=
-content">                                &lt;h3 class=3D"card-title text-x=
s font-bold text-success tracking-widest uppercase"&gt;Research Harvest&lt;=
/h3&gt;</td></tr><tr><td class=3D"line-number" value=3D"1032"></td><td clas=
s=3D"line-content">                                &lt;p class=3D"text-[10p=
x] opacity-60"&gt;Paste findings from your external research (Gemini, Perpl=
exity) here. This anchors your story in reality.&lt;/p&gt;</td></tr><tr><td=
 class=3D"line-number" value=3D"1033"></td><td class=3D"line-content">     =
                           &lt;textarea id=3D"deepsearch-results" class=3D"=
textarea textarea-bordered flex-1 bg-black/40 font-mono text-xs leading-rel=
axed" placeholder=3D"Verifiable facts, stakeholders, dates, primary sources=
..."&gt;${accumulatedData.deepSearchResults || ''}&lt;/textarea&gt;</td></t=
r><tr><td class=3D"line-number" value=3D"1034"></td><td class=3D"line-conte=
nt">                                &lt;button class=3D"btn btn-sm btn-succ=
ess btn-outline w-full font-bold" onclick=3D"saveDeepSearchResults()"&gt;AN=
CHOR TO NARRATIVE&lt;/button&gt;</td></tr><tr><td class=3D"line-number" val=
ue=3D"1035"></td><td class=3D"line-content">                            &lt=
;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"1036"></td><td cl=
ass=3D"line-content">                        &lt;/div&gt;</td></tr><tr><td =
class=3D"line-number" value=3D"1037"></td><td class=3D"line-content">      =
              &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"=
1038"></td><td class=3D"line-content">                &lt;/div&gt;`;</td></=
tr><tr><td class=3D"line-number" value=3D"1039"></td><td class=3D"line-cont=
ent">        }</td></tr><tr><td class=3D"line-number" value=3D"1040"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1041"></td><td class=3D"line-content">        function getBuilderContex=
tForResearch() {</td></tr><tr><td class=3D"line-number" value=3D"1042"></td=
><td class=3D"line-content">            const country =3D document.getEleme=
ntById('f-country')?.value || 'Unknown';</td></tr><tr><td class=3D"line-num=
ber" value=3D"1043"></td><td class=3D"line-content">            const regio=
n =3D document.getElementById('f-region')?.value || '';</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1044"></td><td class=3D"line-content">        =
    const course =3D document.getElementById('f-course')?.value || '';</td>=
</tr><tr><td class=3D"line-number" value=3D"1045"></td><td class=3D"line-co=
ntent">            const title =3D accumulatedData.metadata?.title || 'Educ=
ational Simulation';</td></tr><tr><td class=3D"line-number" value=3D"1046">=
</td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number"=
 value=3D"1047"></td><td class=3D"line-content">            // Extract hist=
ory</td></tr><tr><td class=3D"line-number" value=3D"1048"></td><td class=3D=
"line-content">            const context =3D BuilderHistory.filter(m =3D&gt=
; m.role =3D=3D=3D 'assistant').slice(-2).map(m =3D&gt; m.content).join('\n=
\n');</td></tr><tr><td class=3D"line-number" value=3D"1049"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1050=
"></td><td class=3D"line-content">            return `RESEARCH MISSION: "${=
title}"\nLOCALE: ${country} ${region}\nCOURSE: ${course}\n\nSCENARIO CONTEX=
T:\n${context || 'Awaiting further scenario development...'}\n\nPlease cond=
uct deep research to provide factual foundations for this mission. I need v=
erified facts, dates, stakeholder perspectives, and primary sources.`;</td>=
</tr><tr><td class=3D"line-number" value=3D"1051"></td><td class=3D"line-co=
ntent">        }</td></tr><tr><td class=3D"line-number" value=3D"1052"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"1053"></td><td class=3D"line-content">        async function tailorDe=
epSearchPrompt() {</td></tr><tr><td class=3D"line-number" value=3D"1054"></=
td><td class=3D"line-content">            const promptEl =3D document.getEl=
ementById('deepsearch-prompt');</td></tr><tr><td class=3D"line-number" valu=
e=3D"1055"></td><td class=3D"line-content">            if (!promptEl) retur=
n;</td></tr><tr><td class=3D"line-number" value=3D"1056"></td><td class=3D"=
line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1057"></=
td><td class=3D"line-content">            log('Optimizing research paramete=
rs...', 'info');</td></tr><tr><td class=3D"line-number" value=3D"1058"></td=
><td class=3D"line-content">            const currentPrompt =3D promptEl.in=
nerText;</td></tr><tr><td class=3D"line-number" value=3D"1059"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"10=
60"></td><td class=3D"line-content">            const systemInstruction =3D=
 `You are a Research Architect. Rewrite this research prompt into a hyper-s=
pecific set of instructions for a Deep Research AI. </td></tr><tr><td class=
=3D"line-number" value=3D"1061"></td><td class=3D"line-content">           =
 Mandate regional specificity, verified facts, primary documents, and stake=
holder perspectives. Output ONLY the raw prompt.`;</td></tr><tr><td class=
=3D"line-number" value=3D"1062"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"1063"></td><td class=3D"line-cont=
ent">            try {</td></tr><tr><td class=3D"line-number" value=3D"1064=
"></td><td class=3D"line-content">                const responseText =3D aw=
ait callAI(`SYSTEM: ${systemInstruction}\n\nCONTEXT:\n${currentPrompt}`);</=
td></tr><tr><td class=3D"line-number" value=3D"1065"></td><td class=3D"line=
-content">                promptEl.innerText =3D responseText.trim();</td><=
/tr><tr><td class=3D"line-number" value=3D"1066"></td><td class=3D"line-con=
tent">                log('Research parameters optimized!', 'success');</td=
></tr><tr><td class=3D"line-number" value=3D"1067"></td><td class=3D"line-c=
ontent">            } catch (e) {</td></tr><tr><td class=3D"line-number" va=
lue=3D"1068"></td><td class=3D"line-content">                log('Optimizat=
ion Failed: ' + e.message, 'error');</td></tr><tr><td class=3D"line-number"=
 value=3D"1069"></td><td class=3D"line-content">            }</td></tr><tr>=
<td class=3D"line-number" value=3D"1070"></td><td class=3D"line-content">  =
      }</td></tr><tr><td class=3D"line-number" value=3D"1071"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"107=
2"></td><td class=3D"line-content">        function copyDeepSearchPrompt() =
{</td></tr><tr><td class=3D"line-number" value=3D"1073"></td><td class=3D"l=
ine-content">            const text =3D document.getElementById('deepsearch=
-prompt')?.innerText;</td></tr><tr><td class=3D"line-number" value=3D"1074"=
></td><td class=3D"line-content">            if (!text) return;</td></tr><t=
r><td class=3D"line-number" value=3D"1075"></td><td class=3D"line-content">=
            navigator.clipboard.writeText(text).then(() =3D&gt; {</td></tr>=
<tr><td class=3D"line-number" value=3D"1076"></td><td class=3D"line-content=
">                log('Research Prompt Copied to Clipboard', 'success');</t=
d></tr><tr><td class=3D"line-number" value=3D"1077"></td><td class=3D"line-=
content">                alert('Copied! Paste this into Gemini Deep Researc=
h or Perplexity.');</td></tr><tr><td class=3D"line-number" value=3D"1078"><=
/td><td class=3D"line-content">            });</td></tr><tr><td class=3D"li=
ne-number" value=3D"1079"></td><td class=3D"line-content">        }</td></t=
r><tr><td class=3D"line-number" value=3D"1080"></td><td class=3D"line-conte=
nt"><br></td></tr><tr><td class=3D"line-number" value=3D"1081"></td><td cla=
ss=3D"line-content">        function saveDeepSearchResults() {</td></tr><tr=
><td class=3D"line-number" value=3D"1082"></td><td class=3D"line-content"> =
           const results =3D document.getElementById('deepsearch-results')?=
.value.trim();</td></tr><tr><td class=3D"line-number" value=3D"1083"></td><=
td class=3D"line-content">            if (!results) {</td></tr><tr><td clas=
s=3D"line-number" value=3D"1084"></td><td class=3D"line-content">          =
      if (!confirm("No research harvested. Anchor proceeding with simulated=
 data only. Proceed?")) return;</td></tr><tr><td class=3D"line-number" valu=
e=3D"1085"></td><td class=3D"line-content">            }</td></tr><tr><td c=
lass=3D"line-number" value=3D"1086"></td><td class=3D"line-content">       =
     accumulatedData.deepSearchResults =3D results;</td></tr><tr><td class=
=3D"line-number" value=3D"1087"></td><td class=3D"line-content">           =
 log('Mission anchored to research harvest.', 'success');</td></tr><tr><td =
class=3D"line-number" value=3D"1088"></td><td class=3D"line-content">      =
      addBuilderChat('ai', '=E2=9C=85 **Research Anchored.** I will now use=
 these verified sources to construct the operational narrative.');</td></tr=
><tr><td class=3D"line-number" value=3D"1089"></td><td class=3D"line-conten=
t">        }</td></tr><tr><td class=3D"line-number" value=3D"1090"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1091"></td><td class=3D"line-content">        async function executeDee=
pSearch() {</td></tr><tr><td class=3D"line-number" value=3D"1092"></td><td =
class=3D"line-content">            // Deprecated in favor of Tailor/Harvest=
 workflow</td></tr><tr><td class=3D"line-number" value=3D"1093"></td><td cl=
ass=3D"line-content">            log('Deep Search direct scan shifted to ma=
nual Harvest.', 'info');</td></tr><tr><td class=3D"line-number" value=3D"10=
94"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"lin=
e-number" value=3D"1095"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"1096"></td><td class=3D"line-content">  =
      function setBuilderLoading(show, txt =3D "PROCESSING...") {</td></tr>=
<tr><td class=3D"line-number" value=3D"1097"></td><td class=3D"line-content=
">            const loader =3D document.getElementById('Builder-loader');</=
td></tr><tr><td class=3D"line-number" value=3D"1098"></td><td class=3D"line=
-content">            if (loader) {</td></tr><tr><td class=3D"line-number" =
value=3D"1099"></td><td class=3D"line-content">                loader.style=
.display =3D show ? 'flex' : 'none';</td></tr><tr><td class=3D"line-number"=
 value=3D"1100"></td><td class=3D"line-content">                const textE=
l =3D document.getElementById('Builder-loader-text');</td></tr><tr><td clas=
s=3D"line-number" value=3D"1101"></td><td class=3D"line-content">          =
      if (textEl) textEl.innerText =3D txt;</td></tr><tr><td class=3D"line-=
number" value=3D"1102"></td><td class=3D"line-content">            }</td></=
tr><tr><td class=3D"line-number" value=3D"1103"></td><td class=3D"line-cont=
ent">            // Also toggle the submit button state</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1104"></td><td class=3D"line-content">        =
    const submitBtn =3D document.getElementById('f-submit');</td></tr><tr><=
td class=3D"line-number" value=3D"1105"></td><td class=3D"line-content">   =
         if (submitBtn) submitBtn.disabled =3D show;</td></tr><tr><td class=
=3D"line-number" value=3D"1106"></td><td class=3D"line-content">        }</=
td></tr><tr><td class=3D"line-number" value=3D"1107"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1108"></td><=
td class=3D"line-content">        function jumpToPhase(idx) {</td></tr><tr>=
<td class=3D"line-number" value=3D"1109"></td><td class=3D"line-content">  =
          if (idx &lt; 0 || idx &gt;=3D BuilderPipeline.length) return;</td=
></tr><tr><td class=3D"line-number" value=3D"1110"></td><td class=3D"line-c=
ontent">            if (idx &gt; currentPhaseIndex &amp;&amp; !confirm(`Ski=
p ahead to ${Builder_PHASES[BuilderPipeline[idx]].label}? Some phases will =
be bypassed.`)) return;</td></tr><tr><td class=3D"line-number" value=3D"111=
1"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"1112"></td><td class=3D"line-content">            currentPhase=
Index =3D idx;</td></tr><tr><td class=3D"line-number" value=3D"1113"></td><=
td class=3D"line-content">            updateBuilderUI();</td></tr><tr><td c=
lass=3D"line-number" value=3D"1114"></td><td class=3D"line-content">       =
     addBuilderChat("ai", `=E2=9A=A1 Jumped to **${getCurrentPhase().label}=
**. Context preserved.`);</td></tr><tr><td class=3D"line-number" value=3D"1=
115"></td><td class=3D"line-content">            log(`Phase override: ${get=
CurrentPhase().label}`, 'warning');</td></tr><tr><td class=3D"line-number" =
value=3D"1116"></td><td class=3D"line-content">        }</td></tr><tr><td c=
lass=3D"line-number" value=3D"1117"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"1118"></td><td class=3D"line-=
content">        async function generateImagePrompts() {</td></tr><tr><td c=
lass=3D"line-number" value=3D"1119"></td><td class=3D"line-content">       =
     const selectedModel =3D document.getElementById('f-model')?.value || '=
google/gemini-2.0-flash-exp:free';</td></tr><tr><td class=3D"line-number" v=
alue=3D"1120"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"1121"></td><td class=3D"line-content">           =
 let context =3D `You are helping generate image prompts for an educational=
 simulation.</td></tr><tr><td class=3D"line-number" value=3D"1122"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1123"></td><td class=3D"line-content">Based on the following mission co=
ntext, generate exactly 19 image prompts for an AI image generator (like Fl=
ux or DALL-E).</td></tr><tr><td class=3D"line-number" value=3D"1124"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1125"></td><td class=3D"line-content">FORMAT: Output a markdown table w=
ith these columns:</td></tr><tr><td class=3D"line-number" value=3D"1126"></=
td><td class=3D"line-content">| # | Slide | Description | AI Image Prompt |=
</td></tr><tr><td class=3D"line-number" value=3D"1127"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1128"></td=
><td class=3D"line-content">The prompts should be:</td></tr><tr><td class=
=3D"line-number" value=3D"1129"></td><td class=3D"line-content">- Photoreal=
istic or documentary style</td></tr><tr><td class=3D"line-number" value=3D"=
1130"></td><td class=3D"line-content">- Educational and appropriate for cla=
ssroom use  </td></tr><tr><td class=3D"line-number" value=3D"1131"></td><td=
 class=3D"line-content">- Specific and descriptive (30-50 words each)</td><=
/tr><tr><td class=3D"line-number" value=3D"1132"></td><td class=3D"line-con=
tent">- Historically/factually accurate where applicable</td></tr><tr><td c=
lass=3D"line-number" value=3D"1133"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"1134"></td><td class=3D"line-=
content">REQUIRED IMAGES (19 total):</td></tr><tr><td class=3D"line-number"=
 value=3D"1135"></td><td class=3D"line-content">1. Hero/Splash image (drama=
tic, sets the tone)</td></tr><tr><td class=3D"line-number" value=3D"1136"><=
/td><td class=3D"line-content">2-19. Two images per slide for 9 content sli=
des (primary view + alternate perspective)</td></tr><tr><td class=3D"line-n=
umber" value=3D"1137"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"1138"></td><td class=3D"line-content">`;</t=
d></tr><tr><td class=3D"line-number" value=3D"1139"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"1140"></td><t=
d class=3D"line-content">            if (accumulatedData?.metadata?.title) =
{</td></tr><tr><td class=3D"line-number" value=3D"1141"></td><td class=3D"l=
ine-content">                context +=3D `Mission Title: ${accumulatedData=
.metadata.title}\n`;</td></tr><tr><td class=3D"line-number" value=3D"1142">=
</td><td class=3D"line-content">            }</td></tr><tr><td class=3D"lin=
e-number" value=3D"1143"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"1144"></td><td class=3D"line-content">  =
          const narrativeContent =3D BuilderHistory</td></tr><tr><td class=
=3D"line-number" value=3D"1145"></td><td class=3D"line-content">           =
     .filter(m =3D&gt; m.role =3D=3D=3D 'assistant')</td></tr><tr><td class=
=3D"line-number" value=3D"1146"></td><td class=3D"line-content">           =
     .map(m =3D&gt; m.content)</td></tr><tr><td class=3D"line-number" value=
=3D"1147"></td><td class=3D"line-content">                .join('\n\n')</td=
></tr><tr><td class=3D"line-number" value=3D"1148"></td><td class=3D"line-c=
ontent">                .substring(0, 4000);</td></tr><tr><td class=3D"line=
-number" value=3D"1149"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"1150"></td><td class=3D"line-content">   =
         if (narrativeContent) {</td></tr><tr><td class=3D"line-number" val=
ue=3D"1151"></td><td class=3D"line-content">                context +=3D `\=
nMission Narrative:\n${narrativeContent}\n`;</td></tr><tr><td class=3D"line=
-number" value=3D"1152"></td><td class=3D"line-content">            }</td><=
/tr><tr><td class=3D"line-number" value=3D"1153"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"1154"></td><td c=
lass=3D"line-content">            if (accumulatedData?.deepSearchResults) {=
</td></tr><tr><td class=3D"line-number" value=3D"1155"></td><td class=3D"li=
ne-content">                context +=3D `\nResearch Context:\n${accumulate=
dData.deepSearchResults.substring(0, 1000)}\n`;</td></tr><tr><td class=3D"l=
ine-number" value=3D"1156"></td><td class=3D"line-content">            }</t=
d></tr><tr><td class=3D"line-number" value=3D"1157"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"1158"></td><t=
d class=3D"line-content">            context +=3D `\nNow generate the 19 im=
age prompts in the table format specified above.`;</td></tr><tr><td class=
=3D"line-number" value=3D"1159"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"1160"></td><td class=3D"line-cont=
ent">            try {</td></tr><tr><td class=3D"line-number" value=3D"1161=
"></td><td class=3D"line-content">                log('Generating 19 image =
prompts via AI...', 'info');</td></tr><tr><td class=3D"line-number" value=
=3D"1162"></td><td class=3D"line-content">                setBuilderLoading=
(true, 'GENERATING ASSETS...');</td></tr><tr><td class=3D"line-number" valu=
e=3D"1163"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"1164"></td><td class=3D"line-content">                =
const reply =3D await callAI(context);</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1165"></td><td class=3D"line-content"><br></td></tr><tr><td cla=
ss=3D"line-number" value=3D"1166"></td><td class=3D"line-content">         =
       BuilderHistory.push({ role: 'user', content: 'Generate 19 image prom=
pts for the Media phase.' });</td></tr><tr><td class=3D"line-number" value=
=3D"1167"></td><td class=3D"line-content">                BuilderHistory.pu=
sh({ role: 'assistant', content: reply });</td></tr><tr><td class=3D"line-n=
umber" value=3D"1168"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"1169"></td><td class=3D"line-content">     =
           accumulatedData.aiPromptsExtracted =3D false;</td></tr><tr><td c=
lass=3D"line-number" value=3D"1170"></td><td class=3D"line-content">       =
         extractAIPromptsFromHistory();</td></tr><tr><td class=3D"line-numb=
er" value=3D"1171"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"1172"></td><td class=3D"line-content">        =
        const outputArea =3D document.getElementById('Builder-output');</td=
></tr><tr><td class=3D"line-number" value=3D"1173"></td><td class=3D"line-c=
ontent">                if (outputArea) renderAssetsScreen(outputArea);</td=
></tr><tr><td class=3D"line-number" value=3D"1174"></td><td class=3D"line-c=
ontent"><br></td></tr><tr><td class=3D"line-number" value=3D"1175"></td><td=
 class=3D"line-content">                log('Image prompts generated succes=
sfully!', 'success');</td></tr><tr><td class=3D"line-number" value=3D"1176"=
></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number=
" value=3D"1177"></td><td class=3D"line-content">            } catch (e) {<=
/td></tr><tr><td class=3D"line-number" value=3D"1178"></td><td class=3D"lin=
e-content">                log(`Prompt generation failed: ${e.message}`, 'e=
rror');</td></tr><tr><td class=3D"line-number" value=3D"1179"></td><td clas=
s=3D"line-content">            } finally {</td></tr><tr><td class=3D"line-n=
umber" value=3D"1180"></td><td class=3D"line-content">                setBu=
ilderLoading(false);</td></tr><tr><td class=3D"line-number" value=3D"1181">=
</td><td class=3D"line-content">            }</td></tr><tr><td class=3D"lin=
e-number" value=3D"1182"></td><td class=3D"line-content">        }</td></tr=
><tr><td class=3D"line-number" value=3D"1183"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"1184"></td><td clas=
s=3D"line-content">        function downloadBirthedBlob() {</td></tr><tr><t=
d class=3D"line-number" value=3D"1185"></td><td class=3D"line-content">    =
        const title =3D accumulatedData?.metadata?.title || 'mission';</td>=
</tr><tr><td class=3D"line-number" value=3D"1186"></td><td class=3D"line-co=
ntent">            const id =3D accumulatedData?.metadata?.id || 'MISSION_'=
 + Date.now();</td></tr><tr><td class=3D"line-number" value=3D"1187"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1188"></td><td class=3D"line-content">            if (!accumulatedData.=
metadata) accumulatedData.metadata =3D {};</td></tr><tr><td class=3D"line-n=
umber" value=3D"1189"></td><td class=3D"line-content">            accumulat=
edData.metadata.id =3D id;</td></tr><tr><td class=3D"line-number" value=3D"=
1190"></td><td class=3D"line-content">            accumulatedData.metadata.=
title =3D title;</td></tr><tr><td class=3D"line-number" value=3D"1191"></td=
><td class=3D"line-content">            accumulatedData.metadata.exportedAt=
 =3D new Date().toISOString();</td></tr><tr><td class=3D"line-number" value=
=3D"1192"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"1193"></td><td class=3D"line-content">            const=
 sanitized =3D sanitizeForBirth(accumulatedData);</td></tr><tr><td class=3D=
"line-number" value=3D"1194"></td><td class=3D"line-content"><br></td></tr>=
<tr><td class=3D"line-number" value=3D"1195"></td><td class=3D"line-content=
">            const blob =3D new Blob([JSON.stringify(sanitized, null, 2)],=
 { type: 'application/json' });</td></tr><tr><td class=3D"line-number" valu=
e=3D"1196"></td><td class=3D"line-content">            const url =3D URL.cr=
eateObjectURL(blob);</td></tr><tr><td class=3D"line-number" value=3D"1197">=
</td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number"=
 value=3D"1198"></td><td class=3D"line-content">            const a =3D doc=
ument.createElement('a');</td></tr><tr><td class=3D"line-number" value=3D"1=
199"></td><td class=3D"line-content">            a.href =3D url;</td></tr><=
tr><td class=3D"line-number" value=3D"1200"></td><td class=3D"line-content"=
>            a.download =3D `${id}.blob`;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1201"></td><td class=3D"line-content">            document.b=
ody.appendChild(a);</td></tr><tr><td class=3D"line-number" value=3D"1202"><=
/td><td class=3D"line-content">            a.click();</td></tr><tr><td clas=
s=3D"line-number" value=3D"1203"></td><td class=3D"line-content">          =
  document.body.removeChild(a);</td></tr><tr><td class=3D"line-number" valu=
e=3D"1204"></td><td class=3D"line-content">            URL.revokeObjectURL(=
url);</td></tr><tr><td class=3D"line-number" value=3D"1205"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1206=
"></td><td class=3D"line-content">            log(`Downloaded ${id}.blob`, =
'success');</td></tr><tr><td class=3D"line-number" value=3D"1207"></td><td =
class=3D"line-content">            addBuilderChat('ai', `=F0=9F=92=BE **Mis=
sion Dossier Exported!** File: \`${id}.blob\``);</td></tr><tr><td class=3D"=
line-number" value=3D"1208"></td><td class=3D"line-content">        }</td><=
/tr><tr><td class=3D"line-number" value=3D"1209"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"1210"></td><td c=
lass=3D"line-content">        async function birthMission() {</td></tr><tr>=
<td class=3D"line-number" value=3D"1211"></td><td class=3D"line-content">  =
          const selectedModel =3D document.getElementById('f-model')?.value=
 || 'google/gemini-2.0-flash-exp:free';</td></tr><tr><td class=3D"line-numb=
er" value=3D"1212"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"1213"></td><td class=3D"line-content">        =
    if (!accumulatedData.metadata) accumulatedData.metadata =3D {};</td></t=
r><tr><td class=3D"line-number" value=3D"1214"></td><td class=3D"line-conte=
nt"><br></td></tr><tr><td class=3D"line-number" value=3D"1215"></td><td cla=
ss=3D"line-content">            const titleInput =3D document.getElementByI=
d('birth-mission-title')?.value?.trim();</td></tr><tr><td class=3D"line-num=
ber" value=3D"1216"></td><td class=3D"line-content">            const idInp=
ut =3D document.getElementById('birth-mission-id')?.value?.trim();</td></tr=
><tr><td class=3D"line-number" value=3D"1217"></td><td class=3D"line-conten=
t">            if (titleInput) accumulatedData.metadata.title =3D titleInpu=
t;</td></tr><tr><td class=3D"line-number" value=3D"1218"></td><td class=3D"=
line-content">            if (idInput) accumulatedData.metadata.id =3D idIn=
put;</td></tr><tr><td class=3D"line-number" value=3D"1219"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1220=
"></td><td class=3D"line-content">            if (!accumulatedData.metadata=
.title) {</td></tr><tr><td class=3D"line-number" value=3D"1221"></td><td cl=
ass=3D"line-content">                alert('Please enter a Mission Title');=
</td></tr><tr><td class=3D"line-number" value=3D"1222"></td><td class=3D"li=
ne-content">                return;</td></tr><tr><td class=3D"line-number" =
value=3D"1223"></td><td class=3D"line-content">            }</td></tr><tr><=
td class=3D"line-number" value=3D"1224"></td><td class=3D"line-content">   =
         if (!accumulatedData.metadata.id) {</td></tr><tr><td class=3D"line=
-number" value=3D"1225"></td><td class=3D"line-content">                acc=
umulatedData.metadata.id =3D 'MISSION_' + Date.now();</td></tr><tr><td clas=
s=3D"line-number" value=3D"1226"></td><td class=3D"line-content">          =
  }</td></tr><tr><td class=3D"line-number" value=3D"1227"></td><td class=3D=
"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1228"><=
/td><td class=3D"line-content">            const context =3D `You are conve=
rting conversation history into a structured educational mission JSON.</td>=
</tr><tr><td class=3D"line-number" value=3D"1229"></td><td class=3D"line-co=
ntent"><br></td></tr><tr><td class=3D"line-number" value=3D"1230"></td><td =
class=3D"line-content">Based on the following builder conversation history,=
 extract and structure the mission data into the following JSON format:</td=
></tr><tr><td class=3D"line-number" value=3D"1231"></td><td class=3D"line-c=
ontent"><br></td></tr><tr><td class=3D"line-number" value=3D"1232"></td><td=
 class=3D"line-content">{</td></tr><tr><td class=3D"line-number" value=3D"1=
233"></td><td class=3D"line-content">  "metadata": {</td></tr><tr><td class=
=3D"line-number" value=3D"1234"></td><td class=3D"line-content">    "id": "=
${accumulatedData.metadata.id}",</td></tr><tr><td class=3D"line-number" val=
ue=3D"1235"></td><td class=3D"line-content">    "title": "${accumulatedData=
.metadata.title}",</td></tr><tr><td class=3D"line-number" value=3D"1236"></=
td><td class=3D"line-content">    "version": "1.0",</td></tr><tr><td class=
=3D"line-number" value=3D"1237"></td><td class=3D"line-content">    "heroIm=
age": "${accumulatedData.metadata.heroImage || ''}"</td></tr><tr><td class=
=3D"line-number" value=3D"1238"></td><td class=3D"line-content">  },</td></=
tr><tr><td class=3D"line-number" value=3D"1239"></td><td class=3D"line-cont=
ent">  "slides": [</td></tr><tr><td class=3D"line-number" value=3D"1240"></=
td><td class=3D"line-content">    {</td></tr><tr><td class=3D"line-number" =
value=3D"1241"></td><td class=3D"line-content">      "id": 1,</td></tr><tr>=
<td class=3D"line-number" value=3D"1242"></td><td class=3D"line-content">  =
    "title": "Slide title from narrative",</td></tr><tr><td class=3D"line-n=
umber" value=3D"1243"></td><td class=3D"line-content">      "shortTitle": "=
Short version",</td></tr><tr><td class=3D"line-number" value=3D"1244"></td>=
<td class=3D"line-content">      "content": "Main slide content prose (200-=
400 words)",</td></tr><tr><td class=3D"line-number" value=3D"1245"></td><td=
 class=3D"line-content">      "image": "",</td></tr><tr><td class=3D"line-n=
umber" value=3D"1246"></td><td class=3D"line-content">      "tabs": {</td><=
/tr><tr><td class=3D"line-number" value=3D"1247"></td><td class=3D"line-con=
tent">        "primary": { "label": "Primary", "content": "Primary perspect=
ive" },</td></tr><tr><td class=3D"line-number" value=3D"1248"></td><td clas=
s=3D"line-content">        "intel": { "label": "Intel", "content": "Intelli=
gence/research data" }</td></tr><tr><td class=3D"line-number" value=3D"1249=
"></td><td class=3D"line-content">      }</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1250"></td><td class=3D"line-content">    }</td></tr><tr><td=
 class=3D"line-number" value=3D"1251"></td><td class=3D"line-content">    /=
/ ... 10 slides total</td></tr><tr><td class=3D"line-number" value=3D"1252"=
></td><td class=3D"line-content">  ],</td></tr><tr><td class=3D"line-number=
" value=3D"1253"></td><td class=3D"line-content">  "intelligenceGlossary": =
[]</td></tr><tr><td class=3D"line-number" value=3D"1254"></td><td class=3D"=
line-content">}</td></tr><tr><td class=3D"line-number" value=3D"1255"></td>=
<td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" valu=
e=3D"1256"></td><td class=3D"line-content">CONVERSATION HISTORY:</td></tr><=
tr><td class=3D"line-number" value=3D"1257"></td><td class=3D"line-content"=
>${BuilderHistory.map(m =3D&gt; `[${m.role.toUpperCase()}]: ${m.content}`).=
join('\n\n').substring(0, 8000)}</td></tr><tr><td class=3D"line-number" val=
ue=3D"1258"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"=
line-number" value=3D"1259"></td><td class=3D"line-content">Generate the co=
mplete JSON structure. Output ONLY the raw JSON, no markdown fences or expl=
anation.`;</td></tr><tr><td class=3D"line-number" value=3D"1260"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
1261"></td><td class=3D"line-content">            try {</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1262"></td><td class=3D"line-content">        =
        setBuilderLoading(true, 'BUILDING MISSION...');</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1263"></td><td class=3D"line-content">        =
        log('Calling AI to structure mission data...', 'info');</td></tr><t=
r><td class=3D"line-number" value=3D"1264"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"1265"></td><td class=
=3D"line-content">                const reply =3D await callAI(context);</t=
d></tr><tr><td class=3D"line-number" value=3D"1266"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"1267"></td><t=
d class=3D"line-content">                try {</td></tr><tr><td class=3D"li=
ne-number" value=3D"1268"></td><td class=3D"line-content">                 =
   let jsonStr =3D reply.trim();</td></tr><tr><td class=3D"line-number" val=
ue=3D"1269"></td><td class=3D"line-content">                    if (jsonStr=
.startsWith('```json')) jsonStr =3D jsonStr.slice(7);</td></tr><tr><td clas=
s=3D"line-number" value=3D"1270"></td><td class=3D"line-content">          =
          if (jsonStr.startsWith('```')) jsonStr =3D jsonStr.slice(3);</td>=
</tr><tr><td class=3D"line-number" value=3D"1271"></td><td class=3D"line-co=
ntent">                    if (jsonStr.endsWith('```')) jsonStr =3D jsonStr=
.slice(0, -3);</td></tr><tr><td class=3D"line-number" value=3D"1272"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1273"></td><td class=3D"line-content">                    const parsed =
=3D JSON.parse(jsonStr.trim());</td></tr><tr><td class=3D"line-number" valu=
e=3D"1274"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"1275"></td><td class=3D"line-content">                =
    if (parsed.metadata) {</td></tr><tr><td class=3D"line-number" value=3D"=
1276"></td><td class=3D"line-content">                        accumulatedDa=
ta.metadata =3D { ...accumulatedData.metadata, ...parsed.metadata };</td></=
tr><tr><td class=3D"line-number" value=3D"1277"></td><td class=3D"line-cont=
ent">                    }</td></tr><tr><td class=3D"line-number" value=3D"=
1278"></td><td class=3D"line-content">                    if (parsed.slides=
 &amp;&amp; Array.isArray(parsed.slides)) {</td></tr><tr><td class=3D"line-=
number" value=3D"1279"></td><td class=3D"line-content">                    =
    parsed.slides.forEach((slide, i) =3D&gt; {</td></tr><tr><td class=3D"li=
ne-number" value=3D"1280"></td><td class=3D"line-content">                 =
           if (!accumulatedData.slides) accumulatedData.slides =3D [];</td>=
</tr><tr><td class=3D"line-number" value=3D"1281"></td><td class=3D"line-co=
ntent">                            if (accumulatedData.slides[i]) {</td></t=
r><tr><td class=3D"line-number" value=3D"1282"></td><td class=3D"line-conte=
nt">                                accumulatedData.slides[i] =3D { ...accu=
mulatedData.slides[i], ...slide };</td></tr><tr><td class=3D"line-number" v=
alue=3D"1283"></td><td class=3D"line-content">                            }=
 else {</td></tr><tr><td class=3D"line-number" value=3D"1284"></td><td clas=
s=3D"line-content">                                accumulatedData.slides[i=
] =3D slide;</td></tr><tr><td class=3D"line-number" value=3D"1285"></td><td=
 class=3D"line-content">                            }</td></tr><tr><td clas=
s=3D"line-number" value=3D"1286"></td><td class=3D"line-content">          =
              });</td></tr><tr><td class=3D"line-number" value=3D"1287"></t=
d><td class=3D"line-content">                    }</td></tr><tr><td class=
=3D"line-number" value=3D"1288"></td><td class=3D"line-content">           =
         if (parsed.intelligenceGlossary) {</td></tr><tr><td class=3D"line-=
number" value=3D"1289"></td><td class=3D"line-content">                    =
    accumulatedData.intelligenceGlossary =3D parsed.intelligenceGlossary;</=
td></tr><tr><td class=3D"line-number" value=3D"1290"></td><td class=3D"line=
-content">                    }</td></tr><tr><td class=3D"line-number" valu=
e=3D"1291"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"1292"></td><td class=3D"line-content">                =
    log('Mission data structured successfully!', 'success');</td></tr><tr><=
td class=3D"line-number" value=3D"1293"></td><td class=3D"line-content">   =
                 addBuilderChat('ai', '=E2=9C=85 **Mission data structured!=
** Review the validation report below.');</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1294"></td><td class=3D"line-content"><br></td></tr><tr><td =
class=3D"line-number" value=3D"1295"></td><td class=3D"line-content">      =
          } catch (parseErr) {</td></tr><tr><td class=3D"line-number" value=
=3D"1296"></td><td class=3D"line-content">                    log('AI respo=
nse was not valid JSON, storing raw response', 'warning');</td></tr><tr><td=
 class=3D"line-number" value=3D"1297"></td><td class=3D"line-content">     =
               accumulatedData.rawBirthResponse =3D reply;</td></tr><tr><td=
 class=3D"line-number" value=3D"1298"></td><td class=3D"line-content">     =
           }</td></tr><tr><td class=3D"line-number" value=3D"1299"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1300"></td><td class=3D"line-content">                const outputArea =
=3D document.getElementById('Builder-output');</td></tr><tr><td class=3D"li=
ne-number" value=3D"1301"></td><td class=3D"line-content">                i=
f (outputArea) renderBirthScreen(outputArea);</td></tr><tr><td class=3D"lin=
e-number" value=3D"1302"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"1303"></td><td class=3D"line-content">  =
          } catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"130=
4"></td><td class=3D"line-content">                log(`Birth failed: ${e.m=
essage}`, 'error');</td></tr><tr><td class=3D"line-number" value=3D"1305"><=
/td><td class=3D"line-content">                alert(`Birth failed: ${e.mes=
sage}`);</td></tr><tr><td class=3D"line-number" value=3D"1306"></td><td cla=
ss=3D"line-content">            } finally {</td></tr><tr><td class=3D"line-=
number" value=3D"1307"></td><td class=3D"line-content">                setB=
uilderLoading(false);</td></tr><tr><td class=3D"line-number" value=3D"1308"=
></td><td class=3D"line-content">            }</td></tr><tr><td class=3D"li=
ne-number" value=3D"1309"></td><td class=3D"line-content">        }</td></t=
r><tr><td class=3D"line-number" value=3D"1310"></td><td class=3D"line-conte=
nt"><br></td></tr><tr><td class=3D"line-number" value=3D"1311"></td><td cla=
ss=3D"line-content">        function resetBuilder() {</td></tr><tr><td clas=
s=3D"line-number" value=3D"1312"></td><td class=3D"line-content">          =
  if (!confirm("TERMINATE CURRENT BUILDER SESSION? All unsaved intelligence=
 will be lost.")) return;</td></tr><tr><td class=3D"line-number" value=3D"1=
313"></td><td class=3D"line-content">            currentPhaseIndex =3D 0;</=
td></tr><tr><td class=3D"line-number" value=3D"1314"></td><td class=3D"line=
-content">            BuilderHistory =3D [];</td></tr><tr><td class=3D"line=
-number" value=3D"1315"></td><td class=3D"line-content">            accumul=
atedData =3D { metadata: {}, slides: [] };</td></tr><tr><td class=3D"line-n=
umber" value=3D"1316"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"1317"></td><td class=3D"line-content">     =
       // Clear Chat</td></tr><tr><td class=3D"line-number" value=3D"1318">=
</td><td class=3D"line-content">            const chat =3D document.getElem=
entById('Builder-chat');</td></tr><tr><td class=3D"line-number" value=3D"13=
19"></td><td class=3D"line-content">            chat.innerHTML =3D `</td></=
tr><tr><td class=3D"line-number" value=3D"1320"></td><td class=3D"line-cont=
ent">                &lt;div class=3D"divider text-xs opacity-50"&gt;SESSIO=
N RESET&lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"1321"><=
/td><td class=3D"line-content">                &lt;div class=3D"chat chat-s=
tart"&gt;</td></tr><tr><td class=3D"line-number" value=3D"1322"></td><td cl=
ass=3D"line-content">                    &lt;div class=3D"chat-bubble chat-=
bubble-primary font-mono text-sm"&gt;</td></tr><tr><td class=3D"line-number=
" value=3D"1323"></td><td class=3D"line-content">                        Re=
ady when you are, Teacher! Let's create something amazing for your students=
.</td></tr><tr><td class=3D"line-number" value=3D"1324"></td><td class=3D"l=
ine-content">                    &lt;/div&gt;</td></tr><tr><td class=3D"lin=
e-number" value=3D"1325"></td><td class=3D"line-content">                &l=
t;/div&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"1326"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1327"></td><td class=3D"line-content">            updateBuilderUI();</t=
d></tr><tr><td class=3D"line-number" value=3D"1328"></td><td class=3D"line-=
content">            log("Builder Session Reset.", "warning");</td></tr><tr=
><td class=3D"line-number" value=3D"1329"></td><td class=3D"line-content"> =
       }</td></tr><tr><td class=3D"line-number" value=3D"1330"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"13=
31"></td><td class=3D"line-content">        // --- AUTH &amp; INIT ---</td>=
</tr><tr><td class=3D"line-number" value=3D"1332"></td><td class=3D"line-co=
ntent">        function decodeJwtResponse(token) {</td></tr><tr><td class=
=3D"line-number" value=3D"1333"></td><td class=3D"line-content">           =
 try {</td></tr><tr><td class=3D"line-number" value=3D"1334"></td><td class=
=3D"line-content">                var base64Url =3D token.split('.')[1];</t=
d></tr><tr><td class=3D"line-number" value=3D"1335"></td><td class=3D"line-=
content">                var base64 =3D base64Url.replace(/-/g, '+').replac=
e(/_/g, '/');</td></tr><tr><td class=3D"line-number" value=3D"1336"></td><t=
d class=3D"line-content">                var jsonPayload =3D decodeURICompo=
nent(window.atob(base64).split('').map(function (c) {</td></tr><tr><td clas=
s=3D"line-number" value=3D"1337"></td><td class=3D"line-content">          =
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);</td=
></tr><tr><td class=3D"line-number" value=3D"1338"></td><td class=3D"line-c=
ontent">                }).join(''));</td></tr><tr><td class=3D"line-number=
" value=3D"1339"></td><td class=3D"line-content">                return JSO=
N.parse(jsonPayload);</td></tr><tr><td class=3D"line-number" value=3D"1340"=
></td><td class=3D"line-content">            } catch (e) {</td></tr><tr><td=
 class=3D"line-number" value=3D"1341"></td><td class=3D"line-content">     =
           console.error("JWT Decode Error:", e);</td></tr><tr><td class=3D=
"line-number" value=3D"1342"></td><td class=3D"line-content">              =
  return null;</td></tr><tr><td class=3D"line-number" value=3D"1343"></td><=
td class=3D"line-content">            }</td></tr><tr><td class=3D"line-numb=
er" value=3D"1344"></td><td class=3D"line-content">        }</td></tr><tr><=
td class=3D"line-number" value=3D"1345"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"1346"></td><td class=3D"l=
ine-content">        function handleCredentialResponse(response) {</td></tr=
><tr><td class=3D"line-number" value=3D"1347"></td><td class=3D"line-conten=
t">            try {</td></tr><tr><td class=3D"line-number" value=3D"1348">=
</td><td class=3D"line-content">                console.log("handleCredenti=
alResponse: Packet received.", response);</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1349"></td><td class=3D"line-content">                log("G=
SI_ENGINE: Received Credential Packet. Decoding...", "info");</td></tr><tr>=
<td class=3D"line-number" value=3D"1350"></td><td class=3D"line-content"><b=
r></td></tr><tr><td class=3D"line-number" value=3D"1351"></td><td class=3D"=
line-content">                const responsePayload =3D decodeJwtResponse(r=
esponse.credential);</td></tr><tr><td class=3D"line-number" value=3D"1352">=
</td><td class=3D"line-content">                if (!responsePayload) throw=
 new Error("Could not decode identity token.");</td></tr><tr><td class=3D"l=
ine-number" value=3D"1353"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"1354"></td><td class=3D"line-content">=
                googleUser =3D responsePayload;</td></tr><tr><td class=3D"l=
ine-number" value=3D"1355"></td><td class=3D"line-content">                =
console.log("handleCredentialResponse: User Verified:", googleUser.email);<=
/td></tr><tr><td class=3D"line-number" value=3D"1356"></td><td class=3D"lin=
e-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1357"></td>=
<td class=3D"line-content">                // Update UI Badges</td></tr><tr=
><td class=3D"line-number" value=3D"1358"></td><td class=3D"line-content"> =
               const authBadge =3D document.getElementById('status-badge-au=
th');</td></tr><tr><td class=3D"line-number" value=3D"1359"></td><td class=
=3D"line-content">                if (authBadge) {</td></tr><tr><td class=
=3D"line-number" value=3D"1360"></td><td class=3D"line-content">           =
         authBadge.innerText =3D "AUTH_OK";</td></tr><tr><td class=3D"line-=
number" value=3D"1361"></td><td class=3D"line-content">                    =
authBadge.classList.remove('opacity-50', 'badge-outline');</td></tr><tr><td=
 class=3D"line-number" value=3D"1362"></td><td class=3D"line-content">     =
               authBadge.classList.add('badge-success', 'text-white');</td>=
</tr><tr><td class=3D"line-number" value=3D"1363"></td><td class=3D"line-co=
ntent">                }</td></tr><tr><td class=3D"line-number" value=3D"13=
64"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-num=
ber" value=3D"1365"></td><td class=3D"line-content">                const a=
vatar =3D document.getElementById('user-avatar-initials');</td></tr><tr><td=
 class=3D"line-number" value=3D"1366"></td><td class=3D"line-content">     =
           if (avatar) avatar.innerText =3D googleUser.given_name?.[0] || "=
U";</td></tr><tr><td class=3D"line-number" value=3D"1367"></td><td class=3D=
"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1368"><=
/td><td class=3D"line-content">                log(`Identity Verified: ${go=
ogleUser.email}`, "success");</td></tr><tr><td class=3D"line-number" value=
=3D"1369"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"1370"></td><td class=3D"line-content">                /=
/ Close the auth modal on successful login</td></tr><tr><td class=3D"line-n=
umber" value=3D"1371"></td><td class=3D"line-content">                const=
 modal =3D document.getElementById('auth_modal');</td></tr><tr><td class=3D=
"line-number" value=3D"1372"></td><td class=3D"line-content">              =
  if (modal) {</td></tr><tr><td class=3D"line-number" value=3D"1373"></td><=
td class=3D"line-content">                    modal.close();</td></tr><tr><=
td class=3D"line-number" value=3D"1374"></td><td class=3D"line-content">   =
                 log("Auth Modal Dismissed.", "info");</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1375"></td><td class=3D"line-content">         =
       }</td></tr><tr><td class=3D"line-number" value=3D"1376"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"13=
77"></td><td class=3D"line-content">                // Refresh data with au=
thenticated teacher ID</td></tr><tr><td class=3D"line-number" value=3D"1378=
"></td><td class=3D"line-content">                refreshClasses();</td></t=
r><tr><td class=3D"line-number" value=3D"1379"></td><td class=3D"line-conte=
nt">                fetchMissions();</td></tr><tr><td class=3D"line-number"=
 value=3D"1380"></td><td class=3D"line-content">                fetchCurric=
ulum();</td></tr><tr><td class=3D"line-number" value=3D"1381"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"138=
2"></td><td class=3D"line-content">            } catch (e) {</td></tr><tr><=
td class=3D"line-number" value=3D"1383"></td><td class=3D"line-content">   =
             console.error("Auth Callback Error:", e);</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1384"></td><td class=3D"line-content">         =
       log(`Auth Failed: ${e.message}`, "error");</td></tr><tr><td class=3D=
"line-number" value=3D"1385"></td><td class=3D"line-content">              =
  alert("Identity verification failed. Check the console for details.");</t=
d></tr><tr><td class=3D"line-number" value=3D"1386"></td><td class=3D"line-=
content">            }</td></tr><tr><td class=3D"line-number" value=3D"1387=
"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"line-=
number" value=3D"1388"></td><td class=3D"line-content">        // Ensure gl=
obal visibility for GSI</td></tr><tr><td class=3D"line-number" value=3D"138=
9"></td><td class=3D"line-content">        window.handleCredentialResponse =
=3D handleCredentialResponse;</td></tr><tr><td class=3D"line-number" value=
=3D"1390"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"1391"></td><td class=3D"line-content">        let gAuth=
Initialized =3D false;</td></tr><tr><td class=3D"line-number" value=3D"1392=
"></td><td class=3D"line-content">        function initGoogleAuth() {</td><=
/tr><tr><td class=3D"line-number" value=3D"1393"></td><td class=3D"line-con=
tent">            if (gAuthInitialized) {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1394"></td><td class=3D"line-content">                const =
container =3D document.getElementById("google-signin-container");</td></tr>=
<tr><td class=3D"line-number" value=3D"1395"></td><td class=3D"line-content=
">                if (container &amp;&amp; container.innerHTML =3D=3D=3D ""=
) {</td></tr><tr><td class=3D"line-number" value=3D"1396"></td><td class=3D=
"line-content">                    google.accounts.id.renderButton(containe=
r, { theme: "outline", size: "large", width: 280 });</td></tr><tr><td class=
=3D"line-number" value=3D"1397"></td><td class=3D"line-content">           =
     }</td></tr><tr><td class=3D"line-number" value=3D"1398"></td><td class=
=3D"line-content">                return;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1399"></td><td class=3D"line-content">            }</td></tr=
><tr><td class=3D"line-number" value=3D"1400"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"1401"></td><td clas=
s=3D"line-content">            log("GSI_ENGINE: Establishing Secure Identit=
y Link...");</td></tr><tr><td class=3D"line-number" value=3D"1402"></td><td=
 class=3D"line-content">            try {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1403"></td><td class=3D"line-content">                if (ty=
peof google !=3D=3D 'undefined' &amp;&amp; google.accounts) {</td></tr><tr>=
<td class=3D"line-number" value=3D"1404"></td><td class=3D"line-content">  =
                  google.accounts.id.initialize({</td></tr><tr><td class=3D=
"line-number" value=3D"1405"></td><td class=3D"line-content">              =
          client_id: GOOGLE_CLIENT_ID,</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1406"></td><td class=3D"line-content">                        c=
allback: window.handleCredentialResponse</td></tr><tr><td class=3D"line-num=
ber" value=3D"1407"></td><td class=3D"line-content">                    });=
</td></tr><tr><td class=3D"line-number" value=3D"1408"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1409"></td=
><td class=3D"line-content">                    const container =3D documen=
t.getElementById("google-signin-container");</td></tr><tr><td class=3D"line=
-number" value=3D"1410"></td><td class=3D"line-content">                   =
 if (container) {</td></tr><tr><td class=3D"line-number" value=3D"1411"></t=
d><td class=3D"line-content">                        google.accounts.id.ren=
derButton(</td></tr><tr><td class=3D"line-number" value=3D"1412"></td><td c=
lass=3D"line-content">                            container,</td></tr><tr><=
td class=3D"line-number" value=3D"1413"></td><td class=3D"line-content">   =
                         { theme: "outline", size: "large", width: 280 }</t=
d></tr><tr><td class=3D"line-number" value=3D"1414"></td><td class=3D"line-=
content">                        );</td></tr><tr><td class=3D"line-number" =
value=3D"1415"></td><td class=3D"line-content">                    }</td></=
tr><tr><td class=3D"line-number" value=3D"1416"></td><td class=3D"line-cont=
ent">                    log("Google Auth Initialized.", "success");</td></=
tr><tr><td class=3D"line-number" value=3D"1417"></td><td class=3D"line-cont=
ent">                    gAuthInitialized =3D true;</td></tr><tr><td class=
=3D"line-number" value=3D"1418"></td><td class=3D"line-content">           =
     } else {</td></tr><tr><td class=3D"line-number" value=3D"1419"></td><t=
d class=3D"line-content">                    log("GSI Library not loaded ye=
t.", "warning");</td></tr><tr><td class=3D"line-number" value=3D"1420"></td=
><td class=3D"line-content">                }</td></tr><tr><td class=3D"lin=
e-number" value=3D"1421"></td><td class=3D"line-content">            } catc=
h (e) {</td></tr><tr><td class=3D"line-number" value=3D"1422"></td><td clas=
s=3D"line-content">                console.error("GSI Init Error:", e);</td=
></tr><tr><td class=3D"line-number" value=3D"1423"></td><td class=3D"line-c=
ontent">                log(`GSI Error: ${e.message}`, "error");</td></tr><=
tr><td class=3D"line-number" value=3D"1424"></td><td class=3D"line-content"=
>            }</td></tr><tr><td class=3D"line-number" value=3D"1425"></td><=
td class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" =
value=3D"1426"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"1427"></td><td class=3D"line-content">        fun=
ction openAuthModal() {</td></tr><tr><td class=3D"line-number" value=3D"142=
8"></td><td class=3D"line-content">            const modal =3D document.get=
ElementById('auth_modal');</td></tr><tr><td class=3D"line-number" value=3D"=
1429"></td><td class=3D"line-content">            if (modal) {</td></tr><tr=
><td class=3D"line-number" value=3D"1430"></td><td class=3D"line-content"> =
               initGoogleAuth(); // Ensure button is rendered</td></tr><tr>=
<td class=3D"line-number" value=3D"1431"></td><td class=3D"line-content">  =
              modal.showModal();</td></tr><tr><td class=3D"line-number" val=
ue=3D"1432"></td><td class=3D"line-content">            }</td></tr><tr><td =
class=3D"line-number" value=3D"1433"></td><td class=3D"line-content">      =
  }</td></tr><tr><td class=3D"line-number" value=3D"1434"></td><td class=3D=
"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1435"><=
/td><td class=3D"line-content">        function googleLogout() {</td></tr><=
tr><td class=3D"line-number" value=3D"1436"></td><td class=3D"line-content"=
>            log("LOGOUT: Terminating session...", "warning");</td></tr><tr=
><td class=3D"line-number" value=3D"1437"></td><td class=3D"line-content"> =
           googleUser =3D null;</td></tr><tr><td class=3D"line-number" valu=
e=3D"1438"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"1439"></td><td class=3D"line-content">            // R=
eset UI</td></tr><tr><td class=3D"line-number" value=3D"1440"></td><td clas=
s=3D"line-content">            const authBadge =3D document.getElementById(=
'status-badge-auth');</td></tr><tr><td class=3D"line-number" value=3D"1441"=
></td><td class=3D"line-content">            if (authBadge) {</td></tr><tr>=
<td class=3D"line-number" value=3D"1442"></td><td class=3D"line-content">  =
              authBadge.innerText =3D "GUEST";</td></tr><tr><td class=3D"li=
ne-number" value=3D"1443"></td><td class=3D"line-content">                a=
uthBadge.classList.add('opacity-50', 'badge-outline');</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1444"></td><td class=3D"line-content">         =
       authBadge.classList.remove('badge-success', 'text-white');</td></tr>=
<tr><td class=3D"line-number" value=3D"1445"></td><td class=3D"line-content=
">            }</td></tr><tr><td class=3D"line-number" value=3D"1446"></td>=
<td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" valu=
e=3D"1447"></td><td class=3D"line-content">            const avatar =3D doc=
ument.getElementById('user-avatar-initials');</td></tr><tr><td class=3D"lin=
e-number" value=3D"1448"></td><td class=3D"line-content">            if (av=
atar) avatar.innerText =3D "G";</td></tr><tr><td class=3D"line-number" valu=
e=3D"1449"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"1450"></td><td class=3D"line-content">            // R=
e-render as guest</td></tr><tr><td class=3D"line-number" value=3D"1451"></t=
d><td class=3D"line-content">            refreshClasses();</td></tr><tr><td=
 class=3D"line-number" value=3D"1452"></td><td class=3D"line-content">     =
       fetchMissions();</td></tr><tr><td class=3D"line-number" value=3D"145=
3"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"1454"></td><td class=3D"line-content">            log("Session=
 Terminated. Operating in Guest Mode.", "info");</td></tr><tr><td class=3D"=
line-number" value=3D"1455"></td><td class=3D"line-content">            ope=
nAuthModal(); // Prompt to sign back in</td></tr><tr><td class=3D"line-numb=
er" value=3D"1456"></td><td class=3D"line-content">        }</td></tr><tr><=
td class=3D"line-number" value=3D"1457"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"1458"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1459"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"1460"></td><td class=3D"line-content">        // --- STUB FUNCTIONS =
FOR MISSING LOGIC (Will be filled in Phase 2) ---</td></tr><tr><td class=3D=
"line-number" value=3D"1461"></td><td class=3D"line-content">        async =
function processBuilder() {</td></tr><tr><td class=3D"line-number" value=3D=
"1462"></td><td class=3D"line-content">            const inputEl =3D docume=
nt.getElementById('f-input');</td></tr><tr><td class=3D"line-number" value=
=3D"1463"></td><td class=3D"line-content">            const input =3D input=
El.value.trim();</td></tr><tr><td class=3D"line-number" value=3D"1464"></td=
><td class=3D"line-content">            const phase =3D getCurrentPhase();<=
/td></tr><tr><td class=3D"line-number" value=3D"1465"></td><td class=3D"lin=
e-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1466"></td>=
<td class=3D"line-content">            // 1. Check for basic navigation com=
mands</td></tr><tr><td class=3D"line-number" value=3D"1467"></td><td class=
=3D"line-content">            if (input.toLowerCase().match(/^(next|proceed=
|advance|continue)$/)) {</td></tr><tr><td class=3D"line-number" value=3D"14=
68"></td><td class=3D"line-content">                advancePhase();</td></t=
r><tr><td class=3D"line-number" value=3D"1469"></td><td class=3D"line-conte=
nt">                inputEl.value =3D '';</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1470"></td><td class=3D"line-content">                return=
;</td></tr><tr><td class=3D"line-number" value=3D"1471"></td><td class=3D"l=
ine-content">            }</td></tr><tr><td class=3D"line-number" value=3D"=
1472"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-n=
umber" value=3D"1473"></td><td class=3D"line-content">            // 2. Pre=
pare UI</td></tr><tr><td class=3D"line-number" value=3D"1474"></td><td clas=
s=3D"line-content">            addBuilderChat('user', input || "(Generating=
 intel...)");</td></tr><tr><td class=3D"line-number" value=3D"1475"></td><t=
d class=3D"line-content">            inputEl.value =3D '';</td></tr><tr><td=
 class=3D"line-number" value=3D"1476"></td><td class=3D"line-content">     =
       const loadingId =3D `msg-${Date.now()}`;</td></tr><tr><td class=3D"l=
ine-number" value=3D"1477"></td><td class=3D"line-content">            // A=
dd temp loading bubble</td></tr><tr><td class=3D"line-number" value=3D"1478=
"></td><td class=3D"line-content">            const chat =3D document.getEl=
ementById('Builder-chat');</td></tr><tr><td class=3D"line-number" value=3D"=
1479"></td><td class=3D"line-content">            chat.insertAdjacentHTML('=
beforeend', `&lt;div id=3D"${loadingId}" class=3D"chat chat-start"&gt;&lt;d=
iv class=3D"chat-bubble chat-bubble-secondary animate-pulse text-xs"&gt;Thi=
nking...&lt;/div&gt;&lt;/div&gt;`);</td></tr><tr><td class=3D"line-number" =
value=3D"1480"></td><td class=3D"line-content">            chat.scrollTop =
=3D chat.scrollHeight;</td></tr><tr><td class=3D"line-number" value=3D"1481=
"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numbe=
r" value=3D"1482"></td><td class=3D"line-content">            try {</td></t=
r><tr><td class=3D"line-number" value=3D"1483"></td><td class=3D"line-conte=
nt">                console.log("processBuilder: Initiating AI Request...",=
 { phase, inputLength: input.length });</td></tr><tr><td class=3D"line-numb=
er" value=3D"1484"></td><td class=3D"line-content">                // 3. Co=
nstruct Prompt Context</td></tr><tr><td class=3D"line-number" value=3D"1485=
"></td><td class=3D"line-content">                let context =3D `${Builde=
r_SYSTEM_CORE}\n\n`;</td></tr><tr><td class=3D"line-number" value=3D"1486">=
</td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number"=
 value=3D"1487"></td><td class=3D"line-content">                // Curricul=
um Context</td></tr><tr><td class=3D"line-number" value=3D"1488"></td><td c=
lass=3D"line-content">                const country =3D document.getElement=
ById('f-country').value;</td></tr><tr><td class=3D"line-number" value=3D"14=
89"></td><td class=3D"line-content">                const region =3D docume=
nt.getElementById('f-region').value;</td></tr><tr><td class=3D"line-number"=
 value=3D"1490"></td><td class=3D"line-content">                const cours=
e =3D document.getElementById('f-course').value;</td></tr><tr><td class=3D"=
line-number" value=3D"1491"></td><td class=3D"line-content">               =
 const checks =3D document.querySelectorAll('.outcome-check:checked');</td>=
</tr><tr><td class=3D"line-number" value=3D"1492"></td><td class=3D"line-co=
ntent">                let selectedOutcomes =3D Array.from(checks).map(c =
=3D&gt; c.value);</td></tr><tr><td class=3D"line-number" value=3D"1493"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"1494"></td><td class=3D"line-content">                // If no outco=
mes selected but course is chosen, include ALL outcomes</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1495"></td><td class=3D"line-content">        =
        if (selectedOutcomes.length =3D=3D=3D 0 &amp;&amp; course &amp;&amp=
; window.curriculumData?.[country]?.[region]?.[course]) {</td></tr><tr><td =
class=3D"line-number" value=3D"1496"></td><td class=3D"line-content">      =
              selectedOutcomes =3D window.curriculumData[country][region][c=
ourse];</td></tr><tr><td class=3D"line-number" value=3D"1497"></td><td clas=
s=3D"line-content">                    log(`No outcomes selected - includin=
g all ${selectedOutcomes.length} for AI analysis.`, 'info');</td></tr><tr><=
td class=3D"line-number" value=3D"1498"></td><td class=3D"line-content">   =
             }</td></tr><tr><td class=3D"line-number" value=3D"1499"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1500"></td><td class=3D"line-content">                if (country || re=
gion || course) {</td></tr><tr><td class=3D"line-number" value=3D"1501"></t=
d><td class=3D"line-content">                    context +=3D `\n--- TEACHE=
R CONTEXT ---\n`;</td></tr><tr><td class=3D"line-number" value=3D"1502"></t=
d><td class=3D"line-content">                    context +=3D `LOCALE: ${co=
untry} | ${region}\n`;</td></tr><tr><td class=3D"line-number" value=3D"1503=
"></td><td class=3D"line-content">                    context +=3D `COURSE:=
 ${course}\n`;</td></tr><tr><td class=3D"line-number" value=3D"1504"></td><=
td class=3D"line-content">                    if (selectedOutcomes.length &=
gt; 0) {</td></tr><tr><td class=3D"line-number" value=3D"1505"></td><td cla=
ss=3D"line-content">                        context +=3D `TARGET OUTCOMES: =
${selectedOutcomes.join(" | ")}\n`;</td></tr><tr><td class=3D"line-number" =
value=3D"1506"></td><td class=3D"line-content">                        log(=
`Aligning with ${selectedOutcomes.length} outcomes.`, "info");</td></tr><tr=
><td class=3D"line-number" value=3D"1507"></td><td class=3D"line-content"> =
                   }</td></tr><tr><td class=3D"line-number" value=3D"1508">=
</td><td class=3D"line-content">                }</td></tr><tr><td class=3D=
"line-number" value=3D"1509"></td><td class=3D"line-content"><br></td></tr>=
<tr><td class=3D"line-number" value=3D"1510"></td><td class=3D"line-content=
">                // Append History (Last 6 turns to save tokens)</td></tr>=
<tr><td class=3D"line-number" value=3D"1511"></td><td class=3D"line-content=
">                const recentHistory =3D BuilderHistory.slice(-6);</td></t=
r><tr><td class=3D"line-number" value=3D"1512"></td><td class=3D"line-conte=
nt">                if (recentHistory.length &gt; 0) {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1513"></td><td class=3D"line-content">         =
           context +=3D `\n--- PREVIOUS INTEL ---\n`;</td></tr><tr><td clas=
s=3D"line-number" value=3D"1514"></td><td class=3D"line-content">          =
          recentHistory.forEach(h =3D&gt; context +=3D `${h.role.toUpperCas=
e()}: ${h.content}\n`);</td></tr><tr><td class=3D"line-number" value=3D"151=
5"></td><td class=3D"line-content">                }</td></tr><tr><td class=
=3D"line-number" value=3D"1516"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"1517"></td><td class=3D"line-cont=
ent">                // Research Context (Injection)</td></tr><tr><td class=
=3D"line-number" value=3D"1518"></td><td class=3D"line-content">           =
     if (accumulatedData.deepSearchResults) {</td></tr><tr><td class=3D"lin=
e-number" value=3D"1519"></td><td class=3D"line-content">                  =
  context +=3D `\n--- VERIFIED RESEARCH HARVEST ---\n${accumulatedData.deep=
SearchResults}\n`;</td></tr><tr><td class=3D"line-number" value=3D"1520"></=
td><td class=3D"line-content">                }</td></tr><tr><td class=3D"l=
ine-number" value=3D"1521"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"1522"></td><td class=3D"line-content">=
                context +=3D `\nCURRENT OBJECTIVE: ${phase.title}\nINSTRUCT=
ION: ${phase.prompt}\nUSER COMMAND: ${input}`;</td></tr><tr><td class=3D"li=
ne-number" value=3D"1523"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"1524"></td><td class=3D"line-content"> =
               // 4. API Call</td></tr><tr><td class=3D"line-number" value=
=3D"1525"></td><td class=3D"line-content">                console.log("proc=
essBuilder: Sending context to AI...");</td></tr><tr><td class=3D"line-numb=
er" value=3D"1526"></td><td class=3D"line-content">                const re=
sponseText =3D await callAI(context);</td></tr><tr><td class=3D"line-number=
" value=3D"1527"></td><td class=3D"line-content">                console.lo=
g("processBuilder: AI success.", responseText.substring(0, 50));</td></tr><=
tr><td class=3D"line-number" value=3D"1528"></td><td class=3D"line-content"=
><br></td></tr><tr><td class=3D"line-number" value=3D"1529"></td><td class=
=3D"line-content">                // 5. Handle Success</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1530"></td><td class=3D"line-content">         =
       const loader =3D document.getElementById(loadingId);</td></tr><tr><t=
d class=3D"line-number" value=3D"1531"></td><td class=3D"line-content">    =
            if (loader) loader.remove();</td></tr><tr><td class=3D"line-num=
ber" value=3D"1532"></td><td class=3D"line-content"><br></td></tr><tr><td c=
lass=3D"line-number" value=3D"1533"></td><td class=3D"line-content">       =
         const lowerResponse =3D responseText.toLowerCase();</td></tr><tr><=
td class=3D"line-number" value=3D"1534"></td><td class=3D"line-content">   =
             const shouldShowNext =3D lowerResponse.includes('authorize nex=
t') ||</td></tr><tr><td class=3D"line-number" value=3D"1535"></td><td class=
=3D"line-content">                    lowerResponse.includes('proceed to ne=
xt') ||</td></tr><tr><td class=3D"line-number" value=3D"1536"></td><td clas=
s=3D"line-content">                    lowerResponse.includes('ready for vi=
suals') ||</td></tr><tr><td class=3D"line-number" value=3D"1537"></td><td c=
lass=3D"line-content">                    (phase.id =3D=3D=3D 'narrative' &=
amp;&amp; lowerResponse.includes('slide 10:'));</td></tr><tr><td class=3D"l=
ine-number" value=3D"1538"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"1539"></td><td class=3D"line-content">=
                addBuilderChat('ai', responseText, { showNextPhaseButton: s=
houldShowNext });</td></tr><tr><td class=3D"line-number" value=3D"1540"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"1541"></td><td class=3D"line-content">                // Save to His=
tory</td></tr><tr><td class=3D"line-number" value=3D"1542"></td><td class=
=3D"line-content">                BuilderHistory.push({ role: 'user', conte=
nt: input });</td></tr><tr><td class=3D"line-number" value=3D"1543"></td><t=
d class=3D"line-content">                BuilderHistory.push({ role: 'assis=
tant', content: responseText });</td></tr><tr><td class=3D"line-number" val=
ue=3D"1544"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"=
line-number" value=3D"1545"></td><td class=3D"line-content">               =
 // Parse narrative if in applicable phase</td></tr><tr><td class=3D"line-n=
umber" value=3D"1546"></td><td class=3D"line-content">                if (p=
hase.id =3D=3D=3D 'narrative' || phase.id =3D=3D=3D 'scripting' || response=
Text.includes('SLIDE 1:')) {</td></tr><tr><td class=3D"line-number" value=
=3D"1547"></td><td class=3D"line-content">                    parseNarrativ=
eResponse(responseText);</td></tr><tr><td class=3D"line-number" value=3D"15=
48"></td><td class=3D"line-content">                }</td></tr><tr><td clas=
s=3D"line-number" value=3D"1549"></td><td class=3D"line-content"><br></td><=
/tr><tr><td class=3D"line-number" value=3D"1550"></td><td class=3D"line-con=
tent">                log(`AI Directive Received [${phase.label}]`, "succes=
s");</td></tr><tr><td class=3D"line-number" value=3D"1551"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1552=
"></td><td class=3D"line-content">            } catch (e) {</td></tr><tr><t=
d class=3D"line-number" value=3D"1553"></td><td class=3D"line-content">    =
            console.error("processBuilder Failure:", e);</td></tr><tr><td c=
lass=3D"line-number" value=3D"1554"></td><td class=3D"line-content">       =
         const loader =3D document.getElementById(loadingId);</td></tr><tr>=
<td class=3D"line-number" value=3D"1555"></td><td class=3D"line-content">  =
              if (loader) loader.remove();</td></tr><tr><td class=3D"line-n=
umber" value=3D"1556"></td><td class=3D"line-content">                addBu=
ilderChat('ai', `**CONNECTION LOST**: ${e.message}`);</td></tr><tr><td clas=
s=3D"line-number" value=3D"1557"></td><td class=3D"line-content">          =
      log(`Builder Error: ${e.message}`, "error");</td></tr><tr><td class=
=3D"line-number" value=3D"1558"></td><td class=3D"line-content">           =
 }</td></tr><tr><td class=3D"line-number" value=3D"1559"></td><td class=3D"=
line-content">        }</td></tr><tr><td class=3D"line-number" value=3D"156=
0"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"1561"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"1562"></td><td class=3D"line-content">        =
// --- NARRATIVE PARSER (Restored from old version) ---</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1563"></td><td class=3D"line-content">        =
function parseNarrativeResponse(text) {</td></tr><tr><td class=3D"line-numb=
er" value=3D"1564"></td><td class=3D"line-content">            if (!text) r=
eturn;</td></tr><tr><td class=3D"line-number" value=3D"1565"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1566=
"></td><td class=3D"line-content">            log('Parsing narrative respon=
se for structured components...', 'info');</td></tr><tr><td class=3D"line-n=
umber" value=3D"1567"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"1568"></td><td class=3D"line-content">     =
       // 1. Extract Mission Title if present</td></tr><tr><td class=3D"lin=
e-number" value=3D"1569"></td><td class=3D"line-content">            const =
titleMatch =3D text.match(/Mission Title:\s*(.*)/i);</td></tr><tr><td class=
=3D"line-number" value=3D"1570"></td><td class=3D"line-content">           =
 if (titleMatch &amp;&amp; titleMatch[1]) {</td></tr><tr><td class=3D"line-=
number" value=3D"1571"></td><td class=3D"line-content">                if (=
!accumulatedData.metadata) accumulatedData.metadata =3D {};</td></tr><tr><t=
d class=3D"line-number" value=3D"1572"></td><td class=3D"line-content">    =
            accumulatedData.metadata.title =3D titleMatch[1].trim();</td></=
tr><tr><td class=3D"line-number" value=3D"1573"></td><td class=3D"line-cont=
ent">                log(`Extracted Mission Title: ${accumulatedData.metada=
ta.title}`, 'success');</td></tr><tr><td class=3D"line-number" value=3D"157=
4"></td><td class=3D"line-content">            }</td></tr><tr><td class=3D"=
line-number" value=3D"1575"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"1576"></td><td class=3D"line-content"=
>            // 2. Split into Slide Blocks</td></tr><tr><td class=3D"line-n=
umber" value=3D"1577"></td><td class=3D"line-content">            // Format=
 usually starts with "SLIDE X:"</td></tr><tr><td class=3D"line-number" valu=
e=3D"1578"></td><td class=3D"line-content">            const slides =3D [];=
</td></tr><tr><td class=3D"line-number" value=3D"1579"></td><td class=3D"li=
ne-content">            const slideBlocks =3D text.split(/SLIDE\s+\d+:\s+/i=
).slice(1); // Skip the preamble</td></tr><tr><td class=3D"line-number" val=
ue=3D"1580"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"=
line-number" value=3D"1581"></td><td class=3D"line-content">            sli=
deBlocks.forEach((block, idx) =3D&gt; {</td></tr><tr><td class=3D"line-numb=
er" value=3D"1582"></td><td class=3D"line-content">                const sl=
ide =3D {</td></tr><tr><td class=3D"line-number" value=3D"1583"></td><td cl=
ass=3D"line-content">                    id: idx + 1,</td></tr><tr><td clas=
s=3D"line-number" value=3D"1584"></td><td class=3D"line-content">          =
          type: 'BRIEFING', // Default</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1585"></td><td class=3D"line-content">                    title=
: '',</td></tr><tr><td class=3D"line-number" value=3D"1586"></td><td class=
=3D"line-content">                    content: '',</td></tr><tr><td class=
=3D"line-number" value=3D"1587"></td><td class=3D"line-content">           =
         interactionPrompt: '',</td></tr><tr><td class=3D"line-number" valu=
e=3D"1588"></td><td class=3D"line-content">                    options: [],=
</td></tr><tr><td class=3D"line-number" value=3D"1589"></td><td class=3D"li=
ne-content">                    outcomes: {},</td></tr><tr><td class=3D"lin=
e-number" value=3D"1590"></td><td class=3D"line-content">                  =
  tabs: { primary: { label: 'Primary', content: '' }, intel: { label: 'Inte=
l', content: '' }, legal: { label: 'Legal', content: '' } }</td></tr><tr><t=
d class=3D"line-number" value=3D"1591"></td><td class=3D"line-content">    =
            };</td></tr><tr><td class=3D"line-number" value=3D"1592"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1593"></td><td class=3D"line-content">                // Extract Type a=
nd Title</td></tr><tr><td class=3D"line-number" value=3D"1594"></td><td cla=
ss=3D"line-content">                const titleLineMatch =3D block.match(/S=
LIDE TYPE:\s*(.*?)\s*\|\s*TITLE:\s*(.*)/i);</td></tr><tr><td class=3D"line-=
number" value=3D"1595"></td><td class=3D"line-content">                if (=
titleLineMatch) {</td></tr><tr><td class=3D"line-number" value=3D"1596"></t=
d><td class=3D"line-content">                    slide.type =3D titleLineMa=
tch[1].trim();</td></tr><tr><td class=3D"line-number" value=3D"1597"></td><=
td class=3D"line-content">                    slide.title =3D titleLineMatc=
h[2].trim();</td></tr><tr><td class=3D"line-number" value=3D"1598"></td><td=
 class=3D"line-content">                    slide.shortTitle =3D slide.titl=
e.substring(0, 20);</td></tr><tr><td class=3D"line-number" value=3D"1599"><=
/td><td class=3D"line-content">                }</td></tr><tr><td class=3D"=
line-number" value=3D"1600"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"1601"></td><td class=3D"line-content"=
>                // Extract Content</td></tr><tr><td class=3D"line-number" =
value=3D"1602"></td><td class=3D"line-content">                const conten=
tMatch =3D block.match(/CONTENT:\s*([\s\S]*?)(?=3DINTERACTION PROMPT:|OPTIO=
NS:|OUTCOMES:|INTEL:|$)/i);</td></tr><tr><td class=3D"line-number" value=3D=
"1603"></td><td class=3D"line-content">                if (contentMatch) {<=
/td></tr><tr><td class=3D"line-number" value=3D"1604"></td><td class=3D"lin=
e-content">                    slide.content =3D contentMatch[1].trim();</t=
d></tr><tr><td class=3D"line-number" value=3D"1605"></td><td class=3D"line-=
content">                }</td></tr><tr><td class=3D"line-number" value=3D"=
1606"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-n=
umber" value=3D"1607"></td><td class=3D"line-content">                // Ex=
tract Interaction Prompt</td></tr><tr><td class=3D"line-number" value=3D"16=
08"></td><td class=3D"line-content">                const promptMatch =3D b=
lock.match(/INTERACTION PROMPT:\s*([\s\S]*?)(?=3DOPTIONS:|OUTCOMES:|INTEL:|=
$)/i);</td></tr><tr><td class=3D"line-number" value=3D"1609"></td><td class=
=3D"line-content">                if (promptMatch) {</td></tr><tr><td class=
=3D"line-number" value=3D"1610"></td><td class=3D"line-content">           =
         slide.interactionPrompt =3D promptMatch[1].trim();</td></tr><tr><t=
d class=3D"line-number" value=3D"1611"></td><td class=3D"line-content">    =
            }</td></tr><tr><td class=3D"line-number" value=3D"1612"></td><t=
d class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1613"></td><td class=3D"line-content">                // Extract Option=
s</td></tr><tr><td class=3D"line-number" value=3D"1614"></td><td class=3D"l=
ine-content">                const optionsMatch =3D block.match(/OPTIONS:\s=
*([\s\S]*?)(?=3DOUTCOMES:|INTEL:|$)/i);</td></tr><tr><td class=3D"line-numb=
er" value=3D"1615"></td><td class=3D"line-content">                if (opti=
onsMatch) {</td></tr><tr><td class=3D"line-number" value=3D"1616"></td><td =
class=3D"line-content">                    const opts =3D optionsMatch[1].m=
atch(/\["(.*?)"\]/g);</td></tr><tr><td class=3D"line-number" value=3D"1617"=
></td><td class=3D"line-content">                    if (opts) {</td></tr><=
tr><td class=3D"line-number" value=3D"1618"></td><td class=3D"line-content"=
>                        slide.options =3D opts.map(o =3D&gt; o.replace(/\[=
"(.*)"\]/, '$1'));</td></tr><tr><td class=3D"line-number" value=3D"1619"></=
td><td class=3D"line-content">                    }</td></tr><tr><td class=
=3D"line-number" value=3D"1620"></td><td class=3D"line-content">           =
     }</td></tr><tr><td class=3D"line-number" value=3D"1621"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1622=
"></td><td class=3D"line-content">                // Extract Intel / Tabs</=
td></tr><tr><td class=3D"line-number" value=3D"1623"></td><td class=3D"line=
-content">                const intelMatch =3D block.match(/INTEL:\s*\{([\s=
\S]*?)\}/i);</td></tr><tr><td class=3D"line-number" value=3D"1624"></td><td=
 class=3D"line-content">                if (intelMatch) {</td></tr><tr><td =
class=3D"line-number" value=3D"1625"></td><td class=3D"line-content">      =
              const rawIntel =3D intelMatch[1];</td></tr><tr><td class=3D"l=
ine-number" value=3D"1626"></td><td class=3D"line-content">                =
    // Very loose parsing for AI-generated "JSON-like" objects</td></tr><tr=
><td class=3D"line-number" value=3D"1627"></td><td class=3D"line-content"> =
                   const primary =3D rawIntel.match(/PRIMARY:\s*"(.*?)"/i);=
</td></tr><tr><td class=3D"line-number" value=3D"1628"></td><td class=3D"li=
ne-content">                    const legal =3D rawIntel.match(/LEGAL:\s*"(=
.*?)"/i);</td></tr><tr><td class=3D"line-number" value=3D"1629"></td><td cl=
ass=3D"line-content">                    const intelSecondary =3D rawIntel.=
match(/INTEL:\s*"(.*?)"/i);</td></tr><tr><td class=3D"line-number" value=3D=
"1630"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-=
number" value=3D"1631"></td><td class=3D"line-content">                    =
if (primary) slide.tabs.primary.content =3D primary[1];</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1632"></td><td class=3D"line-content">        =
            if (legal) slide.tabs.legal.content =3D legal[1];</td></tr><tr>=
<td class=3D"line-number" value=3D"1633"></td><td class=3D"line-content">  =
                  if (intelSecondary) slide.tabs.intel.content =3D intelSec=
ondary[1];</td></tr><tr><td class=3D"line-number" value=3D"1634"></td><td c=
lass=3D"line-content">                }</td></tr><tr><td class=3D"line-numb=
er" value=3D"1635"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"1636"></td><td class=3D"line-content">        =
        slides.push(slide);</td></tr><tr><td class=3D"line-number" value=3D=
"1637"></td><td class=3D"line-content">            });</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1638"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"1639"></td><td class=3D"line-co=
ntent">            // --- ROBUSTNESS: If no slides extracted, try looser pa=
rsing ---</td></tr><tr><td class=3D"line-number" value=3D"1640"></td><td cl=
ass=3D"line-content">            if (slides.length =3D=3D=3D 0) {</td></tr>=
<tr><td class=3D"line-number" value=3D"1641"></td><td class=3D"line-content=
">                log('Strict parser found no slides. Attempting looser ext=
raction...', 'warning');</td></tr><tr><td class=3D"line-number" value=3D"16=
42"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-num=
ber" value=3D"1643"></td><td class=3D"line-content">                // Try =
to extract any numbered sections</td></tr><tr><td class=3D"line-number" val=
ue=3D"1644"></td><td class=3D"line-content">                const looseBloc=
ks =3D text.split(/(?:^|\n)(?:###|##)\s*(?:Slide\s*)?\d+/i);</td></tr><tr><=
td class=3D"line-number" value=3D"1645"></td><td class=3D"line-content">   =
             if (looseBlocks.length &gt; 1) {</td></tr><tr><td class=3D"lin=
e-number" value=3D"1646"></td><td class=3D"line-content">                  =
  looseBlocks.slice(1).forEach((block, idx) =3D&gt; {</td></tr><tr><td clas=
s=3D"line-number" value=3D"1647"></td><td class=3D"line-content">          =
              const slide =3D {</td></tr><tr><td class=3D"line-number" valu=
e=3D"1648"></td><td class=3D"line-content">                            id: =
idx + 1,</td></tr><tr><td class=3D"line-number" value=3D"1649"></td><td cla=
ss=3D"line-content">                            type: 'BRIEFING',</td></tr>=
<tr><td class=3D"line-number" value=3D"1650"></td><td class=3D"line-content=
">                            title: `Slide ${idx + 1}`,</td></tr><tr><td c=
lass=3D"line-number" value=3D"1651"></td><td class=3D"line-content">       =
                     content: block.trim().substring(0, 500),</td></tr><tr>=
<td class=3D"line-number" value=3D"1652"></td><td class=3D"line-content">  =
                          tabs: { primary: { label: 'Primary', content: '' =
}, intel: { label: 'Intel', content: '' } }</td></tr><tr><td class=3D"line-=
number" value=3D"1653"></td><td class=3D"line-content">                    =
    };</td></tr><tr><td class=3D"line-number" value=3D"1654"></td><td class=
=3D"line-content">                        slides.push(slide);</td></tr><tr>=
<td class=3D"line-number" value=3D"1655"></td><td class=3D"line-content">  =
                  });</td></tr><tr><td class=3D"line-number" value=3D"1656"=
></td><td class=3D"line-content">                }</td></tr><tr><td class=
=3D"line-number" value=3D"1657"></td><td class=3D"line-content">           =
 }</td></tr><tr><td class=3D"line-number" value=3D"1658"></td><td class=3D"=
line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1659"></=
td><td class=3D"line-content">            if (slides.length &gt; 0) {</td><=
/tr><tr><td class=3D"line-number" value=3D"1660"></td><td class=3D"line-con=
tent">                accumulatedData.slides =3D slides;</td></tr><tr><td c=
lass=3D"line-number" value=3D"1661"></td><td class=3D"line-content">       =
         log(`Successfully extracted ${slides.length} slides from narrative=
.`, 'success');</td></tr><tr><td class=3D"line-number" value=3D"1662"></td>=
<td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" valu=
e=3D"1663"></td><td class=3D"line-content">                // Update phase =
badge</td></tr><tr><td class=3D"line-number" value=3D"1664"></td><td class=
=3D"line-content">                updatePhaseBadge('narrative', `${slides.l=
ength} slides`);</td></tr><tr><td class=3D"line-number" value=3D"1665"></td=
><td class=3D"line-content">            }</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1666"></td><td class=3D"line-content"><br></td></tr><tr><td =
class=3D"line-number" value=3D"1667"></td><td class=3D"line-content">      =
      // 3. Extract Glossary if present</td></tr><tr><td class=3D"line-numb=
er" value=3D"1668"></td><td class=3D"line-content">            const glossa=
ryMatch =3D text.match(/INTELLIGENCE GLOSSARY:\s*([\s\S]*)$/i);</td></tr><t=
r><td class=3D"line-number" value=3D"1669"></td><td class=3D"line-content">=
            if (glossaryMatch) {</td></tr><tr><td class=3D"line-number" val=
ue=3D"1670"></td><td class=3D"line-content">                const items =3D=
 [];</td></tr><tr><td class=3D"line-number" value=3D"1671"></td><td class=
=3D"line-content">                const lines =3D glossaryMatch[1].split('\=
n');</td></tr><tr><td class=3D"line-number" value=3D"1672"></td><td class=
=3D"line-content">                lines.forEach(line =3D&gt; {</td></tr><tr=
><td class=3D"line-number" value=3D"1673"></td><td class=3D"line-content"> =
                   const m =3D line.match(/^(.*?):\s*(.*)/);</td></tr><tr><=
td class=3D"line-number" value=3D"1674"></td><td class=3D"line-content">   =
                 if (m) {</td></tr><tr><td class=3D"line-number" value=3D"1=
675"></td><td class=3D"line-content">                        items.push({ t=
erm: m[1].trim(), definition: m[2].trim() });</td></tr><tr><td class=3D"lin=
e-number" value=3D"1676"></td><td class=3D"line-content">                  =
  }</td></tr><tr><td class=3D"line-number" value=3D"1677"></td><td class=3D=
"line-content">                });</td></tr><tr><td class=3D"line-number" v=
alue=3D"1678"></td><td class=3D"line-content">                if (items.len=
gth &gt; 0) {</td></tr><tr><td class=3D"line-number" value=3D"1679"></td><t=
d class=3D"line-content">                    accumulatedData.intelligenceGl=
ossary =3D items;</td></tr><tr><td class=3D"line-number" value=3D"1680"></t=
d><td class=3D"line-content">                    log(`Extracted ${items.len=
gth} glossary terms.`, 'success');</td></tr><tr><td class=3D"line-number" v=
alue=3D"1681"></td><td class=3D"line-content">                }</td></tr><t=
r><td class=3D"line-number" value=3D"1682"></td><td class=3D"line-content">=
            }</td></tr><tr><td class=3D"line-number" value=3D"1683"></td><t=
d class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" v=
alue=3D"1684"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"1685"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"1686"></td><td class=3D"line-cont=
ent">        function sanitizeForBirth(data) {</td></tr><tr><td class=3D"li=
ne-number" value=3D"1687"></td><td class=3D"line-content">            // Cr=
eate a deep copy and strip base64 image data, keeping only R2 URLs</td></tr=
><tr><td class=3D"line-number" value=3D"1688"></td><td class=3D"line-conten=
t">            const sanitized =3D JSON.parse(JSON.stringify(data));</td></=
tr><tr><td class=3D"line-number" value=3D"1689"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"1690"></td><td cl=
ass=3D"line-content">            // Helper to check if a string is a base64=
 data URI</td></tr><tr><td class=3D"line-number" value=3D"1691"></td><td cl=
ass=3D"line-content">            const isBase64 =3D (str) =3D&gt; {</td></t=
r><tr><td class=3D"line-number" value=3D"1692"></td><td class=3D"line-conte=
nt">                return typeof str =3D=3D=3D 'string' &amp;&amp; str.sta=
rtsWith('data:image');</td></tr><tr><td class=3D"line-number" value=3D"1693=
"></td><td class=3D"line-content">            };</td></tr><tr><td class=3D"=
line-number" value=3D"1694"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"1695"></td><td class=3D"line-content"=
>            // Helper to filter image URLs (only keep R2/HTTP URLs, remove=
 base64)</td></tr><tr><td class=3D"line-number" value=3D"1696"></td><td cla=
ss=3D"line-content">            const filterImageUrl =3D (url) =3D&gt; {</t=
d></tr><tr><td class=3D"line-number" value=3D"1697"></td><td class=3D"line-=
content">                if (!url) return '';</td></tr><tr><td class=3D"lin=
e-number" value=3D"1698"></td><td class=3D"line-content">                if=
 (isBase64(url)) return ''; // Strip base64</td></tr><tr><td class=3D"line-=
number" value=3D"1699"></td><td class=3D"line-content">                retu=
rn url; // Keep R2/HTTP URLs</td></tr><tr><td class=3D"line-number" value=
=3D"1700"></td><td class=3D"line-content">            };</td></tr><tr><td c=
lass=3D"line-number" value=3D"1701"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"1702"></td><td class=3D"line-=
content">            // Sanitize metadata</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1703"></td><td class=3D"line-content">            if (saniti=
zed.metadata) {</td></tr><tr><td class=3D"line-number" value=3D"1704"></td>=
<td class=3D"line-content">                sanitized.metadata.heroImage =3D=
 filterImageUrl(sanitized.metadata.heroImage);</td></tr><tr><td class=3D"li=
ne-number" value=3D"1705"></td><td class=3D"line-content">            }</td=
></tr><tr><td class=3D"line-number" value=3D"1706"></td><td class=3D"line-c=
ontent"><br></td></tr><tr><td class=3D"line-number" value=3D"1707"></td><td=
 class=3D"line-content">            // Sanitize slides</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1708"></td><td class=3D"line-content">         =
   if (Array.isArray(sanitized.slides)) {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1709"></td><td class=3D"line-content">                saniti=
zed.slides.forEach(slide =3D&gt; {</td></tr><tr><td class=3D"line-number" v=
alue=3D"1710"></td><td class=3D"line-content">                    // Filter=
 slide-level images</td></tr><tr><td class=3D"line-number" value=3D"1711"><=
/td><td class=3D"line-content">                    slide.image =3D filterIm=
ageUrl(slide.image);</td></tr><tr><td class=3D"line-number" value=3D"1712">=
</td><td class=3D"line-content">                    slide.mediaURL =3D filt=
erImageUrl(slide.mediaURL);</td></tr><tr><td class=3D"line-number" value=3D=
"1713"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-=
number" value=3D"1714"></td><td class=3D"line-content">                    =
// Filter tab images</td></tr><tr><td class=3D"line-number" value=3D"1715">=
</td><td class=3D"line-content">                    if (slide.tabs) {</td><=
/tr><tr><td class=3D"line-number" value=3D"1716"></td><td class=3D"line-con=
tent">                        Object.keys(slide.tabs).forEach(tabKey =3D&gt=
; {</td></tr><tr><td class=3D"line-number" value=3D"1717"></td><td class=3D=
"line-content">                            const tab =3D slide.tabs[tabKey]=
;</td></tr><tr><td class=3D"line-number" value=3D"1718"></td><td class=3D"l=
ine-content">                            if (tab &amp;&amp; tab.image) {</t=
d></tr><tr><td class=3D"line-number" value=3D"1719"></td><td class=3D"line-=
content">                                tab.image =3D filterImageUrl(tab.i=
mage);</td></tr><tr><td class=3D"line-number" value=3D"1720"></td><td class=
=3D"line-content">                            }</td></tr><tr><td class=3D"l=
ine-number" value=3D"1721"></td><td class=3D"line-content">                =
        });</td></tr><tr><td class=3D"line-number" value=3D"1722"></td><td =
class=3D"line-content">                    }</td></tr><tr><td class=3D"line=
-number" value=3D"1723"></td><td class=3D"line-content">                });=
</td></tr><tr><td class=3D"line-number" value=3D"1724"></td><td class=3D"li=
ne-content">            }</td></tr><tr><td class=3D"line-number" value=3D"1=
725"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-nu=
mber" value=3D"1726"></td><td class=3D"line-content">            return san=
itized;</td></tr><tr><td class=3D"line-number" value=3D"1727"></td><td clas=
s=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=
=3D"1728"></td><td class=3D"line-content">        function updatePhaseBadge=
(phaseId, badgeText) {</td></tr><tr><td class=3D"line-number" value=3D"1729=
"></td><td class=3D"line-content">            // Simplified: Re-render the =
stepper which now supports badges</td></tr><tr><td class=3D"line-number" va=
lue=3D"1730"></td><td class=3D"line-content">            renderPipelineStep=
per();</td></tr><tr><td class=3D"line-number" value=3D"1731"></td><td class=
=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=3D=
"1732"></td><td class=3D"line-content">        // --- MISSION SURGERY HELPE=
RS ---</td></tr><tr><td class=3D"line-number" value=3D"1733"></td><td class=
=3D"line-content">        function setNested(obj, path, value) {</td></tr><=
tr><td class=3D"line-number" value=3D"1734"></td><td class=3D"line-content"=
>            const parts =3D path.split('.');</td></tr><tr><td class=3D"lin=
e-number" value=3D"1735"></td><td class=3D"line-content">            let cu=
rrent =3D obj;</td></tr><tr><td class=3D"line-number" value=3D"1736"></td><=
td class=3D"line-content">            for (let i =3D 0; i &lt; parts.length=
 - 1; i++) {</td></tr><tr><td class=3D"line-number" value=3D"1737"></td><td=
 class=3D"line-content">                if (!current[parts[i]]) current[par=
ts[i]] =3D {};</td></tr><tr><td class=3D"line-number" value=3D"1738"></td><=
td class=3D"line-content">                current =3D current[parts[i]];</t=
d></tr><tr><td class=3D"line-number" value=3D"1739"></td><td class=3D"line-=
content">            }</td></tr><tr><td class=3D"line-number" value=3D"1740=
"></td><td class=3D"line-content">            current[parts[parts.length - =
1]] =3D value;</td></tr><tr><td class=3D"line-number" value=3D"1741"></td><=
td class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" =
value=3D"1742"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"1743"></td><td class=3D"line-content">        fun=
ction formatText(text) {</td></tr><tr><td class=3D"line-number" value=3D"17=
44"></td><td class=3D"line-content">            if (!text) return "";</td><=
/tr><tr><td class=3D"line-number" value=3D"1745"></td><td class=3D"line-con=
tent">            return text</td></tr><tr><td class=3D"line-number" value=
=3D"1746"></td><td class=3D"line-content">                .replace(/(?:http=
s?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?v=3D|youtu\.be\/)([a-zA-Z0-9_-]{=
11})/g,</td></tr><tr><td class=3D"line-number" value=3D"1747"></td><td clas=
s=3D"line-content">                    '&lt;div class=3D"video-container" s=
tyle=3D"position:relative; padding-bottom:56.25%; height:0; overflow:hidden=
; margin:10px 0;"&gt;&lt;iframe style=3D"position:absolute; top:0; left:0; =
width:100%; height:100%; border:0;" src=3D"https://www.youtube.com/embed/$1=
" allow=3D"accelerometer; autoplay; clipboard-write; encrypted-media; gyros=
cope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;&lt;/div&gt;')<=
/td></tr><tr><td class=3D"line-number" value=3D"1748"></td><td class=3D"lin=
e-content">                .replace(/(https?:\/\/.*\.pdf)/gi,</td></tr><tr>=
<td class=3D"line-number" value=3D"1749"></td><td class=3D"line-content">  =
                  '&lt;div class=3D"pdf-container" style=3D"height:300px; m=
argin:10px 0;"&gt;&lt;embed src=3D"$1" type=3D"application/pdf" width=3D"10=
0%" height=3D"100%"&gt;&lt;/div&gt;')</td></tr><tr><td class=3D"line-number=
" value=3D"1750"></td><td class=3D"line-content">                .replace(/=
(https?:\/\/.*\.(?:mp4|avi|mov|webm))/gi,</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1751"></td><td class=3D"line-content">                    '&=
lt;video controls style=3D"width:100%; max-height:300px; background:#000; m=
argin:10px 0;"&gt;&lt;source src=3D"$1"&gt;Video not supported.&lt;/video&g=
t;')</td></tr><tr><td class=3D"line-number" value=3D"1752"></td><td class=
=3D"line-content">                .replace(/\n/g, '&lt;br&gt;');</td></tr><=
tr><td class=3D"line-number" value=3D"1753"></td><td class=3D"line-content"=
>        }</td></tr><tr><td class=3D"line-number" value=3D"1754"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
1755"></td><td class=3D"line-content">        async function callAI(prompt)=
 {</td></tr><tr><td class=3D"line-number" value=3D"1756"></td><td class=3D"=
line-content">            // Priority 0: HARDWIRED Vercel Proxy</td></tr><t=
r><td class=3D"line-number" value=3D"1757"></td><td class=3D"line-content">=
            const selectedModel =3D document.getElementById('f-model')?.val=
ue || 'xiaomi/mimo-v2-flash:free';</td></tr><tr><td class=3D"line-number" v=
alue=3D"1758"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"1759"></td><td class=3D"line-content">           =
 console.log("callAI: Connecting via Vercel Proxy...", HARDWIRED_PROXY);</t=
d></tr><tr><td class=3D"line-number" value=3D"1760"></td><td class=3D"line-=
content">            console.log("callAI: Selected Model:", selectedModel);=
</td></tr><tr><td class=3D"line-number" value=3D"1761"></td><td class=3D"li=
ne-content">            log(`AI Uplink: Proxy [${selectedModel}]`, "info");=
</td></tr><tr><td class=3D"line-number" value=3D"1762"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1763"></td=
><td class=3D"line-content">            try {</td></tr><tr><td class=3D"lin=
e-number" value=3D"1764"></td><td class=3D"line-content">                co=
nst res =3D await fetch(HARDWIRED_PROXY, {</td></tr><tr><td class=3D"line-n=
umber" value=3D"1765"></td><td class=3D"line-content">                    m=
ethod: 'POST',</td></tr><tr><td class=3D"line-number" value=3D"1766"></td><=
td class=3D"line-content">                    headers: { 'Content-Type': 'a=
pplication/json' },</td></tr><tr><td class=3D"line-number" value=3D"1767"><=
/td><td class=3D"line-content">                    body: JSON.stringify({</=
td></tr><tr><td class=3D"line-number" value=3D"1768"></td><td class=3D"line=
-content">                        message: prompt,</td></tr><tr><td class=
=3D"line-number" value=3D"1769"></td><td class=3D"line-content">           =
             model: selectedModel</td></tr><tr><td class=3D"line-number" va=
lue=3D"1770"></td><td class=3D"line-content">                    })</td></t=
r><tr><td class=3D"line-number" value=3D"1771"></td><td class=3D"line-conte=
nt">                });</td></tr><tr><td class=3D"line-number" value=3D"177=
2"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"1773"></td><td class=3D"line-content">                console.=
log("callAI: Response status:", res.status);</td></tr><tr><td class=3D"line=
-number" value=3D"1774"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"1775"></td><td class=3D"line-content">   =
             if (!res.ok) {</td></tr><tr><td class=3D"line-number" value=3D=
"1776"></td><td class=3D"line-content">                    throw new Error(=
`HTTP ${res.status}: ${res.statusText}`);</td></tr><tr><td class=3D"line-nu=
mber" value=3D"1777"></td><td class=3D"line-content">                }</td>=
</tr><tr><td class=3D"line-number" value=3D"1778"></td><td class=3D"line-co=
ntent"><br></td></tr><tr><td class=3D"line-number" value=3D"1779"></td><td =
class=3D"line-content">                const data =3D await res.json();</td=
></tr><tr><td class=3D"line-number" value=3D"1780"></td><td class=3D"line-c=
ontent">                console.log("callAI: Vercel Response (raw):", JSON.=
stringify(data).substring(0, 500));</td></tr><tr><td class=3D"line-number" =
value=3D"1781"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"1782"></td><td class=3D"line-content">           =
     // OpenRouter/OpenAI format: { choices: [{ message: { content: "..." }=
 }] }</td></tr><tr><td class=3D"line-number" value=3D"1783"></td><td class=
=3D"line-content">                if (data.choices &amp;&amp; data.choices[=
0]?.message?.content) {</td></tr><tr><td class=3D"line-number" value=3D"178=
4"></td><td class=3D"line-content">                    const text =3D data.=
choices[0].message.content;</td></tr><tr><td class=3D"line-number" value=3D=
"1785"></td><td class=3D"line-content">                    log("Proxy Intel=
 Acquired.", "success");</td></tr><tr><td class=3D"line-number" value=3D"17=
86"></td><td class=3D"line-content">                    return text;</td></=
tr><tr><td class=3D"line-number" value=3D"1787"></td><td class=3D"line-cont=
ent">                }</td></tr><tr><td class=3D"line-number" value=3D"1788=
"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numbe=
r" value=3D"1789"></td><td class=3D"line-content">                // Direct=
 message format: { message: "..." }</td></tr><tr><td class=3D"line-number" =
value=3D"1790"></td><td class=3D"line-content">                if (data.mes=
sage &amp;&amp; typeof data.message =3D=3D=3D 'string') {</td></tr><tr><td =
class=3D"line-number" value=3D"1791"></td><td class=3D"line-content">      =
              log("Proxy Intel Acquired (direct).", "success");</td></tr><t=
r><td class=3D"line-number" value=3D"1792"></td><td class=3D"line-content">=
                    return data.message;</td></tr><tr><td class=3D"line-num=
ber" value=3D"1793"></td><td class=3D"line-content">                }</td><=
/tr><tr><td class=3D"line-number" value=3D"1794"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"1795"></td><td c=
lass=3D"line-content">                // Direct content format: { content: =
"..." }</td></tr><tr><td class=3D"line-number" value=3D"1796"></td><td clas=
s=3D"line-content">                if (data.content &amp;&amp; typeof data.=
content =3D=3D=3D 'string') {</td></tr><tr><td class=3D"line-number" value=
=3D"1797"></td><td class=3D"line-content">                    log("Proxy In=
tel Acquired (content).", "success");</td></tr><tr><td class=3D"line-number=
" value=3D"1798"></td><td class=3D"line-content">                    return=
 data.content;</td></tr><tr><td class=3D"line-number" value=3D"1799"></td><=
td class=3D"line-content">                }</td></tr><tr><td class=3D"line-=
number" value=3D"1800"></td><td class=3D"line-content"><br></td></tr><tr><t=
d class=3D"line-number" value=3D"1801"></td><td class=3D"line-content">    =
            // Direct text format: { text: "..." }</td></tr><tr><td class=
=3D"line-number" value=3D"1802"></td><td class=3D"line-content">           =
     if (data.text &amp;&amp; typeof data.text =3D=3D=3D 'string') {</td></=
tr><tr><td class=3D"line-number" value=3D"1803"></td><td class=3D"line-cont=
ent">                    log("Proxy Intel Acquired (text).", "success");</t=
d></tr><tr><td class=3D"line-number" value=3D"1804"></td><td class=3D"line-=
content">                    return data.text;</td></tr><tr><td class=3D"li=
ne-number" value=3D"1805"></td><td class=3D"line-content">                }=
</td></tr><tr><td class=3D"line-number" value=3D"1806"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1807"></td=
><td class=3D"line-content">                // If there's an error field, r=
eport it</td></tr><tr><td class=3D"line-number" value=3D"1808"></td><td cla=
ss=3D"line-content">                if (data.error) {</td></tr><tr><td clas=
s=3D"line-number" value=3D"1809"></td><td class=3D"line-content">          =
          throw new Error(`Proxy error: ${JSON.stringify(data.error)}`);</t=
d></tr><tr><td class=3D"line-number" value=3D"1810"></td><td class=3D"line-=
content">                }</td></tr><tr><td class=3D"line-number" value=3D"=
1811"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-n=
umber" value=3D"1812"></td><td class=3D"line-content">                conso=
le.error("callAI: Unrecognized response format:", data);</td></tr><tr><td c=
lass=3D"line-number" value=3D"1813"></td><td class=3D"line-content">       =
         throw new Error("Proxy response format invalid. Check console for =
details.");</td></tr><tr><td class=3D"line-number" value=3D"1814"></td><td =
class=3D"line-content">            } catch (e) {</td></tr><tr><td class=3D"=
line-number" value=3D"1815"></td><td class=3D"line-content">               =
 console.error("callAI: Vercel Proxy Error:", e);</td></tr><tr><td class=3D=
"line-number" value=3D"1816"></td><td class=3D"line-content">              =
  log(`Proxy Error: ${e.message}. Falling back to GCP.`, "warning");</td></=
tr><tr><td class=3D"line-number" value=3D"1817"></td><td class=3D"line-cont=
ent">            }</td></tr><tr><td class=3D"line-number" value=3D"1818"></=
td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" v=
alue=3D"1819"></td><td class=3D"line-content">            // Priority 1: Go=
ogle Cloud Direct (via Config or LocalStorage)</td></tr><tr><td class=3D"li=
ne-number" value=3D"1820"></td><td class=3D"line-content">            const=
 gcpKey =3D localStorage.getItem('TM_GCP_KEY') || (typeof CONFIG !=3D=3D 'u=
ndefined' ? CONFIG.GCP_KEY : '');</td></tr><tr><td class=3D"line-number" va=
lue=3D"1821"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D=
"line-number" value=3D"1822"></td><td class=3D"line-content">            co=
nsole.log("callAI: Checking GCP Key...", gcpKey ? `Key found (${gcpKey.subs=
tring(0, 8)}...)` : "NO KEY");</td></tr><tr><td class=3D"line-number" value=
=3D"1823"></td><td class=3D"line-content">            log(`AI Uplink: ${gcp=
Key ? 'GCP Key detected' : 'Proxy offline/missing - using backup'}`, gcpKey=
 ? 'info' : 'warning');</td></tr><tr><td class=3D"line-number" value=3D"182=
4"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"1825"></td><td class=3D"line-content">            if (gcpKey) =
{</td></tr><tr><td class=3D"line-number" value=3D"1826"></td><td class=3D"l=
ine-content">                // Gemini API Path</td></tr><tr><td class=3D"l=
ine-number" value=3D"1827"></td><td class=3D"line-content">                =
const model =3D localStorage.getItem('TM_GCP_MODEL') || "gemini-1.5-flash";=
</td></tr><tr><td class=3D"line-number" value=3D"1828"></td><td class=3D"li=
ne-content">                const url =3D `https://generativelanguage.googl=
eapis.com/v1beta/models/${model}:generateContent?key=3D${gcpKey}`;</td></tr=
><tr><td class=3D"line-number" value=3D"1829"></td><td class=3D"line-conten=
t">                console.log("callAI: Sending request to", model);</td></=
tr><tr><td class=3D"line-number" value=3D"1830"></td><td class=3D"line-cont=
ent">                log(`AI Request =E2=86=92 ${model}...`);</td></tr><tr>=
<td class=3D"line-number" value=3D"1831"></td><td class=3D"line-content"><b=
r></td></tr><tr><td class=3D"line-number" value=3D"1832"></td><td class=3D"=
line-content">                try {</td></tr><tr><td class=3D"line-number" =
value=3D"1833"></td><td class=3D"line-content">                    const re=
s =3D await fetch(url, {</td></tr><tr><td class=3D"line-number" value=3D"18=
34"></td><td class=3D"line-content">                        method: 'POST',=
</td></tr><tr><td class=3D"line-number" value=3D"1835"></td><td class=3D"li=
ne-content">                        headers: { 'Content-Type': 'application=
/json' },</td></tr><tr><td class=3D"line-number" value=3D"1836"></td><td cl=
ass=3D"line-content">                        body: JSON.stringify({ content=
s: [{ parts: [{ text: prompt }] }] })</td></tr><tr><td class=3D"line-number=
" value=3D"1837"></td><td class=3D"line-content">                    });</t=
d></tr><tr><td class=3D"line-number" value=3D"1838"></td><td class=3D"line-=
content">                    const data =3D await res.json();</td></tr><tr>=
<td class=3D"line-number" value=3D"1839"></td><td class=3D"line-content">  =
                  console.log("callAI: Raw API Response:", data);</td></tr>=
<tr><td class=3D"line-number" value=3D"1840"></td><td class=3D"line-content=
"><br></td></tr><tr><td class=3D"line-number" value=3D"1841"></td><td class=
=3D"line-content">                    if (data.candidates &amp;&amp; data.c=
andidates[0]) {</td></tr><tr><td class=3D"line-number" value=3D"1842"></td>=
<td class=3D"line-content">                        const text =3D data.cand=
idates[0].content.parts[0].text;</td></tr><tr><td class=3D"line-number" val=
ue=3D"1843"></td><td class=3D"line-content">                        console=
.log("callAI: SUCCESS - Response length:", text.length);</td></tr><tr><td c=
lass=3D"line-number" value=3D"1844"></td><td class=3D"line-content">       =
                 log(`AI Response: ${text.substring(0, 50)}...`, "success")=
;</td></tr><tr><td class=3D"line-number" value=3D"1845"></td><td class=3D"l=
ine-content">                        return text;</td></tr><tr><td class=3D=
"line-number" value=3D"1846"></td><td class=3D"line-content">              =
      }</td></tr><tr><td class=3D"line-number" value=3D"1847"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"184=
8"></td><td class=3D"line-content">                    // Handle specific e=
rror cases</td></tr><tr><td class=3D"line-number" value=3D"1849"></td><td c=
lass=3D"line-content">                    const errMsg =3D data.error?.mess=
age || JSON.stringify(data);</td></tr><tr><td class=3D"line-number" value=
=3D"1850"></td><td class=3D"line-content">                    console.error=
("callAI: API Error:", errMsg);</td></tr><tr><td class=3D"line-number" valu=
e=3D"1851"></td><td class=3D"line-content">                    log(`API Err=
or: ${errMsg}`, "error");</td></tr><tr><td class=3D"line-number" value=3D"1=
852"></td><td class=3D"line-content">                    throw new Error(er=
rMsg);</td></tr><tr><td class=3D"line-number" value=3D"1853"></td><td class=
=3D"line-content">                } catch (e) {</td></tr><tr><td class=3D"l=
ine-number" value=3D"1854"></td><td class=3D"line-content">                =
    console.error("callAI: Fetch failed:", e);</td></tr><tr><td class=3D"li=
ne-number" value=3D"1855"></td><td class=3D"line-content">                 =
   log(`AI Error: ${e.message}. Falling back to Simulation.`, "warning");</=
td></tr><tr><td class=3D"line-number" value=3D"1856"></td><td class=3D"line=
-content">                }</td></tr><tr><td class=3D"line-number" value=3D=
"1857"></td><td class=3D"line-content">            }</td></tr><tr><td class=
=3D"line-number" value=3D"1858"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"1859"></td><td class=3D"line-cont=
ent">            // Fallback: Smart Simulation (for UI testing or offline)<=
/td></tr><tr><td class=3D"line-number" value=3D"1860"></td><td class=3D"lin=
e-content">            console.log("callAI: Using SIMULATION mode");</td></=
tr><tr><td class=3D"line-number" value=3D"1861"></td><td class=3D"line-cont=
ent">            log("Simulation Mode Active - No Uplink Detected", "warnin=
g");</td></tr><tr><td class=3D"line-number" value=3D"1862"></td><td class=
=3D"line-content">            await new Promise(r =3D&gt; setTimeout(r, 100=
0));</td></tr><tr><td class=3D"line-number" value=3D"1863"></td><td class=
=3D"line-content">            const simResponses =3D [</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1864"></td><td class=3D"line-content">         =
       "**Simulation Mode Active.** \n\nI have analyzed your request. Based=
 on standard curriculum parameters, I propose focusing on a scenario that e=
mphasizes **Critical Decision Making** under pressure. \n\n*System Note: To=
 generate specific content aligned with your custom input, please ensure th=
e Neural Link (Proxy) is active.*",</td></tr><tr><td class=3D"line-number" =
value=3D"1865"></td><td class=3D"line-content">                "**Narrative=
 taking shape!** \nI'm drafting a slide sequence for your mission: \n1. **T=
he Situation**: Students receive an urgent briefing. \n2. **Key Perspective=
s**: Multiple stakeholders present their views. \n3. **The Decision Point**=
: Students must weigh trade-offs and choose a path forward.",</td></tr><tr>=
<td class=3D"line-number" value=3D"1866"></td><td class=3D"line-content">  =
              "**Visual concepts ready!** \nI've drafted some image prompts=
 that should work well with this lesson. Would you like to review and adjus=
t the visual style?"</td></tr><tr><td class=3D"line-number" value=3D"1867">=
</td><td class=3D"line-content">            ];</td></tr><tr><td class=3D"li=
ne-number" value=3D"1868"></td><td class=3D"line-content">            retur=
n simResponses[currentPhaseIndex % simResponses.length] || "Ready to help, =
Teacher. What would you like to explore?";</td></tr><tr><td class=3D"line-n=
umber" value=3D"1869"></td><td class=3D"line-content">        }</td></tr><t=
r><td class=3D"line-number" value=3D"1870"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"1871"></td><td class=
=3D"line-content">        function advancePhase() {</td></tr><tr><td class=
=3D"line-number" value=3D"1872"></td><td class=3D"line-content">           =
 const currentPhase =3D getCurrentPhase();</td></tr><tr><td class=3D"line-n=
umber" value=3D"1873"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"1874"></td><td class=3D"line-content">     =
       if (currentPhaseIndex &gt;=3D BuilderPipeline.length - 1) {</td></tr=
><tr><td class=3D"line-number" value=3D"1875"></td><td class=3D"line-conten=
t">                alert('You are already at the final phase (Deploy).');</=
td></tr><tr><td class=3D"line-number" value=3D"1876"></td><td class=3D"line=
-content">                return;</td></tr><tr><td class=3D"line-number" va=
lue=3D"1877"></td><td class=3D"line-content">            }</td></tr><tr><td=
 class=3D"line-number" value=3D"1878"></td><td class=3D"line-content"><br><=
/td></tr><tr><td class=3D"line-number" value=3D"1879"></td><td class=3D"lin=
e-content">            // Special validation for narrative =E2=86=92 assets=
 transition</td></tr><tr><td class=3D"line-number" value=3D"1880"></td><td =
class=3D"line-content">            if (currentPhase.id =3D=3D=3D 'narrative=
') {</td></tr><tr><td class=3D"line-number" value=3D"1881"></td><td class=
=3D"line-content">                const slideCount =3D accumulatedData?.sli=
des?.length || 0;</td></tr><tr><td class=3D"line-number" value=3D"1882"></t=
d><td class=3D"line-content">                if (slideCount &lt; 10) {</td>=
</tr><tr><td class=3D"line-number" value=3D"1883"></td><td class=3D"line-co=
ntent">                    const proceed =3D confirm(`Only ${slideCount}/10=
 slides detected. Proceeding to Assets may result in missing content. Conti=
nue anyway?`);</td></tr><tr><td class=3D"line-number" value=3D"1884"></td><=
td class=3D"line-content">                    if (!proceed) return;</td></t=
r><tr><td class=3D"line-number" value=3D"1885"></td><td class=3D"line-conte=
nt">                }</td></tr><tr><td class=3D"line-number" value=3D"1886"=
></td><td class=3D"line-content">            }</td></tr><tr><td class=3D"li=
ne-number" value=3D"1887"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"1888"></td><td class=3D"line-content"> =
           // Special validation for assets =E2=86=92 deploy transition</td=
></tr><tr><td class=3D"line-number" value=3D"1889"></td><td class=3D"line-c=
ontent">            if (currentPhase.id =3D=3D=3D 'assets') {</td></tr><tr>=
<td class=3D"line-number" value=3D"1890"></td><td class=3D"line-content">  =
              let imgCount =3D 0;</td></tr><tr><td class=3D"line-number" va=
lue=3D"1891"></td><td class=3D"line-content">                (accumulatedDa=
ta.slides || []).forEach(s =3D&gt; {</td></tr><tr><td class=3D"line-number"=
 value=3D"1892"></td><td class=3D"line-content">                    if (s.i=
mage || s.tabs?.primary?.image) imgCount++;</td></tr><tr><td class=3D"line-=
number" value=3D"1893"></td><td class=3D"line-content">                });<=
/td></tr><tr><td class=3D"line-number" value=3D"1894"></td><td class=3D"lin=
e-content">                if (imgCount &lt; 5) {</td></tr><tr><td class=3D=
"line-number" value=3D"1895"></td><td class=3D"line-content">              =
      const proceed =3D confirm(`Only ${imgCount} visual assets archived. P=
roceeding to Birth may result in incomplete data. Continue?`);</td></tr><tr=
><td class=3D"line-number" value=3D"1896"></td><td class=3D"line-content"> =
                   if (!proceed) return;</td></tr><tr><td class=3D"line-num=
ber" value=3D"1897"></td><td class=3D"line-content">                }</td><=
/tr><tr><td class=3D"line-number" value=3D"1898"></td><td class=3D"line-con=
tent">            }</td></tr><tr><td class=3D"line-number" value=3D"1899"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"1900"></td><td class=3D"line-content">            // Create a smal=
l "system event" in chat</td></tr><tr><td class=3D"line-number" value=3D"19=
01"></td><td class=3D"line-content">            const chat =3D document.get=
ElementById('Builder-chat');</td></tr><tr><td class=3D"line-number" value=
=3D"1902"></td><td class=3D"line-content">            if (chat) {</td></tr>=
<tr><td class=3D"line-number" value=3D"1903"></td><td class=3D"line-content=
">                chat.insertAdjacentHTML('beforeend', `</td></tr><tr><td c=
lass=3D"line-number" value=3D"1904"></td><td class=3D"line-content">       =
             &lt;div class=3D"divider text-primary text-xs font-mono my-4"&=
gt;PHASE COMPLETE&lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"1905"></td><td class=3D"line-content">                `);</td></tr><tr>=
<td class=3D"line-number" value=3D"1906"></td><td class=3D"line-content">  =
          }</td></tr><tr><td class=3D"line-number" value=3D"1907"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"1908"></td><td class=3D"line-content">            currentPhaseIndex++;</td=
></tr><tr><td class=3D"line-number" value=3D"1909"></td><td class=3D"line-c=
ontent">            updateBuilderUI();</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1910"></td><td class=3D"line-content">            log(`Phase ad=
vanced to: ${getCurrentPhase().label}`, 'success');</td></tr><tr><td class=
=3D"line-number" value=3D"1911"></td><td class=3D"line-content">        }</=
td></tr><tr><td class=3D"line-number" value=3D"1912"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1913"></td><=
td class=3D"line-content">        function BuilderBack() {</td></tr><tr><td=
 class=3D"line-number" value=3D"1914"></td><td class=3D"line-content">     =
       if (currentPhaseIndex &gt; 0) {</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1915"></td><td class=3D"line-content">                currentPh=
aseIndex--;</td></tr><tr><td class=3D"line-number" value=3D"1916"></td><td =
class=3D"line-content">                updateBuilderUI();</td></tr><tr><td =
class=3D"line-number" value=3D"1917"></td><td class=3D"line-content">      =
          addBuilderChat("ai", `Reverting to ${getCurrentPhase().label}. Co=
mmand parameters preserved.`);</td></tr><tr><td class=3D"line-number" value=
=3D"1918"></td><td class=3D"line-content">                log(`Builder reve=
rted to: ${getCurrentPhase().label}`, 'warning');</td></tr><tr><td class=3D=
"line-number" value=3D"1919"></td><td class=3D"line-content">            }<=
/td></tr><tr><td class=3D"line-number" value=3D"1920"></td><td class=3D"lin=
e-content">        }</td></tr><tr><td class=3D"line-number" value=3D"1921">=
</td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number"=
 value=3D"1922"></td><td class=3D"line-content">        // --- MEDIA SCREEN=
 PROMPT EXTRACTION (Restored) ---</td></tr><tr><td class=3D"line-number" va=
lue=3D"1923"></td><td class=3D"line-content">        function extractAIProm=
ptsFromHistory() {</td></tr><tr><td class=3D"line-number" value=3D"1924"></=
td><td class=3D"line-content">            // Look for AI response containin=
g markdown table with prompts</td></tr><tr><td class=3D"line-number" value=
=3D"1925"></td><td class=3D"line-content">            const assistantMsgs =
=3D BuilderHistory.filter(m =3D&gt; m.role =3D=3D=3D 'assistant');</td></tr=
><tr><td class=3D"line-number" value=3D"1926"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"1927"></td><td clas=
s=3D"line-content">            for (const msg of assistantMsgs.reverse()) {=
 // Start from most recent</td></tr><tr><td class=3D"line-number" value=3D"=
1928"></td><td class=3D"line-content">                const content =3D msg=
.content;</td></tr><tr><td class=3D"line-number" value=3D"1929"></td><td cl=
ass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1=
930"></td><td class=3D"line-content">                // Try to find markdow=
n table rows - support both 4-column and 6-column formats</td></tr><tr><td =
class=3D"line-number" value=3D"1931"></td><td class=3D"line-content">      =
          const tableRows4 =3D content.match(/\|[^|\n]+\|[^|\n]+\|[^|\n]+\|=
[^|\n]+\|/g);</td></tr><tr><td class=3D"line-number" value=3D"1932"></td><t=
d class=3D"line-content">                const tableRows6 =3D content.match=
(/\|[^|\n]+\|[^|\n]+\|[^|\n]+\|[^|\n]+\|[^|\n]+\|[^|\n]*\|/g);</td></tr><tr=
><td class=3D"line-number" value=3D"1933"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"1934"></td><td class=3D=
"line-content">                const tableRows =3D tableRows6 || tableRows4=
;</td></tr><tr><td class=3D"line-number" value=3D"1935"></td><td class=3D"l=
ine-content">                const is6Column =3D !!tableRows6;</td></tr><tr=
><td class=3D"line-number" value=3D"1936"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"1937"></td><td class=3D=
"line-content">                if (tableRows &amp;&amp; tableRows.length &g=
t; 1) {</td></tr><tr><td class=3D"line-number" value=3D"1938"></td><td clas=
s=3D"line-content">                    const prompts =3D [];</td></tr><tr><=
td class=3D"line-number" value=3D"1939"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"1940"></td><td class=3D"l=
ine-content">                    for (let i =3D 1; i &lt; tableRows.length;=
 i++) {</td></tr><tr><td class=3D"line-number" value=3D"1941"></td><td clas=
s=3D"line-content">                        const row =3D tableRows[i];</td>=
</tr><tr><td class=3D"line-number" value=3D"1942"></td><td class=3D"line-co=
ntent">                        const cells =3D row.split('|').map(c =3D&gt;=
 c.trim()).filter(c =3D&gt; c);</td></tr><tr><td class=3D"line-number" valu=
e=3D"1943"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"1944"></td><td class=3D"line-content">                =
        // Skip table separator row</td></tr><tr><td class=3D"line-number" =
value=3D"1945"></td><td class=3D"line-content">                        if (=
cells.length &gt; 0 &amp;&amp; cells.every(cell =3D&gt; /^[-:]+$/.test(cell=
))) {</td></tr><tr><td class=3D"line-number" value=3D"1946"></td><td class=
=3D"line-content">                            continue;</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1947"></td><td class=3D"line-content">        =
                }</td></tr><tr><td class=3D"line-number" value=3D"1948"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"1949"></td><td class=3D"line-content">                        if (ce=
lls.length &gt;=3D 4) {</td></tr><tr><td class=3D"line-number" value=3D"195=
0"></td><td class=3D"line-content">                            const aiProm=
pt =3D is6Column ? (cells[4] || '') : (cells[3] || '');</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1951"></td><td class=3D"line-content">        =
                    const itemName =3D cells[1] || '';</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1952"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"1953"></td><td class=3D"line-co=
ntent">                            if (!aiPrompt || /^[-\s]+$/.test(aiPromp=
t)) continue;</td></tr><tr><td class=3D"line-number" value=3D"1954"></td><t=
d class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"1955"></td><td class=3D"line-content">                            promp=
ts.push({</td></tr><tr><td class=3D"line-number" value=3D"1956"></td><td cl=
ass=3D"line-content">                                id: cells[0],</td></tr=
><tr><td class=3D"line-number" value=3D"1957"></td><td class=3D"line-conten=
t">                                name: itemName,</td></tr><tr><td class=
=3D"line-number" value=3D"1958"></td><td class=3D"line-content">           =
                     prompt: aiPrompt</td></tr><tr><td class=3D"line-number=
" value=3D"1959"></td><td class=3D"line-content">                          =
  });</td></tr><tr><td class=3D"line-number" value=3D"1960"></td><td class=
=3D"line-content">                        }</td></tr><tr><td class=3D"line-=
number" value=3D"1961"></td><td class=3D"line-content">                    =
}</td></tr><tr><td class=3D"line-number" value=3D"1962"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1963"></t=
d><td class=3D"line-content">                    if (prompts.length &gt; 0)=
 {</td></tr><tr><td class=3D"line-number" value=3D"1964"></td><td class=3D"=
line-content">                        if (!accumulatedData.metadata) accumu=
latedData.metadata =3D {};</td></tr><tr><td class=3D"line-number" value=3D"=
1965"></td><td class=3D"line-content">                        if (!accumula=
tedData.slides) accumulatedData.slides =3D [];</td></tr><tr><td class=3D"li=
ne-number" value=3D"1966"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"1967"></td><td class=3D"line-content"> =
                       // First prompt is typically Hero</td></tr><tr><td c=
lass=3D"line-number" value=3D"1968"></td><td class=3D"line-content">       =
                 if (prompts[0]) {</td></tr><tr><td class=3D"line-number" v=
alue=3D"1969"></td><td class=3D"line-content">                            a=
ccumulatedData.metadata.heroPrompt =3D prompts[0].prompt;</td></tr><tr><td =
class=3D"line-number" value=3D"1970"></td><td class=3D"line-content">      =
                      prompts.shift();</td></tr><tr><td class=3D"line-numbe=
r" value=3D"1971"></td><td class=3D"line-content">                        }=
</td></tr><tr><td class=3D"line-number" value=3D"1972"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"1973"></td=
><td class=3D"line-content">                        // Distribute remaining=
 prompts across slides (2 per slide)</td></tr><tr><td class=3D"line-number"=
 value=3D"1974"></td><td class=3D"line-content">                        for=
 (let i =3D 0; i &lt; prompts.length &amp;&amp; i &lt; 18; i++) {</td></tr>=
<tr><td class=3D"line-number" value=3D"1975"></td><td class=3D"line-content=
">                            const slideIdx =3D Math.floor(i / 2);</td></t=
r><tr><td class=3D"line-number" value=3D"1976"></td><td class=3D"line-conte=
nt">                            const isAlt =3D i % 2 =3D=3D=3D 1;</td></tr=
><tr><td class=3D"line-number" value=3D"1977"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"1978"></td><td clas=
s=3D"line-content">                            if (!accumulatedData.slides[=
slideIdx]) {</td></tr><tr><td class=3D"line-number" value=3D"1979"></td><td=
 class=3D"line-content">                                accumulatedData.sli=
des[slideIdx] =3D { shortTitle: `Slide ${slideIdx + 1}` };</td></tr><tr><td=
 class=3D"line-number" value=3D"1980"></td><td class=3D"line-content">     =
                       }</td></tr><tr><td class=3D"line-number" value=3D"19=
81"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-num=
ber" value=3D"1982"></td><td class=3D"line-content">                       =
     if (isAlt) {</td></tr><tr><td class=3D"line-number" value=3D"1983"></t=
d><td class=3D"line-content">                                accumulatedDat=
a.slides[slideIdx].altImagePrompt =3D prompts[i].prompt;</td></tr><tr><td c=
lass=3D"line-number" value=3D"1984"></td><td class=3D"line-content">       =
                     } else {</td></tr><tr><td class=3D"line-number" value=
=3D"1985"></td><td class=3D"line-content">                                a=
ccumulatedData.slides[slideIdx].imagePrompt =3D prompts[i].prompt;</td></tr=
><tr><td class=3D"line-number" value=3D"1986"></td><td class=3D"line-conten=
t">                            }</td></tr><tr><td class=3D"line-number" val=
ue=3D"1987"></td><td class=3D"line-content">                        }</td><=
/tr><tr><td class=3D"line-number" value=3D"1988"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"1989"></td><td c=
lass=3D"line-content">                        accumulatedData.aiPromptsExtr=
acted =3D true;</td></tr><tr><td class=3D"line-number" value=3D"1990"></td>=
<td class=3D"line-content">                        log(`Extracted ${prompts=
.length + 1} AI prompts from Assets phase`, 'success');</td></tr><tr><td cl=
ass=3D"line-number" value=3D"1991"></td><td class=3D"line-content">        =
                return;</td></tr><tr><td class=3D"line-number" value=3D"199=
2"></td><td class=3D"line-content">                    }</td></tr><tr><td c=
lass=3D"line-number" value=3D"1993"></td><td class=3D"line-content">       =
         }</td></tr><tr><td class=3D"line-number" value=3D"1994"></td><td c=
lass=3D"line-content">            }</td></tr><tr><td class=3D"line-number" =
value=3D"1995"></td><td class=3D"line-content">            accumulatedData.=
aiPromptsExtracted =3D true;</td></tr><tr><td class=3D"line-number" value=
=3D"1996"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"1997"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"1998"></td><td class=3D"line-cont=
ent">        function renderAssetsScreen(outputArea) {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"1999"></td><td class=3D"line-content">         =
   if (!accumulatedData.aiPromptsExtracted) {</td></tr><tr><td class=3D"lin=
e-number" value=3D"2000"></td><td class=3D"line-content">                ex=
tractAIPromptsFromHistory();</td></tr><tr><td class=3D"line-number" value=
=3D"2001"></td><td class=3D"line-content">            }</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2002"></td><td class=3D"line-content"><br></td=
></tr><tr><td class=3D"line-number" value=3D"2003"></td><td class=3D"line-c=
ontent">            const missionId =3D accumulatedData?.metadata?.id || 'u=
nnamed';</td></tr><tr><td class=3D"line-number" value=3D"2004"></td><td cla=
ss=3D"line-content">            const heroPrompt =3D accumulatedData.metada=
ta?.heroPrompt || '';</td></tr><tr><td class=3D"line-number" value=3D"2005"=
></td><td class=3D"line-content">            const heroImage =3D accumulate=
dData.metadata?.heroImage || '';</td></tr><tr><td class=3D"line-number" val=
ue=3D"2006"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"=
line-number" value=3D"2007"></td><td class=3D"line-content">            let=
 html =3D `</td></tr><tr><td class=3D"line-number" value=3D"2008"></td><td =
class=3D"line-content">                &lt;div class=3D"p-6 h-full overflow=
-y-auto bg-base-200"&gt;</td></tr><tr><td class=3D"line-number" value=3D"20=
09"></td><td class=3D"line-content">                    &lt;div class=3D"fl=
ex flex-col md:flex-row justify-between items-start md:items-center gap-4 m=
b-8"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2010"></td><td cla=
ss=3D"line-content">                        &lt;div&gt;</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2011"></td><td class=3D"line-content">        =
                    &lt;h2 class=3D"text-2xl font-display tracking-widest t=
ext-primary flex items-center gap-2"&gt;</td></tr><tr><td class=3D"line-num=
ber" value=3D"2012"></td><td class=3D"line-content">                       =
         &lt;svg xmlns=3D"http://www.w3.org/2000/svg" class=3D"h-6 w-6" fil=
l=3D"none" viewBox=3D"0 0 24 24" stroke=3D"currentColor"&gt;</td></tr><tr><=
td class=3D"line-number" value=3D"2013"></td><td class=3D"line-content">   =
                                 &lt;path stroke-linecap=3D"round" stroke-l=
inejoin=3D"round" stroke-width=3D"2" d=3D"M4 16l4.586-4.586a2 2 0 012.828 0=
L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V=
6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2014"></td><td class=3D"line-content">           =
                     &lt;/svg&gt;</td></tr><tr><td class=3D"line-number" va=
lue=3D"2015"></td><td class=3D"line-content">                              =
  VISUAL ASSET MATRIX</td></tr><tr><td class=3D"line-number" value=3D"2016"=
></td><td class=3D"line-content">                            &lt;/h2&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"2017"></td><td class=3D"line-=
content">                            &lt;p class=3D"text-xs opacity-60 font=
-mono uppercase tracking-tighter"&gt;Mission ID: ${missionId}&lt;/p&gt;</td=
></tr><tr><td class=3D"line-number" value=3D"2018"></td><td class=3D"line-c=
ontent">                        &lt;/div&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"2019"></td><td class=3D"line-content">                   =
     &lt;div class=3D"flex flex-wrap gap-2"&gt;</td></tr><tr><td class=3D"l=
ine-number" value=3D"2020"></td><td class=3D"line-content">                =
             &lt;button class=3D"btn btn-sm btn-outline btn-primary font-mo=
no text-[10px]" onclick=3D"extractAIPromptsFromHistory(); renderAssetsScree=
n(document.getElementById('Builder-output'))"&gt;RESYNC PROMPTS&lt;/button&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"2021"></td><td class=3D=
"line-content">                             &lt;button class=3D"btn btn-sm =
btn-secondary font-mono text-[10px]" onclick=3D"generateAllAssets()"&gt;GEN=
ERATE ALL&lt;/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"20=
22"></td><td class=3D"line-content">                             &lt;button=
 class=3D"btn btn-sm btn-accent font-mono text-[10px]" onclick=3D"saveAllAs=
setsToR2()"&gt;SAVE ALL TO R2&lt;/button&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"2023"></td><td class=3D"line-content">                   =
     &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2024"></t=
d><td class=3D"line-content">                    &lt;/div&gt;</td></tr><tr>=
<td class=3D"line-number" value=3D"2025"></td><td class=3D"line-content"><b=
r></td></tr><tr><td class=3D"line-number" value=3D"2026"></td><td class=3D"=
line-content">                    &lt;div class=3D"grid grid-cols-1 md:grid=
-cols-2 xl:grid-cols-4 gap-4"&gt;</td></tr><tr><td class=3D"line-number" va=
lue=3D"2027"></td><td class=3D"line-content">                        &lt;di=
v class=3D"col-span-full mb-4"&gt;</td></tr><tr><td class=3D"line-number" v=
alue=3D"2028"></td><td class=3D"line-content">                            &=
lt;div class=3D"card bg-base-100 shadow-xl border border-primary/20"&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"2029"></td><td class=3D"line-=
content">                                &lt;div class=3D"card-body p-4 md:=
p-6"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2030"></td><td cla=
ss=3D"line-content">                                    &lt;div class=3D"fl=
ex justify-between items-center mb-2"&gt;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2031"></td><td class=3D"line-content">                      =
                  &lt;h3 class=3D"text-xs font-bold text-primary tracking-w=
idest uppercase"&gt;Primary Mission Hero&lt;/h3&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2032"></td><td class=3D"line-content">           =
                             &lt;span class=3D"badge badge-primary badge-xs=
 font-mono"&gt;SLOT: HERO&lt;/span&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2033"></td><td class=3D"line-content">                         =
           &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"203=
4"></td><td class=3D"line-content">                                    &lt;=
div class=3D"grid grid-cols-1 lg:grid-cols-3 gap-6"&gt;</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2035"></td><td class=3D"line-content">        =
                                &lt;div class=3D"lg:col-span-2 space-y-4"&g=
t;</td></tr><tr><td class=3D"line-number" value=3D"2036"></td><td class=3D"=
line-content">                                            &lt;div class=3D"=
form-control"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2037"></t=
d><td class=3D"line-content">                                              =
  &lt;label class=3D"label py-1"&gt;&lt;span class=3D"label-text-alt opacit=
y-50 text-[10px] uppercase font-bold"&gt;Image Synthesis Prompt&lt;/span&gt=
;&lt;/label&gt;</td></tr><tr><td class=3D"line-number" value=3D"2038"></td>=
<td class=3D"line-content">                                                =
&lt;textarea id=3D"asset-hero-prompt" class=3D"textarea textarea-bordered t=
extarea-sm w-full h-24 font-mono text-xs leading-tight" placeholder=3D"Synt=
hetics prompt..."&gt;${heroPrompt}&lt;/textarea&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2039"></td><td class=3D"line-content">           =
                                 &lt;/div&gt;</td></tr><tr><td class=3D"lin=
e-number" value=3D"2040"></td><td class=3D"line-content">                  =
                          &lt;div class=3D"flex flex-col sm:flex-row gap-2"=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"2041"></td><td class=
=3D"line-content">                                                &lt;div c=
lass=3D"join flex-1"&gt;</td></tr><tr><td class=3D"line-number" value=3D"20=
42"></td><td class=3D"line-content">                                       =
             &lt;input id=3D"asset-hero-url" type=3D"text" class=3D"input i=
nput-bordered input-xs join-item flex-1 font-mono text-[10px] text-success"=
 placeholder=3D"Asset URL (R2/HTTPS)" value=3D"${heroImage}" onchange=3D"up=
dateAssetUrl('hero', this.value)"&gt;</td></tr><tr><td class=3D"line-number=
" value=3D"2043"></td><td class=3D"line-content">                          =
                          &lt;button class=3D"btn btn-xs btn-primary join-i=
tem px-4 font-bold" onclick=3D"generateAsset('hero')"&gt;GENERATE&lt;/butto=
n&gt;</td></tr><tr><td class=3D"line-number" value=3D"2044"></td><td class=
=3D"line-content">                                                &lt;/div&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"2045"></td><td class=3D=
"line-content">                                                &lt;button c=
lass=3D"btn btn-xs btn-outline btn-accent font-bold" onclick=3D"saveAssetTo=
Git('hero')"&gt;R2 ARCHIVE&lt;/button&gt;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2046"></td><td class=3D"line-content">                      =
                      &lt;/div&gt;</td></tr><tr><td class=3D"line-number" v=
alue=3D"2047"></td><td class=3D"line-content">                             =
           &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"204=
8"></td><td class=3D"line-content">                                        =
&lt;div id=3D"asset-hero-preview" class=3D"bg-black/40 rounded border borde=
r-white/5 flex items-center justify-center min-h-[160px] overflow-hidden"&g=
t;</td></tr><tr><td class=3D"line-number" value=3D"2049"></td><td class=3D"=
line-content">                                            ${heroImage ? `&l=
t;img src=3D"${heroImage}" class=3D"max-h-[160px] object-contain shadow-2xl=
" onerror=3D"this.src=3D'https://placehold.co/600x400/000/0af?text=3DPREVIE=
W+FAILED'"&gt;` : '&lt;div class=3D"text-center opacity-20"&gt;&lt;p class=
=3D"text-[10px] font-mono"&gt;NO IMAGE DATA&lt;/p&gt;&lt;/div&gt;'}</td></t=
r><tr><td class=3D"line-number" value=3D"2050"></td><td class=3D"line-conte=
nt">                                        &lt;/div&gt;</td></tr><tr><td c=
lass=3D"line-number" value=3D"2051"></td><td class=3D"line-content">       =
                             &lt;/div&gt;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2052"></td><td class=3D"line-content">                      =
          &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2053=
"></td><td class=3D"line-content">                            &lt;/div&gt;<=
/td></tr><tr><td class=3D"line-number" value=3D"2054"></td><td class=3D"lin=
e-content">                        &lt;/div&gt;</td></tr><tr><td class=3D"l=
ine-number" value=3D"2055"></td><td class=3D"line-content">            `;</=
td></tr><tr><td class=3D"line-number" value=3D"2056"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2057"></td><=
td class=3D"line-content">            const slides =3D accumulatedData.slid=
es || [];</td></tr><tr><td class=3D"line-number" value=3D"2058"></td><td cl=
ass=3D"line-content">            slides.forEach((slide, i) =3D&gt; {</td></=
tr><tr><td class=3D"line-number" value=3D"2059"></td><td class=3D"line-cont=
ent">                const slideTitle =3D slide.title || slide.shortTitle |=
| `Section ${i + 1}`;</td></tr><tr><td class=3D"line-number" value=3D"2060"=
></td><td class=3D"line-content">                const primaryImg =3D slide=
.tabs?.primary?.image || slide.image || '';</td></tr><tr><td class=3D"line-=
number" value=3D"2061"></td><td class=3D"line-content">                cons=
t altImg =3D slide.tabs?.intel?.image || slide.altImage || '';</td></tr><tr=
><td class=3D"line-number" value=3D"2062"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"2063"></td><td class=3D=
"line-content">                html +=3D `</td></tr><tr><td class=3D"line-n=
umber" value=3D"2064"></td><td class=3D"line-content">                    &=
lt;div class=3D"card bg-base-100 shadow-lg border border-base-content/10"&g=
t;</td></tr><tr><td class=3D"line-number" value=3D"2065"></td><td class=3D"=
line-content">                        &lt;div class=3D"card-body p-3 space-=
y-3"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2066"></td><td cla=
ss=3D"line-content">                            &lt;div class=3D"flex justi=
fy-between items-center"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2067"></td><td class=3D"line-content">                                &=
lt;span class=3D"text-[10px] font-bold text-accent opacity-70 truncate max-=
w-[120px]"&gt;S${i + 1}A: ${slideTitle.substring(0, 18)}${slideTitle.length=
 &gt; 18 ? '...' : ''}&lt;/span&gt;</td></tr><tr><td class=3D"line-number" =
value=3D"2068"></td><td class=3D"line-content">                            =
    &lt;div class=3D"flex items-center gap-1"&gt;</td></tr><tr><td class=3D=
"line-number" value=3D"2069"></td><td class=3D"line-content">              =
                      &lt;button class=3D"btn btn-[8px] h-4 min-h-0 px-1 bt=
n-ghost opacity-40 hover:opacity-100" onclick=3D"openIntelModal(${i})"&gt;I=
NTEL&lt;/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"2070"><=
/td><td class=3D"line-content">                                    &lt;span=
 class=3D"badge badge-outline badge-xs opacity-50 font-mono"&gt;PRM&lt;/spa=
n&gt;</td></tr><tr><td class=3D"line-number" value=3D"2071"></td><td class=
=3D"line-content">                                &lt;/div&gt;</td></tr><tr=
><td class=3D"line-number" value=3D"2072"></td><td class=3D"line-content"> =
                           &lt;/div&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"2073"></td><td class=3D"line-content">                        =
    &lt;div id=3D"asset-${i}-a-preview" class=3D"bg-black/20 rounded aspect=
-video flex items-center justify-center border border-white/5 overflow-hidd=
en"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2074"></td><td clas=
s=3D"line-content">                                ${primaryImg ? `&lt;img =
src=3D"${primaryImg}" class=3D"max-h-full object-contain" onerror=3D"this.s=
tyle.display=3D'none'"&gt;` : '&lt;span class=3D"text-[10px] opacity-20 fon=
t-mono uppercase"&gt;Offline&lt;/span&gt;'}</td></tr><tr><td class=3D"line-=
number" value=3D"2075"></td><td class=3D"line-content">                    =
        &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2076">=
</td><td class=3D"line-content">                            &lt;textarea id=
=3D"asset-${i}-a-prompt" class=3D"textarea textarea-bordered textarea-xs w-=
full h-16 font-mono text-[10px] leading-tight" placeholder=3D"Prompt..."&gt=
;${slide.imagePrompt || ''}&lt;/textarea&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"2077"></td><td class=3D"line-content">                   =
         &lt;input id=3D"asset-${i}-a-url" type=3D"text" class=3D"input inp=
ut-bordered input-xs w-full font-mono text-[9px] text-success" placeholder=
=3D"URL" value=3D"${primaryImg}" onchange=3D"updateAssetUrl('${i}-a', this.=
value)"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2078"></td><td =
class=3D"line-content">                            &lt;div class=3D"grid gr=
id-cols-2 gap-2"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2079">=
</td><td class=3D"line-content">                                &lt;button =
class=3D"btn btn-xs btn-primary font-mono text-[9px]" onclick=3D"generateAs=
set('${i}-a')"&gt;GEN&lt;/button&gt;</td></tr><tr><td class=3D"line-number"=
 value=3D"2080"></td><td class=3D"line-content">                           =
     &lt;button class=3D"btn btn-xs btn-outline font-mono text-[9px]" oncli=
ck=3D"saveAssetToGit('${i}-a')"&gt;R2&lt;/button&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2081"></td><td class=3D"line-content">           =
                 &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2082"></td><td class=3D"line-content">                        &lt;/div&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"2083"></td><td class=3D=
"line-content">                    &lt;/div&gt;</td></tr><tr><td class=3D"l=
ine-number" value=3D"2084"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"2085"></td><td class=3D"line-content">=
                    &lt;div class=3D"card bg-base-100 shadow-lg border bord=
er-base-content/10"&gt;</td></tr><tr><td class=3D"line-number" value=3D"208=
6"></td><td class=3D"line-content">                        &lt;div class=3D=
"card-body p-3 space-y-3"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2087"></td><td class=3D"line-content">                            &lt;d=
iv class=3D"flex justify-between items-center"&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2088"></td><td class=3D"line-content">           =
                     &lt;span class=3D"text-[10px] font-bold text-warning o=
pacity-70 truncate max-w-[120px]"&gt;S${i + 1}B: ${slideTitle.substring(0, =
18)}${slideTitle.length &gt; 18 ? '...' : ''}&lt;/span&gt;</td></tr><tr><td=
 class=3D"line-number" value=3D"2089"></td><td class=3D"line-content">     =
                           &lt;div class=3D"flex items-center gap-1"&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"2090"></td><td class=3D"line-=
content">                                    &lt;button class=3D"btn btn-[8=
px] h-4 min-h-0 px-1 btn-ghost opacity-40 hover:opacity-100" onclick=3D"ope=
nIntelModal(${i})"&gt;INTEL&lt;/button&gt;</td></tr><tr><td class=3D"line-n=
umber" value=3D"2091"></td><td class=3D"line-content">                     =
               &lt;span class=3D"badge badge-outline badge-xs opacity-50 fo=
nt-mono"&gt;ALT&lt;/span&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2092"></td><td class=3D"line-content">                                &=
lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2093"></td><td =
class=3D"line-content">                            &lt;/div&gt;</td></tr><t=
r><td class=3D"line-number" value=3D"2094"></td><td class=3D"line-content">=
                            &lt;div id=3D"asset-${i}-b-preview" class=3D"bg=
-black/20 rounded aspect-video flex items-center justify-center border bord=
er-white/5 overflow-hidden"&gt;</td></tr><tr><td class=3D"line-number" valu=
e=3D"2095"></td><td class=3D"line-content">                                =
${altImg ? `&lt;img src=3D"${altImg}" class=3D"max-h-full object-contain" o=
nerror=3D"this.style.display=3D'none'"&gt;` : '&lt;span class=3D"text-[10px=
] opacity-20 font-mono uppercase"&gt;Offline&lt;/span&gt;'}</td></tr><tr><t=
d class=3D"line-number" value=3D"2096"></td><td class=3D"line-content">    =
                        &lt;/div&gt;</td></tr><tr><td class=3D"line-number"=
 value=3D"2097"></td><td class=3D"line-content">                           =
 &lt;textarea id=3D"asset-${i}-b-prompt" class=3D"textarea textarea-bordere=
d textarea-xs w-full h-16 font-mono text-[10px] leading-tight" placeholder=
=3D"Alt prompt..."&gt;${slide.altImagePrompt || ''}&lt;/textarea&gt;</td></=
tr><tr><td class=3D"line-number" value=3D"2098"></td><td class=3D"line-cont=
ent">                            &lt;input id=3D"asset-${i}-b-url" type=3D"=
text" class=3D"input input-bordered input-xs w-full font-mono text-[9px] te=
xt-warning" placeholder=3D"URL" value=3D"${altImg}" onchange=3D"updateAsset=
Url('${i}-b', this.value)"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2099"></td><td class=3D"line-content">                            &lt;d=
iv class=3D"grid grid-cols-2 gap-2"&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"2100"></td><td class=3D"line-content">                        =
        &lt;button class=3D"btn btn-xs btn-secondary font-mono text-[9px]" =
onclick=3D"generateAsset('${i}-b')"&gt;GEN&lt;/button&gt;</td></tr><tr><td =
class=3D"line-number" value=3D"2101"></td><td class=3D"line-content">      =
                          &lt;button class=3D"btn btn-xs btn-outline font-m=
ono text-[9px]" onclick=3D"saveAssetToGit('${i}-b')"&gt;R2&lt;/button&gt;</=
td></tr><tr><td class=3D"line-number" value=3D"2102"></td><td class=3D"line=
-content">                            &lt;/div&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2103"></td><td class=3D"line-content">           =
             &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2=
104"></td><td class=3D"line-content">                    &lt;/div&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"2105"></td><td class=3D"line-con=
tent">                `;</td></tr><tr><td class=3D"line-number" value=3D"21=
06"></td><td class=3D"line-content">            });</td></tr><tr><td class=
=3D"line-number" value=3D"2107"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2108"></td><td class=3D"line-cont=
ent">            html +=3D `&lt;/div&gt;&lt;/div&gt;`;</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2109"></td><td class=3D"line-content">         =
   outputArea.innerHTML =3D html;</td></tr><tr><td class=3D"line-number" va=
lue=3D"2110"></td><td class=3D"line-content">        }</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2111"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"2112"></td><td class=3D"line-co=
ntent">        function updateAssetUrl(slotId, url) {</td></tr><tr><td clas=
s=3D"line-number" value=3D"2113"></td><td class=3D"line-content">          =
  if (slotId =3D=3D=3D 'hero') {</td></tr><tr><td class=3D"line-number" val=
ue=3D"2114"></td><td class=3D"line-content">                if (!accumulate=
dData.metadata) accumulatedData.metadata =3D {};</td></tr><tr><td class=3D"=
line-number" value=3D"2115"></td><td class=3D"line-content">               =
 accumulatedData.metadata.heroImage =3D url;</td></tr><tr><td class=3D"line=
-number" value=3D"2116"></td><td class=3D"line-content">                con=
st prev =3D document.getElementById('asset-hero-preview');</td></tr><tr><td=
 class=3D"line-number" value=3D"2117"></td><td class=3D"line-content">     =
           if (prev) prev.innerHTML =3D url ? `&lt;img src=3D"${url}" class=
=3D"max-h-[160px] object-contain shadow-2xl"&gt;` : '&lt;div class=3D"text-=
[10px] opacity-20 font-mono"&gt;NO IMAGE DATA&lt;/div&gt;';</td></tr><tr><t=
d class=3D"line-number" value=3D"2118"></td><td class=3D"line-content">    =
        } else if (typeof slotId =3D=3D=3D 'string' &amp;&amp; slotId.inclu=
des('-')) {</td></tr><tr><td class=3D"line-number" value=3D"2119"></td><td =
class=3D"line-content">                const [slideIdx, variant] =3D slotId=
.split('-');</td></tr><tr><td class=3D"line-number" value=3D"2120"></td><td=
 class=3D"line-content">                const idx =3D parseInt(slideIdx);</=
td></tr><tr><td class=3D"line-number" value=3D"2121"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2122"></td><=
td class=3D"line-content">                if (!accumulatedData.slides[idx])=
 accumulatedData.slides[idx] =3D {};</td></tr><tr><td class=3D"line-number"=
 value=3D"2123"></td><td class=3D"line-content">                if (!accumu=
latedData.slides[idx].tabs) accumulatedData.slides[idx].tabs =3D { primary:=
 {}, intel: {} };</td></tr><tr><td class=3D"line-number" value=3D"2124"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"2125"></td><td class=3D"line-content">                if (variant =
=3D=3D=3D 'a') {</td></tr><tr><td class=3D"line-number" value=3D"2126"></td=
><td class=3D"line-content">                    accumulatedData.slides[idx]=
.tabs.primary.image =3D url;</td></tr><tr><td class=3D"line-number" value=
=3D"2127"></td><td class=3D"line-content">                    accumulatedDa=
ta.slides[idx].image =3D url;</td></tr><tr><td class=3D"line-number" value=
=3D"2128"></td><td class=3D"line-content">                } else {</td></tr=
><tr><td class=3D"line-number" value=3D"2129"></td><td class=3D"line-conten=
t">                    accumulatedData.slides[idx].tabs.intel.image =3D url=
;</td></tr><tr><td class=3D"line-number" value=3D"2130"></td><td class=3D"l=
ine-content">                }</td></tr><tr><td class=3D"line-number" value=
=3D"2131"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"2132"></td><td class=3D"line-content">                c=
onst prev =3D document.getElementById(`asset-${slotId}-preview`);</td></tr>=
<tr><td class=3D"line-number" value=3D"2133"></td><td class=3D"line-content=
">                if (prev) prev.innerHTML =3D url ? `&lt;img src=3D"${url}=
" class=3D"max-h-full object-contain"&gt;` : '&lt;span class=3D"text-[10px]=
 opacity-20 font-mono"&gt;Offline&lt;/span&gt;';</td></tr><tr><td class=3D"=
line-number" value=3D"2134"></td><td class=3D"line-content">            }</=
td></tr><tr><td class=3D"line-number" value=3D"2135"></td><td class=3D"line=
-content">            log(`Asset URL updated for slot ${slotId}`, 'success'=
);</td></tr><tr><td class=3D"line-number" value=3D"2136"></td><td class=3D"=
line-content">        }</td></tr><tr><td class=3D"line-number" value=3D"213=
7"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"2138"></td><td class=3D"line-content">        async function g=
enerateAsset(slotId) {</td></tr><tr><td class=3D"line-number" value=3D"2139=
"></td><td class=3D"line-content">            const promptEl =3D document.g=
etElementById(slotId =3D=3D=3D 'hero' ? 'asset-hero-prompt' : `asset-${slot=
Id}-prompt`);</td></tr><tr><td class=3D"line-number" value=3D"2140"></td><t=
d class=3D"line-content">            const urlEl =3D document.getElementByI=
d(slotId =3D=3D=3D 'hero' ? 'asset-hero-url' : `asset-${slotId}-url`);</td>=
</tr><tr><td class=3D"line-number" value=3D"2141"></td><td class=3D"line-co=
ntent">            const previewEl =3D document.getElementById(slotId =3D=
=3D=3D 'hero' ? 'asset-hero-preview' : `asset-${slotId}-preview`);</td></tr=
><tr><td class=3D"line-number" value=3D"2142"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"2143"></td><td clas=
s=3D"line-content">            const prompt =3D promptEl?.value;</td></tr><=
tr><td class=3D"line-number" value=3D"2144"></td><td class=3D"line-content"=
>            if (!prompt) {</td></tr><tr><td class=3D"line-number" value=3D=
"2145"></td><td class=3D"line-content">                alert('Enter a synth=
esis directive first!');</td></tr><tr><td class=3D"line-number" value=3D"21=
46"></td><td class=3D"line-content">                return;</td></tr><tr><t=
d class=3D"line-number" value=3D"2147"></td><td class=3D"line-content">    =
        }</td></tr><tr><td class=3D"line-number" value=3D"2148"></td><td cl=
ass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2=
149"></td><td class=3D"line-content">            // Get OpenRouter key or V=
ercel Proxy</td></tr><tr><td class=3D"line-number" value=3D"2150"></td><td =
class=3D"line-content">            let orKey =3D localStorage.getItem('TM_O=
PENROUTER_KEY');</td></tr><tr><td class=3D"line-number" value=3D"2151"></td=
><td class=3D"line-content">            if (!orKey) {</td></tr><tr><td clas=
s=3D"line-number" value=3D"2152"></td><td class=3D"line-content">          =
      orKey =3D window.prompt("Enter OpenRouter API Key for Image Synthesis=
:");</td></tr><tr><td class=3D"line-number" value=3D"2153"></td><td class=
=3D"line-content">                if (!orKey) return;</td></tr><tr><td clas=
s=3D"line-number" value=3D"2154"></td><td class=3D"line-content">          =
      localStorage.setItem('TM_OPENROUTER_KEY', orKey.trim());</td></tr><tr=
><td class=3D"line-number" value=3D"2155"></td><td class=3D"line-content"> =
           }</td></tr><tr><td class=3D"line-number" value=3D"2156"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2157"></td><td class=3D"line-content">            try {</td></tr><tr><t=
d class=3D"line-number" value=3D"2158"></td><td class=3D"line-content">    =
            previewEl.innerHTML =3D '&lt;span class=3D"loading loading-spin=
ner text-primary"&gt;&lt;/span&gt;';</td></tr><tr><td class=3D"line-number"=
 value=3D"2159"></td><td class=3D"line-content">                log(`Synthe=
sis Initiated [${slotId}]...`, 'info');</td></tr><tr><td class=3D"line-numb=
er" value=3D"2160"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"2161"></td><td class=3D"line-content">        =
        const response =3D await fetch("https://openrouter.ai/api/v1/chat/c=
ompletions", {</td></tr><tr><td class=3D"line-number" value=3D"2162"></td><=
td class=3D"line-content">                    method: "POST",</td></tr><tr>=
<td class=3D"line-number" value=3D"2163"></td><td class=3D"line-content">  =
                  headers: {</td></tr><tr><td class=3D"line-number" value=
=3D"2164"></td><td class=3D"line-content">                        "Authoriz=
ation": `Bearer ${orKey}`,</td></tr><tr><td class=3D"line-number" value=3D"=
2165"></td><td class=3D"line-content">                        "Content-Type=
": "application/json"</td></tr><tr><td class=3D"line-number" value=3D"2166"=
></td><td class=3D"line-content">                    },</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2167"></td><td class=3D"line-content">        =
            body: JSON.stringify({</td></tr><tr><td class=3D"line-number" v=
alue=3D"2168"></td><td class=3D"line-content">                        "mode=
l": "black-forest-labs/flux.2-pro",</td></tr><tr><td class=3D"line-number" =
value=3D"2169"></td><td class=3D"line-content">                        "mes=
sages": [{ "role": "user", "content": prompt }]</td></tr><tr><td class=3D"l=
ine-number" value=3D"2170"></td><td class=3D"line-content">                =
    })</td></tr><tr><td class=3D"line-number" value=3D"2171"></td><td class=
=3D"line-content">                });</td></tr><tr><td class=3D"line-number=
" value=3D"2172"></td><td class=3D"line-content"><br></td></tr><tr><td clas=
s=3D"line-number" value=3D"2173"></td><td class=3D"line-content">          =
      const data =3D await response.json();</td></tr><tr><td class=3D"line-=
number" value=3D"2174"></td><td class=3D"line-content">                if (=
data.error) throw new Error(data.error.message);</td></tr><tr><td class=3D"=
line-number" value=3D"2175"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"2176"></td><td class=3D"line-content"=
>                const message =3D data.choices[0].message;</td></tr><tr><t=
d class=3D"line-number" value=3D"2177"></td><td class=3D"line-content">    =
            let imageUrl =3D null;</td></tr><tr><td class=3D"line-number" v=
alue=3D"2178"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2179"></td><td class=3D"line-content">           =
     if (message.images &amp;&amp; message.images.length &gt; 0) {</td></tr=
><tr><td class=3D"line-number" value=3D"2180"></td><td class=3D"line-conten=
t">                    imageUrl =3D message.images[0].image_url?.url || mes=
sage.images[0];</td></tr><tr><td class=3D"line-number" value=3D"2181"></td>=
<td class=3D"line-content">                }</td></tr><tr><td class=3D"line=
-number" value=3D"2182"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"2183"></td><td class=3D"line-content">   =
             if (!imageUrl) {</td></tr><tr><td class=3D"line-number" value=
=3D"2184"></td><td class=3D"line-content">                    const urlMatc=
h =3D (message.content || "").match(/https?:\/\/[^\s\)]+/g);</td></tr><tr><=
td class=3D"line-number" value=3D"2185"></td><td class=3D"line-content">   =
                 if (urlMatch) imageUrl =3D urlMatch[0];</td></tr><tr><td c=
lass=3D"line-number" value=3D"2186"></td><td class=3D"line-content">       =
         }</td></tr><tr><td class=3D"line-number" value=3D"2187"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
2188"></td><td class=3D"line-content">                if (!imageUrl) throw =
new Error("Synthesis failed to yield visual data.");</td></tr><tr><td class=
=3D"line-number" value=3D"2189"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2190"></td><td class=3D"line-cont=
ent">                urlEl.value =3D imageUrl;</td></tr><tr><td class=3D"li=
ne-number" value=3D"2191"></td><td class=3D"line-content">                u=
pdateAssetUrl(slotId, imageUrl);</td></tr><tr><td class=3D"line-number" val=
ue=3D"2192"></td><td class=3D"line-content">                log(`Synthesis =
Successful [${slotId}]`, 'success');</td></tr><tr><td class=3D"line-number"=
 value=3D"2193"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2194"></td><td class=3D"line-content">           =
 } catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"2195"></td><=
td class=3D"line-content">                log(`Synthesis Error [${slotId}]:=
 ${e.message}`, 'error');</td></tr><tr><td class=3D"line-number" value=3D"2=
196"></td><td class=3D"line-content">                previewEl.innerHTML =
=3D `&lt;span class=3D"text-[10px] text-error font-mono leading-none text-c=
enter"&gt;FAILURE:&lt;br&gt;${e.message.substring(0, 30)}...&lt;/span&gt;`;=
</td></tr><tr><td class=3D"line-number" value=3D"2197"></td><td class=3D"li=
ne-content">            }</td></tr><tr><td class=3D"line-number" value=3D"2=
198"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"li=
ne-number" value=3D"2199"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"2200"></td><td class=3D"line-content"> =
       async function generateAllAssets() {</td></tr><tr><td class=3D"line-=
number" value=3D"2201"></td><td class=3D"line-content">            if (!con=
firm("Synthesize ALL assets? This consumes significant credits.")) return;<=
/td></tr><tr><td class=3D"line-number" value=3D"2202"></td><td class=3D"lin=
e-content">            const slots =3D ['hero'];</td></tr><tr><td class=3D"=
line-number" value=3D"2203"></td><td class=3D"line-content">            for=
 (let i =3D 0; i &lt; (accumulatedData.slides?.length || 0); i++) {</td></t=
r><tr><td class=3D"line-number" value=3D"2204"></td><td class=3D"line-conte=
nt">                slots.push(`${i}-a`, `${i}-b`);</td></tr><tr><td class=
=3D"line-number" value=3D"2205"></td><td class=3D"line-content">           =
 }</td></tr><tr><td class=3D"line-number" value=3D"2206"></td><td class=3D"=
line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2207"></=
td><td class=3D"line-content">            for (const slotId of slots) {</td=
></tr><tr><td class=3D"line-number" value=3D"2208"></td><td class=3D"line-c=
ontent">                const promptEl =3D document.getElementById(slotId =
=3D=3D=3D 'hero' ? 'asset-hero-prompt' : `asset-${slotId}-prompt`);</td></t=
r><tr><td class=3D"line-number" value=3D"2209"></td><td class=3D"line-conte=
nt">                if (promptEl?.value?.trim()) {</td></tr><tr><td class=
=3D"line-number" value=3D"2210"></td><td class=3D"line-content">           =
         await generateAsset(slotId);</td></tr><tr><td class=3D"line-number=
" value=3D"2211"></td><td class=3D"line-content">                    await =
new Promise(r =3D&gt; setTimeout(r, 1000)); // Rate limiting</td></tr><tr><=
td class=3D"line-number" value=3D"2212"></td><td class=3D"line-content">   =
             }</td></tr><tr><td class=3D"line-number" value=3D"2213"></td><=
td class=3D"line-content">            }</td></tr><tr><td class=3D"line-numb=
er" value=3D"2214"></td><td class=3D"line-content">        }</td></tr><tr><=
td class=3D"line-number" value=3D"2215"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"2216"></td><td class=3D"l=
ine-content">        async function saveAssetToGit(slotId) {</td></tr><tr><=
td class=3D"line-number" value=3D"2217"></td><td class=3D"line-content">   =
         const urlEl =3D document.getElementById(slotId =3D=3D=3D 'hero' ? =
'asset-hero-url' : `asset-${slotId}-url`);</td></tr><tr><td class=3D"line-n=
umber" value=3D"2218"></td><td class=3D"line-content">            const pre=
viewEl =3D document.getElementById(slotId =3D=3D=3D 'hero' ? 'asset-hero-pr=
eview' : `asset-${slotId}-preview`);</td></tr><tr><td class=3D"line-number"=
 value=3D"2219"></td><td class=3D"line-content">            const url =3D u=
rlEl?.value;</td></tr><tr><td class=3D"line-number" value=3D"2220"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2221"></td><td class=3D"line-content">            if (!url) return aler=
t('No asset URL found.');</td></tr><tr><td class=3D"line-number" value=3D"2=
222"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-nu=
mber" value=3D"2223"></td><td class=3D"line-content">            const R2_W=
ORKER_URL =3D 'https://proud-tooth-42cf.icumusicvideo.workers.dev';</td></t=
r><tr><td class=3D"line-number" value=3D"2224"></td><td class=3D"line-conte=
nt">            const originalContent =3D previewEl.innerHTML;</td></tr><tr=
><td class=3D"line-number" value=3D"2225"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"2226"></td><td class=3D=
"line-content">            try {</td></tr><tr><td class=3D"line-number" val=
ue=3D"2227"></td><td class=3D"line-content">                log(`R2 Uplink =
[${slotId}]: Processing...`, 'info');</td></tr><tr><td class=3D"line-number=
" value=3D"2228"></td><td class=3D"line-content">                previewEl.=
innerHTML =3D '&lt;span class=3D"loading loading-spinner text-accent"&gt;&l=
t;/span&gt;';</td></tr><tr><td class=3D"line-number" value=3D"2229"></td><t=
d class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2230"></td><td class=3D"line-content">                // Convert to JPG=
 via canvas (for optimization and consistency)</td></tr><tr><td class=3D"li=
ne-number" value=3D"2231"></td><td class=3D"line-content">                c=
onst img =3D new Image();</td></tr><tr><td class=3D"line-number" value=3D"2=
232"></td><td class=3D"line-content">                img.crossOrigin =3D "a=
nonymous";</td></tr><tr><td class=3D"line-number" value=3D"2233"></td><td c=
lass=3D"line-content">                await new Promise((res, rej) =3D&gt; =
{</td></tr><tr><td class=3D"line-number" value=3D"2234"></td><td class=3D"l=
ine-content">                    img.onload =3D res;</td></tr><tr><td class=
=3D"line-number" value=3D"2235"></td><td class=3D"line-content">           =
         img.onerror =3D rej;</td></tr><tr><td class=3D"line-number" value=
=3D"2236"></td><td class=3D"line-content">                    img.src =3D u=
rl;</td></tr><tr><td class=3D"line-number" value=3D"2237"></td><td class=3D=
"line-content">                });</td></tr><tr><td class=3D"line-number" v=
alue=3D"2238"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2239"></td><td class=3D"line-content">           =
     const canvas =3D document.createElement('canvas');</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2240"></td><td class=3D"line-content">        =
        canvas.width =3D img.width; canvas.height =3D img.height;</td></tr>=
<tr><td class=3D"line-number" value=3D"2241"></td><td class=3D"line-content=
">                const ctx =3D canvas.getContext('2d');</td></tr><tr><td c=
lass=3D"line-number" value=3D"2242"></td><td class=3D"line-content">       =
         ctx.fillStyle =3D '#FFF'; ctx.fillRect(0, 0, canvas.width, canvas.=
height);</td></tr><tr><td class=3D"line-number" value=3D"2243"></td><td cla=
ss=3D"line-content">                ctx.drawImage(img, 0, 0);</td></tr><tr>=
<td class=3D"line-number" value=3D"2244"></td><td class=3D"line-content">  =
              const jpgData =3D canvas.toDataURL('image/jpeg', 0.8);</td></=
tr><tr><td class=3D"line-number" value=3D"2245"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"2246"></td><td cl=
ass=3D"line-content">                const res =3D await fetch(`${R2_WORKER=
_URL}?filename=3D${encodeURIComponent(`TM_${slotId}_${Date.now()}.jpg`)}`, =
{</td></tr><tr><td class=3D"line-number" value=3D"2247"></td><td class=3D"l=
ine-content">                    method: 'POST',</td></tr><tr><td class=3D"=
line-number" value=3D"2248"></td><td class=3D"line-content">               =
     headers: { 'Content-Type': 'application/json' },</td></tr><tr><td clas=
s=3D"line-number" value=3D"2249"></td><td class=3D"line-content">          =
          body: JSON.stringify({ image: jpgData })</td></tr><tr><td class=
=3D"line-number" value=3D"2250"></td><td class=3D"line-content">           =
     });</td></tr><tr><td class=3D"line-number" value=3D"2251"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"22=
52"></td><td class=3D"line-content">                const data =3D await re=
s.json();</td></tr><tr><td class=3D"line-number" value=3D"2253"></td><td cl=
ass=3D"line-content">                if (!data.success) throw new Error(dat=
a.error);</td></tr><tr><td class=3D"line-number" value=3D"2254"></td><td cl=
ass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2=
255"></td><td class=3D"line-content">                urlEl.value =3D data.u=
rl;</td></tr><tr><td class=3D"line-number" value=3D"2256"></td><td class=3D=
"line-content">                updateAssetUrl(slotId, data.url);</td></tr><=
tr><td class=3D"line-number" value=3D"2257"></td><td class=3D"line-content"=
>                log(`R2 Archive Complete [${slotId}]`, 'success');</td></t=
r><tr><td class=3D"line-number" value=3D"2258"></td><td class=3D"line-conte=
nt"><br></td></tr><tr><td class=3D"line-number" value=3D"2259"></td><td cla=
ss=3D"line-content">            } catch (e) {</td></tr><tr><td class=3D"lin=
e-number" value=3D"2260"></td><td class=3D"line-content">                lo=
g(`R2 Error [${slotId}]: ${e.message}`, 'error');</td></tr><tr><td class=3D=
"line-number" value=3D"2261"></td><td class=3D"line-content">              =
  previewEl.innerHTML =3D originalContent;</td></tr><tr><td class=3D"line-n=
umber" value=3D"2262"></td><td class=3D"line-content">                alert=
(`Archive Failed: ${e.message}`);</td></tr><tr><td class=3D"line-number" va=
lue=3D"2263"></td><td class=3D"line-content">            }</td></tr><tr><td=
 class=3D"line-number" value=3D"2264"></td><td class=3D"line-content">     =
   }</td></tr><tr><td class=3D"line-number" value=3D"2265"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2266=
"></td><td class=3D"line-content">        async function saveAllAssetsToR2(=
) {</td></tr><tr><td class=3D"line-number" value=3D"2267"></td><td class=3D=
"line-content">            const slots =3D [];</td></tr><tr><td class=3D"li=
ne-number" value=3D"2268"></td><td class=3D"line-content">            const=
 heroUrl =3D document.getElementById('asset-hero-url')?.value;</td></tr><tr=
><td class=3D"line-number" value=3D"2269"></td><td class=3D"line-content"> =
           if (heroUrl) slots.push('hero');</td></tr><tr><td class=3D"line-=
number" value=3D"2270"></td><td class=3D"line-content"><br></td></tr><tr><t=
d class=3D"line-number" value=3D"2271"></td><td class=3D"line-content">    =
        for (let i =3D 0; i &lt; (accumulatedData.slides?.length || 0); i++=
) {</td></tr><tr><td class=3D"line-number" value=3D"2272"></td><td class=3D=
"line-content">                if (document.getElementById(`asset-${i}-a-ur=
l`)?.value) slots.push(`${i}-a`);</td></tr><tr><td class=3D"line-number" va=
lue=3D"2273"></td><td class=3D"line-content">                if (document.g=
etElementById(`asset-${i}-b-url`)?.value) slots.push(`${i}-b`);</td></tr><t=
r><td class=3D"line-number" value=3D"2274"></td><td class=3D"line-content">=
            }</td></tr><tr><td class=3D"line-number" value=3D"2275"></td><t=
d class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2276"></td><td class=3D"line-content">            if (!confirm(`Archive=
 ${slots.length} assets to central R2 storage?`)) return;</td></tr><tr><td =
class=3D"line-number" value=3D"2277"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"2278"></td><td class=3D"line=
-content">            for (const slotId of slots) {</td></tr><tr><td class=
=3D"line-number" value=3D"2279"></td><td class=3D"line-content">           =
     await saveAssetToGit(slotId);</td></tr><tr><td class=3D"line-number" v=
alue=3D"2280"></td><td class=3D"line-content">                await new Pro=
mise(r =3D&gt; setTimeout(r, 500));</td></tr><tr><td class=3D"line-number" =
value=3D"2281"></td><td class=3D"line-content">            }</td></tr><tr><=
td class=3D"line-number" value=3D"2282"></td><td class=3D"line-content">   =
         alert("Batch Archive Sequence Complete.");</td></tr><tr><td class=
=3D"line-number" value=3D"2283"></td><td class=3D"line-content">        }</=
td></tr><tr><td class=3D"line-number" value=3D"2284"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2285"></td><=
td class=3D"line-content">        // --- HOSPITAL (SURGICAL THEATER) LOGIC =
---</td></tr><tr><td class=3D"line-number" value=3D"2286"></td><td class=3D=
"line-content">        let currentEditingSlideIndex =3D -1;</td></tr><tr><t=
d class=3D"line-number" value=3D"2287"></td><td class=3D"line-content">    =
    let activeTabKey =3D 'primary';</td></tr><tr><td class=3D"line-number" =
value=3D"2288"></td><td class=3D"line-content">        let quill =3D null;<=
/td></tr><tr><td class=3D"line-number" value=3D"2289"></td><td class=3D"lin=
e-content">        let turndownService =3D (typeof TurndownService !=3D=3D =
'undefined') ? new TurndownService() : null;</td></tr><tr><td class=3D"line=
-number" value=3D"2290"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"2291"></td><td class=3D"line-content">   =
     function openHospital() {</td></tr><tr><td class=3D"line-number" value=
=3D"2292"></td><td class=3D"line-content">            const data =3D accumu=
latedData.slides || [];</td></tr><tr><td class=3D"line-number" value=3D"229=
3"></td><td class=3D"line-content">            if (data.length =3D=3D=3D 0)=
 {</td></tr><tr><td class=3D"line-number" value=3D"2294"></td><td class=3D"=
line-content">                accumulatedData.slides =3D [{ title: "INITIAL=
 BRIEFING", tabs: { primary: { label: "Main", body: "Mission parameters..."=
 } }, visual: "Satellite view...", options: ["Accept", "Decline"] }];</td><=
/tr><tr><td class=3D"line-number" value=3D"2295"></td><td class=3D"line-con=
tent">            }</td></tr><tr><td class=3D"line-number" value=3D"2296"><=
/td><td class=3D"line-content">            document.getElementById('hospita=
l_modal').showModal();</td></tr><tr><td class=3D"line-number" value=3D"2297=
"></td><td class=3D"line-content">            loadSlideEditor(0);</td></tr>=
<tr><td class=3D"line-number" value=3D"2298"></td><td class=3D"line-content=
">        }</td></tr><tr><td class=3D"line-number" value=3D"2299"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"2300"></td><td class=3D"line-content">        function renderHospitalSideb=
ar() {</td></tr><tr><td class=3D"line-number" value=3D"2301"></td><td class=
=3D"line-content">            const list =3D document.getElementById('h-sli=
de-list');</td></tr><tr><td class=3D"line-number" value=3D"2302"></td><td c=
lass=3D"line-content">            if (!list) return;</td></tr><tr><td class=
=3D"line-number" value=3D"2303"></td><td class=3D"line-content">           =
 let html =3D '';</td></tr><tr><td class=3D"line-number" value=3D"2304"></t=
d><td class=3D"line-content">            (accumulatedData.slides || []).for=
Each((s, i) =3D&gt; {</td></tr><tr><td class=3D"line-number" value=3D"2305"=
></td><td class=3D"line-content">                const active =3D i =3D=3D=
=3D currentEditingSlideIndex ? 'btn-active btn-secondary' : 'btn-ghost';</t=
d></tr><tr><td class=3D"line-number" value=3D"2306"></td><td class=3D"line-=
content">                html +=3D `&lt;button class=3D"btn btn-sm ${active=
} justify-start font-normal px-2 h-auto py-2" onclick=3D"loadSlideEditor(${=
i})"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2307"></td><td cla=
ss=3D"line-content">                    &lt;span class=3D"opacity-50 font-m=
ono text-[10px] mr-2 w-4 self-start mt-0.5"&gt;${i + 1}.&lt;/span&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"2308"></td><td class=3D"line-con=
tent">                    &lt;span class=3D"truncate text-xs text-left lead=
ing-tight whitespace-normal"&gt;${s.title || 'Untitled Mission Step'}&lt;/s=
pan&gt;</td></tr><tr><td class=3D"line-number" value=3D"2309"></td><td clas=
s=3D"line-content">                &lt;/button&gt;`;</td></tr><tr><td class=
=3D"line-number" value=3D"2310"></td><td class=3D"line-content">           =
 });</td></tr><tr><td class=3D"line-number" value=3D"2311"></td><td class=
=3D"line-content">            html +=3D `&lt;button class=3D"btn btn-sm btn=
-outline btn-xs border-dashed opacity-50 hover:opacity-100 mt-4" onclick=3D=
"addHospitalNode()"&gt;+ Add Mission Step&lt;/button&gt;`;</td></tr><tr><td=
 class=3D"line-number" value=3D"2312"></td><td class=3D"line-content">     =
       list.innerHTML =3D html;</td></tr><tr><td class=3D"line-number" valu=
e=3D"2313"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"2314"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2315"></td><td class=3D"line-cont=
ent">        function loadSlideEditor(index) {</td></tr><tr><td class=3D"li=
ne-number" value=3D"2316"></td><td class=3D"line-content">            curre=
ntEditingSlideIndex =3D index;</td></tr><tr><td class=3D"line-number" value=
=3D"2317"></td><td class=3D"line-content">            const slide =3D accum=
ulatedData.slides[index];</td></tr><tr><td class=3D"line-number" value=3D"2=
318"></td><td class=3D"line-content">            if (!slide) return;</td></=
tr><tr><td class=3D"line-number" value=3D"2319"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"2320"></td><td cl=
ass=3D"line-content">            // Ensure tabs structure</td></tr><tr><td =
class=3D"line-number" value=3D"2321"></td><td class=3D"line-content">      =
      if (!slide.tabs) {</td></tr><tr><td class=3D"line-number" value=3D"23=
22"></td><td class=3D"line-content">                slide.tabs =3D { primar=
y: { label: "Main", body: slide.brief || slide.content || "" } };</td></tr>=
<tr><td class=3D"line-number" value=3D"2323"></td><td class=3D"line-content=
">            }</td></tr><tr><td class=3D"line-number" value=3D"2324"></td>=
<td class=3D"line-content">            if (!slide.tabs[activeTabKey]) {</td=
></tr><tr><td class=3D"line-number" value=3D"2325"></td><td class=3D"line-c=
ontent">                activeTabKey =3D Object.keys(slide.tabs)[0] || 'pri=
mary';</td></tr><tr><td class=3D"line-number" value=3D"2326"></td><td class=
=3D"line-content">            }</td></tr><tr><td class=3D"line-number" valu=
e=3D"2327"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"2328"></td><td class=3D"line-content">            cons=
t tabData =3D slide.tabs[activeTabKey] || { label: "Main", body: "" };</td>=
</tr><tr><td class=3D"line-number" value=3D"2329"></td><td class=3D"line-co=
ntent"><br></td></tr><tr><td class=3D"line-number" value=3D"2330"></td><td =
class=3D"line-content">            // UI Fields</td></tr><tr><td class=3D"l=
ine-number" value=3D"2331"></td><td class=3D"line-content">            docu=
ment.getElementById('h-title').value =3D slide.title || slide.shortTitle ||=
 '';</td></tr><tr><td class=3D"line-number" value=3D"2332"></td><td class=
=3D"line-content">            document.getElementById('h-media-url').value =
=3D tabData.image || slide.image || '';</td></tr><tr><td class=3D"line-numb=
er" value=3D"2333"></td><td class=3D"line-content">            document.get=
ElementById('h-visual-prompt').value =3D slide.visual || slide.visualPrompt=
 || '';</td></tr><tr><td class=3D"line-number" value=3D"2334"></td><td clas=
s=3D"line-content">            document.getElementById('h-choice-a').value =
=3D slide.options?.[0] || '';</td></tr><tr><td class=3D"line-number" value=
=3D"2335"></td><td class=3D"line-content">            document.getElementBy=
Id('h-choice-b').value =3D slide.options?.[1] || '';</td></tr><tr><td class=
=3D"line-number" value=3D"2336"></td><td class=3D"line-content">           =
 document.getElementById('h-path').innerText =3D `SLIDE_${index + 1} -&gt; =
${activeTabKey.toUpperCase()}`;</td></tr><tr><td class=3D"line-number" valu=
e=3D"2337"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"2338"></td><td class=3D"line-content">            upda=
teHospitalPreview(document.getElementById('h-media-url').value);</td></tr><=
tr><td class=3D"line-number" value=3D"2339"></td><td class=3D"line-content"=
>            renderTabNav(slide);</td></tr><tr><td class=3D"line-number" va=
lue=3D"2340"></td><td class=3D"line-content">            initQuill(tabData.=
body || tabData.content || "");</td></tr><tr><td class=3D"line-number" valu=
e=3D"2341"></td><td class=3D"line-content">            renderHospitalSideba=
r();</td></tr><tr><td class=3D"line-number" value=3D"2342"></td><td class=
=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=3D=
"2343"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-=
number" value=3D"2344"></td><td class=3D"line-content">        function ren=
derTabNav(slide) {</td></tr><tr><td class=3D"line-number" value=3D"2345"></=
td><td class=3D"line-content">            const nav =3D document.getElement=
ById('h-tabs-nav');</td></tr><tr><td class=3D"line-number" value=3D"2346"><=
/td><td class=3D"line-content">            if (!nav) return;</td></tr><tr><=
td class=3D"line-number" value=3D"2347"></td><td class=3D"line-content">   =
         let html =3D '';</td></tr><tr><td class=3D"line-number" value=3D"2=
348"></td><td class=3D"line-content">            Object.keys(slide.tabs).fo=
rEach(key =3D&gt; {</td></tr><tr><td class=3D"line-number" value=3D"2349"><=
/td><td class=3D"line-content">                const active =3D key =3D=3D=
=3D activeTabKey ? 'btn-secondary text-white' : 'btn-ghost opacity-60';</td=
></tr><tr><td class=3D"line-number" value=3D"2350"></td><td class=3D"line-c=
ontent">                html +=3D `&lt;button class=3D"btn btn-xs ${active}=
 px-3" onclick=3D"switchHospitalTab('${key}')"&gt;${(slide.tabs[key].label =
|| key).toUpperCase()}&lt;/button&gt;`;</td></tr><tr><td class=3D"line-numb=
er" value=3D"2351"></td><td class=3D"line-content">            });</td></tr=
><tr><td class=3D"line-number" value=3D"2352"></td><td class=3D"line-conten=
t">            html +=3D `&lt;button class=3D"btn btn-xs btn-ghost text-sec=
ondary" onclick=3D"addHospitalTab()"&gt;+&lt;/button&gt;`;</td></tr><tr><td=
 class=3D"line-number" value=3D"2353"></td><td class=3D"line-content">     =
       nav.innerHTML =3D html;</td></tr><tr><td class=3D"line-number" value=
=3D"2354"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"2355"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2356"></td><td class=3D"line-cont=
ent">        function switchHospitalTab(key) {</td></tr><tr><td class=3D"li=
ne-number" value=3D"2357"></td><td class=3D"line-content">            saveH=
ospitalChanges(); // Save current before switching</td></tr><tr><td class=
=3D"line-number" value=3D"2358"></td><td class=3D"line-content">           =
 activeTabKey =3D key;</td></tr><tr><td class=3D"line-number" value=3D"2359=
"></td><td class=3D"line-content">            loadSlideEditor(currentEditin=
gSlideIndex);</td></tr><tr><td class=3D"line-number" value=3D"2360"></td><t=
d class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" v=
alue=3D"2361"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2362"></td><td class=3D"line-content">        fun=
ction addHospitalTab() {</td></tr><tr><td class=3D"line-number" value=3D"23=
63"></td><td class=3D"line-content">            const slide =3D accumulated=
Data.slides[currentEditingSlideIndex];</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2364"></td><td class=3D"line-content">            const name =
=3D prompt("Enter tab label (e.g. Intel, Map, Bio):");</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2365"></td><td class=3D"line-content">         =
   if (!name) return;</td></tr><tr><td class=3D"line-number" value=3D"2366"=
></td><td class=3D"line-content">            const key =3D name.toLowerCase=
().replace(/\s/g, '_');</td></tr><tr><td class=3D"line-number" value=3D"236=
7"></td><td class=3D"line-content">            slide.tabs[key] =3D { label:=
 name, body: "" };</td></tr><tr><td class=3D"line-number" value=3D"2368"></=
td><td class=3D"line-content">            switchHospitalTab(key);</td></tr>=
<tr><td class=3D"line-number" value=3D"2369"></td><td class=3D"line-content=
">        }</td></tr><tr><td class=3D"line-number" value=3D"2370"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"2371"></td><td class=3D"line-content">        function initQuill(content) =
{</td></tr><tr><td class=3D"line-number" value=3D"2372"></td><td class=3D"l=
ine-content">            const container =3D document.getElementById('quill=
-editor');</td></tr><tr><td class=3D"line-number" value=3D"2373"></td><td c=
lass=3D"line-content">            if (!container) return;</td></tr><tr><td =
class=3D"line-number" value=3D"2374"></td><td class=3D"line-content">      =
      container.innerHTML =3D '';</td></tr><tr><td class=3D"line-number" va=
lue=3D"2375"></td><td class=3D"line-content">            const editorDiv =
=3D document.createElement('div');</td></tr><tr><td class=3D"line-number" v=
alue=3D"2376"></td><td class=3D"line-content">            container.appendC=
hild(editorDiv);</td></tr><tr><td class=3D"line-number" value=3D"2377"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"2378"></td><td class=3D"line-content">            quill =3D new Quill=
(editorDiv, {</td></tr><tr><td class=3D"line-number" value=3D"2379"></td><t=
d class=3D"line-content">                theme: 'snow',</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2380"></td><td class=3D"line-content">        =
        modules: {</td></tr><tr><td class=3D"line-number" value=3D"2381"></=
td><td class=3D"line-content">                    toolbar: [</td></tr><tr><=
td class=3D"line-number" value=3D"2382"></td><td class=3D"line-content">   =
                     [{ 'header': [1, 2, false] }],</td></tr><tr><td class=
=3D"line-number" value=3D"2383"></td><td class=3D"line-content">           =
             ['bold', 'italic', 'underline'],</td></tr><tr><td class=3D"lin=
e-number" value=3D"2384"></td><td class=3D"line-content">                  =
      ['link', 'blockquote', 'code-block'],</td></tr><tr><td class=3D"line-=
number" value=3D"2385"></td><td class=3D"line-content">                    =
    [{ 'list': 'ordered' }, { 'list': 'bullet' }]</td></tr><tr><td class=3D=
"line-number" value=3D"2386"></td><td class=3D"line-content">              =
      ]</td></tr><tr><td class=3D"line-number" value=3D"2387"></td><td clas=
s=3D"line-content">                }</td></tr><tr><td class=3D"line-number"=
 value=3D"2388"></td><td class=3D"line-content">            });</td></tr><t=
r><td class=3D"line-number" value=3D"2389"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"2390"></td><td class=
=3D"line-content">            quill.root.innerHTML =3D (typeof marked !=3D=
=3D 'undefined') ? marked.parse(content || "") : content;</td></tr><tr><td =
class=3D"line-number" value=3D"2391"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"2392"></td><td class=3D"line=
-content">            // Sync on change (Debounced slightly for performance=
)</td></tr><tr><td class=3D"line-number" value=3D"2393"></td><td class=3D"l=
ine-content">            quill.on('text-change', () =3D&gt; {</td></tr><tr>=
<td class=3D"line-number" value=3D"2394"></td><td class=3D"line-content">  =
              const html =3D quill.root.innerHTML;</td></tr><tr><td class=
=3D"line-number" value=3D"2395"></td><td class=3D"line-content">           =
     if (turndownService &amp;&amp; accumulatedData.slides[currentEditingSl=
ideIndex]) {</td></tr><tr><td class=3D"line-number" value=3D"2396"></td><td=
 class=3D"line-content">                    const md =3D turndownService.tu=
rndown(html);</td></tr><tr><td class=3D"line-number" value=3D"2397"></td><t=
d class=3D"line-content">                    accumulatedData.slides[current=
EditingSlideIndex].tabs[activeTabKey].body =3D md;</td></tr><tr><td class=
=3D"line-number" value=3D"2398"></td><td class=3D"line-content">           =
     }</td></tr><tr><td class=3D"line-number" value=3D"2399"></td><td class=
=3D"line-content">            });</td></tr><tr><td class=3D"line-number" va=
lue=3D"2400"></td><td class=3D"line-content">        }</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2401"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"2402"></td><td class=3D"line-co=
ntent">        function updateHospitalPreview(url) {</td></tr><tr><td class=
=3D"line-number" value=3D"2403"></td><td class=3D"line-content">           =
 const preview =3D document.getElementById('h-visual-preview');</td></tr><t=
r><td class=3D"line-number" value=3D"2404"></td><td class=3D"line-content">=
            if (!preview) return;</td></tr><tr><td class=3D"line-number" va=
lue=3D"2405"></td><td class=3D"line-content">            if (!url) {</td></=
tr><tr><td class=3D"line-number" value=3D"2406"></td><td class=3D"line-cont=
ent">                preview.innerHTML =3D '&lt;span class=3D"text-xs opaci=
ty-20 font-mono"&gt;NO SIGNAL&lt;/span&gt;';</td></tr><tr><td class=3D"line=
-number" value=3D"2407"></td><td class=3D"line-content">                ret=
urn;</td></tr><tr><td class=3D"line-number" value=3D"2408"></td><td class=
=3D"line-content">            }</td></tr><tr><td class=3D"line-number" valu=
e=3D"2409"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"2410"></td><td class=3D"line-content">            cons=
t ytMatch =3D url.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/watch\?=
v=3D|youtu\.be\/)([a-zA-Z0-9_-]{11})/);</td></tr><tr><td class=3D"line-numb=
er" value=3D"2411"></td><td class=3D"line-content">            const isPDF =
=3D url.toLowerCase().endsWith('.pdf');</td></tr><tr><td class=3D"line-numb=
er" value=3D"2412"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"2413"></td><td class=3D"line-content">        =
    if (ytMatch) {</td></tr><tr><td class=3D"line-number" value=3D"2414"></=
td><td class=3D"line-content">                preview.innerHTML =3D `&lt;if=
rame class=3D"w-full h-full" src=3D"https://www.youtube.com/embed/${ytMatch=
[1]}" frameborder=3D"0" allowfullscreen&gt;&lt;/iframe&gt;`;</td></tr><tr><=
td class=3D"line-number" value=3D"2415"></td><td class=3D"line-content">   =
         } else if (isPDF) {</td></tr><tr><td class=3D"line-number" value=
=3D"2416"></td><td class=3D"line-content">                preview.innerHTML=
 =3D `&lt;embed src=3D"${url}" type=3D"application/pdf" width=3D"100%" heig=
ht=3D"100%"&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"2417"></t=
d><td class=3D"line-content">            } else {</td></tr><tr><td class=3D=
"line-number" value=3D"2418"></td><td class=3D"line-content">              =
  preview.innerHTML =3D `&lt;img src=3D"${url}" class=3D"max-w-full max-h-f=
ull object-contain shadow-2xl" onerror=3D"this.src=3D'https://placehold.co/=
600x400/000/0af?text=3DSIGNAL+LOST'"&gt;`;</td></tr><tr><td class=3D"line-n=
umber" value=3D"2419"></td><td class=3D"line-content">            }</td></t=
r><tr><td class=3D"line-number" value=3D"2420"></td><td class=3D"line-conte=
nt">        }</td></tr><tr><td class=3D"line-number" value=3D"2421"></td><t=
d class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2422"></td><td class=3D"line-content">        function saveHospitalChan=
ges() {</td></tr><tr><td class=3D"line-number" value=3D"2423"></td><td clas=
s=3D"line-content">            if (currentEditingSlideIndex =3D=3D=3D -1 ||=
 !quill) return;</td></tr><tr><td class=3D"line-number" value=3D"2424"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"2425"></td><td class=3D"line-content">            const slide =3D acc=
umulatedData.slides[currentEditingSlideIndex];</td></tr><tr><td class=3D"li=
ne-number" value=3D"2426"></td><td class=3D"line-content">            const=
 tabData =3D slide.tabs[activeTabKey];</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2427"></td><td class=3D"line-content"><br></td></tr><tr><td cla=
ss=3D"line-number" value=3D"2428"></td><td class=3D"line-content">         =
   slide.title =3D document.getElementById('h-title').value;</td></tr><tr><=
td class=3D"line-number" value=3D"2429"></td><td class=3D"line-content">   =
         slide.visual =3D document.getElementById('h-visual-prompt').value;=
</td></tr><tr><td class=3D"line-number" value=3D"2430"></td><td class=3D"li=
ne-content">            slide.options =3D [</td></tr><tr><td class=3D"line-=
number" value=3D"2431"></td><td class=3D"line-content">                docu=
ment.getElementById('h-choice-a').value,</td></tr><tr><td class=3D"line-num=
ber" value=3D"2432"></td><td class=3D"line-content">                documen=
t.getElementById('h-choice-b').value</td></tr><tr><td class=3D"line-number"=
 value=3D"2433"></td><td class=3D"line-content">            ];</td></tr><tr=
><td class=3D"line-number" value=3D"2434"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"2435"></td><td class=3D=
"line-content">            tabData.image =3D document.getElementById('h-med=
ia-url').value;</td></tr><tr><td class=3D"line-number" value=3D"2436"></td>=
<td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" valu=
e=3D"2437"></td><td class=3D"line-content">            if (turndownService)=
 {</td></tr><tr><td class=3D"line-number" value=3D"2438"></td><td class=3D"=
line-content">                tabData.body =3D turndownService.turndown(qui=
ll.root.innerHTML);</td></tr><tr><td class=3D"line-number" value=3D"2439"><=
/td><td class=3D"line-content">            }</td></tr><tr><td class=3D"line=
-number" value=3D"2440"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"2441"></td><td class=3D"line-content">   =
         log(`Stabilized Node ${currentEditingSlideIndex + 1}: ${slide.titl=
e}`, 'success');</td></tr><tr><td class=3D"line-number" value=3D"2442"></td=
><td class=3D"line-content">            renderHospitalSidebar();</td></tr><=
tr><td class=3D"line-number" value=3D"2443"></td><td class=3D"line-content"=
>        }</td></tr><tr><td class=3D"line-number" value=3D"2444"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
2445"></td><td class=3D"line-content">        function addHospitalNode() {<=
/td></tr><tr><td class=3D"line-number" value=3D"2446"></td><td class=3D"lin=
e-content">            saveHospitalChanges();</td></tr><tr><td class=3D"lin=
e-number" value=3D"2447"></td><td class=3D"line-content">            accumu=
latedData.slides.push({</td></tr><tr><td class=3D"line-number" value=3D"244=
8"></td><td class=3D"line-content">                title: "NEW NODE",</td><=
/tr><tr><td class=3D"line-number" value=3D"2449"></td><td class=3D"line-con=
tent">                tabs: { primary: { label: "Main", body: "" } },</td><=
/tr><tr><td class=3D"line-number" value=3D"2450"></td><td class=3D"line-con=
tent">                visual: "",</td></tr><tr><td class=3D"line-number" va=
lue=3D"2451"></td><td class=3D"line-content">                options: ["", =
""]</td></tr><tr><td class=3D"line-number" value=3D"2452"></td><td class=3D=
"line-content">            });</td></tr><tr><td class=3D"line-number" value=
=3D"2453"></td><td class=3D"line-content">            renderHospitalSidebar=
();</td></tr><tr><td class=3D"line-number" value=3D"2454"></td><td class=3D=
"line-content">            loadSlideEditor(accumulatedData.slides.length - =
1);</td></tr><tr><td class=3D"line-number" value=3D"2455"></td><td class=3D=
"line-content">        }</td></tr><tr><td class=3D"line-number" value=3D"24=
56"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-num=
ber" value=3D"2457"></td><td class=3D"line-content">        function closeH=
ospital() {</td></tr><tr><td class=3D"line-number" value=3D"2458"></td><td =
class=3D"line-content">            document.getElementById('hospital_modal'=
).close();</td></tr><tr><td class=3D"line-number" value=3D"2459"></td><td c=
lass=3D"line-content">        }</td></tr><tr><td class=3D"line-number" valu=
e=3D"2460"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"2461"></td><td class=3D"line-content">        async fu=
nction deployMission() {</td></tr><tr><td class=3D"line-number" value=3D"24=
62"></td><td class=3D"line-content">            if (!confirm("CONFIRM DEPLO=
YMENT? This will compile the mission dossier.")) return;</td></tr><tr><td c=
lass=3D"line-number" value=3D"2463"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"2464"></td><td class=3D"line-=
content">            // Final Metadata Sync</td></tr><tr><td class=3D"line-=
number" value=3D"2465"></td><td class=3D"line-content">            updateMi=
ssionMetadata();</td></tr><tr><td class=3D"line-number" value=3D"2466"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"2467"></td><td class=3D"line-content">            // Sanitize (Strip =
base64)</td></tr><tr><td class=3D"line-number" value=3D"2468"></td><td clas=
s=3D"line-content">            const cleanedData =3D sanitizeForBirth(accum=
ulatedData);</td></tr><tr><td class=3D"line-number" value=3D"2469"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2470"></td><td class=3D"line-content">            // Generate minimal J=
SON structure</td></tr><tr><td class=3D"line-number" value=3D"2471"></td><t=
d class=3D"line-content">            const missionId =3D cleanedData.metada=
ta?.id || `MISSION_${Date.now().toString().slice(-6)}`;</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2472"></td><td class=3D"line-content"><br></td=
></tr><tr><td class=3D"line-number" value=3D"2473"></td><td class=3D"line-c=
ontent">            // Re-map slides to ensure consistent structure</td></t=
r><tr><td class=3D"line-number" value=3D"2474"></td><td class=3D"line-conte=
nt">            const slides =3D (cleanedData.slides || []).map(s =3D&gt; {=
</td></tr><tr><td class=3D"line-number" value=3D"2475"></td><td class=3D"li=
ne-content">                // Ensure tabs structure</td></tr><tr><td class=
=3D"line-number" value=3D"2476"></td><td class=3D"line-content">           =
     if (!s.tabs) s.tabs =3D { primary: { label: "Primary", content: s.cont=
ent || s.brief || "" }, intel: { label: "Intel", content: "" } };</td></tr>=
<tr><td class=3D"line-number" value=3D"2477"></td><td class=3D"line-content=
">                if (s.image &amp;&amp; !s.tabs.primary.image) s.tabs.prim=
ary.image =3D s.image;</td></tr><tr><td class=3D"line-number" value=3D"2478=
"></td><td class=3D"line-content">                return s;</td></tr><tr><t=
d class=3D"line-number" value=3D"2479"></td><td class=3D"line-content">    =
        });</td></tr><tr><td class=3D"line-number" value=3D"2480"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"2481"></td><td class=3D"line-content">            const finalData =3D {</t=
d></tr><tr><td class=3D"line-number" value=3D"2482"></td><td class=3D"line-=
content">                metadata: {</td></tr><tr><td class=3D"line-number"=
 value=3D"2483"></td><td class=3D"line-content">                    ...clea=
nedData.metadata,</td></tr><tr><td class=3D"line-number" value=3D"2484"></t=
d><td class=3D"line-content">                    id: missionId,</td></tr><t=
r><td class=3D"line-number" value=3D"2485"></td><td class=3D"line-content">=
                    author: googleUser?.email || "GUEST",</td></tr><tr><td =
class=3D"line-number" value=3D"2486"></td><td class=3D"line-content">      =
              created: new Date().toISOString()</td></tr><tr><td class=3D"l=
ine-number" value=3D"2487"></td><td class=3D"line-content">                =
},</td></tr><tr><td class=3D"line-number" value=3D"2488"></td><td class=3D"=
line-content">                history: BuilderHistory,</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2489"></td><td class=3D"line-content">         =
       slides: slides,</td></tr><tr><td class=3D"line-number" value=3D"2490=
"></td><td class=3D"line-content">                intelligenceGlossary: cle=
anedData.intelligenceGlossary || []</td></tr><tr><td class=3D"line-number" =
value=3D"2491"></td><td class=3D"line-content">            };</td></tr><tr>=
<td class=3D"line-number" value=3D"2492"></td><td class=3D"line-content"><b=
r></td></tr><tr><td class=3D"line-number" value=3D"2493"></td><td class=3D"=
line-content">            // 1. Cloud Save (if authenticated)</td></tr><tr>=
<td class=3D"line-number" value=3D"2494"></td><td class=3D"line-content">  =
          if (window.SupabaseBridge &amp;&amp; SupabaseBridge.client &amp;&=
amp; googleUser) {</td></tr><tr><td class=3D"line-number" value=3D"2495"></=
td><td class=3D"line-content">                try {</td></tr><tr><td class=
=3D"line-number" value=3D"2496"></td><td class=3D"line-content">           =
         log(`Uploading to Command Cloud: ${missionId}...`);</td></tr><tr><=
td class=3D"line-number" value=3D"2497"></td><td class=3D"line-content">   =
                 await SupabaseBridge.saveMission(missionId, finalData.meta=
data.title, finalData, googleUser.email);</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2498"></td><td class=3D"line-content">                    lo=
g("Cloud Upload Successful.", "success");</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2499"></td><td class=3D"line-content">                    ad=
dBuilderChat('ai', `**MISSION DEPLOYED TO CLOUD.**\nID: \`${missionId}\`\nT=
his mission is now live in your Library.`);</td></tr><tr><td class=3D"line-=
number" value=3D"2500"></td><td class=3D"line-content">                    =
fetchMissions(); // Update library UI</td></tr><tr><td class=3D"line-number=
" value=3D"2501"></td><td class=3D"line-content">                    return=
; // EXIT FUNCTION - Do not force local download on success</td></tr><tr><t=
d class=3D"line-number" value=3D"2502"></td><td class=3D"line-content">    =
            } catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"2=
503"></td><td class=3D"line-content">                    log(`Cloud Upload =
Failed: ${e.message}. Falling back to local storage.`, "error");</td></tr><=
tr><td class=3D"line-number" value=3D"2504"></td><td class=3D"line-content"=
>                    alert("Cloud upload failed. One moment, initiating loc=
al backup...");</td></tr><tr><td class=3D"line-number" value=3D"2505"></td>=
<td class=3D"line-content">                }</td></tr><tr><td class=3D"line=
-number" value=3D"2506"></td><td class=3D"line-content">            } else =
{</td></tr><tr><td class=3D"line-number" value=3D"2507"></td><td class=3D"l=
ine-content">                if (!googleUser) log("GUEST MODE: Saving local=
 copy only.", "warning");</td></tr><tr><td class=3D"line-number" value=3D"2=
508"></td><td class=3D"line-content">            }</td></tr><tr><td class=
=3D"line-number" value=3D"2509"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2510"></td><td class=3D"line-cont=
ent">            // 2. Download Blob (Fallback / Guest Mode)</td></tr><tr><=
td class=3D"line-number" value=3D"2511"></td><td class=3D"line-content">   =
         const blob =3D new Blob([JSON.stringify(finalData, null, 2)], { ty=
pe: 'application/json' });</td></tr><tr><td class=3D"line-number" value=3D"=
2512"></td><td class=3D"line-content">            const url =3D URL.createO=
bjectURL(blob);</td></tr><tr><td class=3D"line-number" value=3D"2513"></td>=
<td class=3D"line-content">            const a =3D document.createElement('=
a');</td></tr><tr><td class=3D"line-number" value=3D"2514"></td><td class=
=3D"line-content">            a.href =3D url;</td></tr><tr><td class=3D"lin=
e-number" value=3D"2515"></td><td class=3D"line-content">            a.down=
load =3D `${missionId}.blob`;</td></tr><tr><td class=3D"line-number" value=
=3D"2516"></td><td class=3D"line-content">            document.body.appendC=
hild(a);</td></tr><tr><td class=3D"line-number" value=3D"2517"></td><td cla=
ss=3D"line-content">            a.click();</td></tr><tr><td class=3D"line-n=
umber" value=3D"2518"></td><td class=3D"line-content">            document.=
body.removeChild(a);</td></tr><tr><td class=3D"line-number" value=3D"2519">=
</td><td class=3D"line-content">            URL.revokeObjectURL(url);</td><=
/tr><tr><td class=3D"line-number" value=3D"2520"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"2521"></td><td c=
lass=3D"line-content">            if (!googleUser) log(`Mission Deployed Lo=
cally: ${missionId}`, 'success');</td></tr><tr><td class=3D"line-number" va=
lue=3D"2522"></td><td class=3D"line-content">        }</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2523"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"2524"></td><td class=3D"line-co=
ntent">        // --- IDEA SAVE/LOAD SYSTEM ---</td></tr><tr><td class=3D"l=
ine-number" value=3D"2525"></td><td class=3D"line-content">        async fu=
nction saveIdea() {</td></tr><tr><td class=3D"line-number" value=3D"2526"><=
/td><td class=3D"line-content">            const teacherId =3D googleUser?.=
email || 'GUEST';</td></tr><tr><td class=3D"line-number" value=3D"2527"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"2528"></td><td class=3D"line-content">            // Prompt for idea=
 name</td></tr><tr><td class=3D"line-number" value=3D"2529"></td><td class=
=3D"line-content">            const defaultName =3D accumulatedData?.metada=
ta?.title || `Idea_${Date.now()}`;</td></tr><tr><td class=3D"line-number" v=
alue=3D"2530"></td><td class=3D"line-content">            const ideaName =
=3D window.prompt("Name this idea (for later reference):", defaultName);</t=
d></tr><tr><td class=3D"line-number" value=3D"2531"></td><td class=3D"line-=
content">            if (!ideaName) return;</td></tr><tr><td class=3D"line-=
number" value=3D"2532"></td><td class=3D"line-content"><br></td></tr><tr><t=
d class=3D"line-number" value=3D"2533"></td><td class=3D"line-content">    =
        const ideaId =3D `IDEA_${Date.now()}`;</td></tr><tr><td class=3D"li=
ne-number" value=3D"2534"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"2535"></td><td class=3D"line-content"> =
           // Capture full Builder state</td></tr><tr><td class=3D"line-num=
ber" value=3D"2536"></td><td class=3D"line-content">            const ideaD=
ata =3D {</td></tr><tr><td class=3D"line-number" value=3D"2537"></td><td cl=
ass=3D"line-content">                name: ideaName,</td></tr><tr><td class=
=3D"line-number" value=3D"2538"></td><td class=3D"line-content">           =
     savedAt: new Date().toISOString(),</td></tr><tr><td class=3D"line-numb=
er" value=3D"2539"></td><td class=3D"line-content">                BuilderH=
istory: BuilderHistory,</td></tr><tr><td class=3D"line-number" value=3D"254=
0"></td><td class=3D"line-content">                currentPhaseIndex: curre=
ntPhaseIndex,</td></tr><tr><td class=3D"line-number" value=3D"2541"></td><t=
d class=3D"line-content">                accumulatedData: accumulatedData,<=
/td></tr><tr><td class=3D"line-number" value=3D"2542"></td><td class=3D"lin=
e-content">                curriculum: {</td></tr><tr><td class=3D"line-num=
ber" value=3D"2543"></td><td class=3D"line-content">                    cou=
ntry: document.getElementById('f-country')?.value || '',</td></tr><tr><td c=
lass=3D"line-number" value=3D"2544"></td><td class=3D"line-content">       =
             region: document.getElementById('f-region')?.value || '',</td>=
</tr><tr><td class=3D"line-number" value=3D"2545"></td><td class=3D"line-co=
ntent">                    course: document.getElementById('f-course')?.val=
ue || '',</td></tr><tr><td class=3D"line-number" value=3D"2546"></td><td cl=
ass=3D"line-content">                    selectedOutcomes: Array.from(docum=
ent.querySelectorAll('#f-outcomes input:checked')).map(c =3D&gt; c.value)</=
td></tr><tr><td class=3D"line-number" value=3D"2547"></td><td class=3D"line=
-content">                },</td></tr><tr><td class=3D"line-number" value=
=3D"2548"></td><td class=3D"line-content">                settings: {</td><=
/tr><tr><td class=3D"line-number" value=3D"2549"></td><td class=3D"line-con=
tent">                    model: document.getElementById('f-model')?.value =
|| 'google/gemini-2.0-flash-exp:free',</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2550"></td><td class=3D"line-content">                    compl=
exity: 'Medium'</td></tr><tr><td class=3D"line-number" value=3D"2551"></td>=
<td class=3D"line-content">                }</td></tr><tr><td class=3D"line=
-number" value=3D"2552"></td><td class=3D"line-content">            };</td>=
</tr><tr><td class=3D"line-number" value=3D"2553"></td><td class=3D"line-co=
ntent"><br></td></tr><tr><td class=3D"line-number" value=3D"2554"></td><td =
class=3D"line-content">            try {</td></tr><tr><td class=3D"line-num=
ber" value=3D"2555"></td><td class=3D"line-content">                await S=
upabaseBridge.saveIdea(ideaId, teacherId, ideaData);</td></tr><tr><td class=
=3D"line-number" value=3D"2556"></td><td class=3D"line-content">           =
     log(`IDEA SAVED: "${ideaName}" [${ideaId}]`, 'success');</td></tr><tr>=
<td class=3D"line-number" value=3D"2557"></td><td class=3D"line-content">  =
              addBuilderChat('ai', `=F0=9F=92=BE **Idea Saved!** You can cl=
ose this session and resume later via "LOAD IDEA".`);</td></tr><tr><td clas=
s=3D"line-number" value=3D"2558"></td><td class=3D"line-content">          =
  } catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"2559"></td>=
<td class=3D"line-content">                log(`IDEA SAVE FAILED: ${e.messa=
ge}`, 'error');</td></tr><tr><td class=3D"line-number" value=3D"2560"></td>=
<td class=3D"line-content">                alert(`Failed to save idea: ${e.=
message}`);</td></tr><tr><td class=3D"line-number" value=3D"2561"></td><td =
class=3D"line-content">            }</td></tr><tr><td class=3D"line-number"=
 value=3D"2562"></td><td class=3D"line-content">        }</td></tr><tr><td =
class=3D"line-number" value=3D"2563"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"2564"></td><td class=3D"line=
-content">        async function openIdeaLoader() {</td></tr><tr><td class=
=3D"line-number" value=3D"2565"></td><td class=3D"line-content">           =
 const teacherId =3D googleUser?.email || 'GUEST';</td></tr><tr><td class=
=3D"line-number" value=3D"2566"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2567"></td><td class=3D"line-cont=
ent">            try {</td></tr><tr><td class=3D"line-number" value=3D"2568=
"></td><td class=3D"line-content">                const ideas =3D await Sup=
abaseBridge.fetchIdeas(teacherId);</td></tr><tr><td class=3D"line-number" v=
alue=3D"2569"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2570"></td><td class=3D"line-content">           =
     if (!ideas || ideas.length =3D=3D=3D 0) {</td></tr><tr><td class=3D"li=
ne-number" value=3D"2571"></td><td class=3D"line-content">                 =
   alert("No saved ideas found. Start creating and use SAVE IDEA to preserv=
e your progress.");</td></tr><tr><td class=3D"line-number" value=3D"2572"><=
/td><td class=3D"line-content">                    return;</td></tr><tr><td=
 class=3D"line-number" value=3D"2573"></td><td class=3D"line-content">     =
           }</td></tr><tr><td class=3D"line-number" value=3D"2574"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2575"></td><td class=3D"line-content">                // Build selectio=
n list</td></tr><tr><td class=3D"line-number" value=3D"2576"></td><td class=
=3D"line-content">                let msg =3D "SAVED IDEAS:\n\n";</td></tr>=
<tr><td class=3D"line-number" value=3D"2577"></td><td class=3D"line-content=
">                ideas.forEach((idea, i) =3D&gt; {</td></tr><tr><td class=
=3D"line-number" value=3D"2578"></td><td class=3D"line-content">           =
         const date =3D new Date(idea.updated_at || idea.updated).toLocaleD=
ateString();</td></tr><tr><td class=3D"line-number" value=3D"2579"></td><td=
 class=3D"line-content">                    msg +=3D `${i + 1}. ${idea.name=
} (${date})\n`;</td></tr><tr><td class=3D"line-number" value=3D"2580"></td>=
<td class=3D"line-content">                });</td></tr><tr><td class=3D"li=
ne-number" value=3D"2581"></td><td class=3D"line-content">                m=
sg +=3D "\nEnter the number to load, or 0 to cancel:";</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2582"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"2583"></td><td class=3D"line-co=
ntent">                const selection =3D window.prompt(msg);</td></tr><tr=
><td class=3D"line-number" value=3D"2584"></td><td class=3D"line-content"> =
               if (!selection || selection =3D=3D=3D '0') return;</td></tr>=
<tr><td class=3D"line-number" value=3D"2585"></td><td class=3D"line-content=
"><br></td></tr><tr><td class=3D"line-number" value=3D"2586"></td><td class=
=3D"line-content">                const idx =3D parseInt(selection) - 1;</t=
d></tr><tr><td class=3D"line-number" value=3D"2587"></td><td class=3D"line-=
content">                if (idx &lt; 0 || idx &gt;=3D ideas.length) {</td>=
</tr><tr><td class=3D"line-number" value=3D"2588"></td><td class=3D"line-co=
ntent">                    alert("Invalid selection.");</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2589"></td><td class=3D"line-content">        =
            return;</td></tr><tr><td class=3D"line-number" value=3D"2590"><=
/td><td class=3D"line-content">                }</td></tr><tr><td class=3D"=
line-number" value=3D"2591"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"2592"></td><td class=3D"line-content"=
>                await loadIdea(ideas[idx].id, teacherId);</td></tr><tr><td=
 class=3D"line-number" value=3D"2593"></td><td class=3D"line-content">     =
       } catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"2594">=
</td><td class=3D"line-content">                log(`IDEA LOAD FAILED: ${e.=
message}`, 'error');</td></tr><tr><td class=3D"line-number" value=3D"2595">=
</td><td class=3D"line-content">                alert(`Failed to load ideas=
: ${e.message}`);</td></tr><tr><td class=3D"line-number" value=3D"2596"></t=
d><td class=3D"line-content">            }</td></tr><tr><td class=3D"line-n=
umber" value=3D"2597"></td><td class=3D"line-content">        }</td></tr><t=
r><td class=3D"line-number" value=3D"2598"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"2599"></td><td class=
=3D"line-content">        async function loadIdea(ideaId, teacherId) {</td>=
</tr><tr><td class=3D"line-number" value=3D"2600"></td><td class=3D"line-co=
ntent">            try {</td></tr><tr><td class=3D"line-number" value=3D"26=
01"></td><td class=3D"line-content">                const ideaData =3D awai=
t SupabaseBridge.loadIdea(ideaId, teacherId);</td></tr><tr><td class=3D"lin=
e-number" value=3D"2602"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"2603"></td><td class=3D"line-content">  =
              if (!ideaData) {</td></tr><tr><td class=3D"line-number" value=
=3D"2604"></td><td class=3D"line-content">                    alert("Idea d=
ata not found.");</td></tr><tr><td class=3D"line-number" value=3D"2605"></t=
d><td class=3D"line-content">                    return;</td></tr><tr><td c=
lass=3D"line-number" value=3D"2606"></td><td class=3D"line-content">       =
         }</td></tr><tr><td class=3D"line-number" value=3D"2607"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
2608"></td><td class=3D"line-content">                // Restore Builder st=
ate</td></tr><tr><td class=3D"line-number" value=3D"2609"></td><td class=3D=
"line-content">                BuilderHistory =3D ideaData.BuilderHistory |=
| [];</td></tr><tr><td class=3D"line-number" value=3D"2610"></td><td class=
=3D"line-content">                currentPhaseIndex =3D ideaData.currentPha=
seIndex || 0;</td></tr><tr><td class=3D"line-number" value=3D"2611"></td><t=
d class=3D"line-content">                accumulatedData =3D ideaData.accum=
ulatedData || {};</td></tr><tr><td class=3D"line-number" value=3D"2612"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"2613"></td><td class=3D"line-content">                // Restore cur=
riculum selections</td></tr><tr><td class=3D"line-number" value=3D"2614"></=
td><td class=3D"line-content">                if (ideaData.curriculum) {</t=
d></tr><tr><td class=3D"line-number" value=3D"2615"></td><td class=3D"line-=
content">                    const c =3D ideaData.curriculum;</td></tr><tr>=
<td class=3D"line-number" value=3D"2616"></td><td class=3D"line-content">  =
                  if (c.country &amp;&amp; document.getElementById('f-count=
ry')) {</td></tr><tr><td class=3D"line-number" value=3D"2617"></td><td clas=
s=3D"line-content">                        document.getElementById('f-count=
ry').value =3D c.country;</td></tr><tr><td class=3D"line-number" value=3D"2=
618"></td><td class=3D"line-content">                        updateBuilderR=
egions();</td></tr><tr><td class=3D"line-number" value=3D"2619"></td><td cl=
ass=3D"line-content">                        setTimeout(() =3D&gt; {</td></=
tr><tr><td class=3D"line-number" value=3D"2620"></td><td class=3D"line-cont=
ent">                            if (c.region &amp;&amp; document.getElemen=
tById('f-region')) {</td></tr><tr><td class=3D"line-number" value=3D"2621">=
</td><td class=3D"line-content">                                document.ge=
tElementById('f-region').value =3D c.region;</td></tr><tr><td class=3D"line=
-number" value=3D"2622"></td><td class=3D"line-content">                   =
             updateBuilderCourses();</td></tr><tr><td class=3D"line-number"=
 value=3D"2623"></td><td class=3D"line-content">                           =
     setTimeout(() =3D&gt; {</td></tr><tr><td class=3D"line-number" value=
=3D"2624"></td><td class=3D"line-content">                                 =
   if (c.course &amp;&amp; document.getElementById('f-course')) {</td></tr>=
<tr><td class=3D"line-number" value=3D"2625"></td><td class=3D"line-content=
">                                        document.getElementById('f-course=
').value =3D c.course;</td></tr><tr><td class=3D"line-number" value=3D"2626=
"></td><td class=3D"line-content">                                        u=
pdateBuilderOutcomes();</td></tr><tr><td class=3D"line-number" value=3D"262=
7"></td><td class=3D"line-content">                                    }</t=
d></tr><tr><td class=3D"line-number" value=3D"2628"></td><td class=3D"line-=
content">                                }, 100);</td></tr><tr><td class=3D=
"line-number" value=3D"2629"></td><td class=3D"line-content">              =
              }</td></tr><tr><td class=3D"line-number" value=3D"2630"></td>=
<td class=3D"line-content">                        }, 100);</td></tr><tr><t=
d class=3D"line-number" value=3D"2631"></td><td class=3D"line-content">    =
                }</td></tr><tr><td class=3D"line-number" value=3D"2632"></t=
d><td class=3D"line-content">                }</td></tr><tr><td class=3D"li=
ne-number" value=3D"2633"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"2634"></td><td class=3D"line-content"> =
               // Restore Model Selection</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2635"></td><td class=3D"line-content">                if (id=
eaData.settings?.model &amp;&amp; document.getElementById('f-model')) {</td=
></tr><tr><td class=3D"line-number" value=3D"2636"></td><td class=3D"line-c=
ontent">                    document.getElementById('f-model').value =3D id=
eaData.settings.model;</td></tr><tr><td class=3D"line-number" value=3D"2637=
"></td><td class=3D"line-content">                }</td></tr><tr><td class=
=3D"line-number" value=3D"2638"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2639"></td><td class=3D"line-cont=
ent">                // Refresh UI</td></tr><tr><td class=3D"line-number" v=
alue=3D"2640"></td><td class=3D"line-content">                renderPipelin=
eStepper();</td></tr><tr><td class=3D"line-number" value=3D"2641"></td><td =
class=3D"line-content">                updateBuilderUI();</td></tr><tr><td =
class=3D"line-number" value=3D"2642"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"2643"></td><td class=3D"line=
-content">                // Refresh Chat</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2644"></td><td class=3D"line-content">                const =
chat =3D document.getElementById('Builder-chat');</td></tr><tr><td class=3D=
"line-number" value=3D"2645"></td><td class=3D"line-content">              =
  chat.innerHTML =3D '';</td></tr><tr><td class=3D"line-number" value=3D"26=
46"></td><td class=3D"line-content">                BuilderHistory.forEach(=
m =3D&gt; addBuilderChat(m.role =3D=3D=3D 'user' ? 'user' : 'ai', m.content=
));</td></tr><tr><td class=3D"line-number" value=3D"2647"></td><td class=3D=
"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2648"><=
/td><td class=3D"line-content">                log(`LOADED IDEA: ${ideaId}`=
, 'success');</td></tr><tr><td class=3D"line-number" value=3D"2649"></td><t=
d class=3D"line-content">                addBuilderChat('ai', `=F0=9F=94=84=
 **Session Restored.** Current Phase: ${getCurrentPhase().label.toUpperCase=
()}`);</td></tr><tr><td class=3D"line-number" value=3D"2650"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2651=
"></td><td class=3D"line-content">            } catch (e) {</td></tr><tr><t=
d class=3D"line-number" value=3D"2652"></td><td class=3D"line-content">    =
            log(`LOAD ERROR: ${e.message}`, 'error');</td></tr><tr><td clas=
s=3D"line-number" value=3D"2653"></td><td class=3D"line-content">          =
      alert(`Failed to restore session: ${e.message}`);</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2654"></td><td class=3D"line-content">        =
    }</td></tr><tr><td class=3D"line-number" value=3D"2655"></td><td class=
=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=3D=
"2656"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-=
number" value=3D"2657"></td><td class=3D"line-content">        function ren=
derBirthScreen(outputArea) {</td></tr><tr><td class=3D"line-number" value=
=3D"2658"></td><td class=3D"line-content">            const missionId =3D a=
ccumulatedData?.metadata?.id || `MISSION_${Date.now().toString().slice(-6)}=
`;</td></tr><tr><td class=3D"line-number" value=3D"2659"></td><td class=3D"=
line-content">            const missionTitle =3D accumulatedData?.metadata?=
.title || `MISSION_${new Date().toLocaleDateString()}`;</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2660"></td><td class=3D"line-content"><br></td=
></tr><tr><td class=3D"line-number" value=3D"2661"></td><td class=3D"line-c=
ontent">            outputArea.innerHTML =3D `</td></tr><tr><td class=3D"li=
ne-number" value=3D"2662"></td><td class=3D"line-content">                &=
lt;div class=3D"p-6 h-full overflow-y-auto bg-base-300"&gt;</td></tr><tr><t=
d class=3D"line-number" value=3D"2663"></td><td class=3D"line-content">    =
                &lt;div class=3D"max-w-4xl mx-auto space-y-6"&gt;</td></tr>=
<tr><td class=3D"line-number" value=3D"2664"></td><td class=3D"line-content=
">                        &lt;div class=3D"card bg-base-100 shadow-2xl bord=
er border-primary/30"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2=
665"></td><td class=3D"line-content">                            &lt;div cl=
ass=3D"card-body"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2666"=
></td><td class=3D"line-content">                                &lt;h2 cla=
ss=3D"card-title text-2xl font-display tracking-widest text-primary flex it=
ems-center gap-3"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2667"=
></td><td class=3D"line-content">                                    &lt;sv=
g xmlns=3D"http://www.w3.org/2000/svg" class=3D"h-6 w-6" fill=3D"none" view=
Box=3D"0 0 24 24" stroke=3D"currentColor"&gt;</td></tr><tr><td class=3D"lin=
e-number" value=3D"2668"></td><td class=3D"line-content">                  =
                      &lt;path stroke-linecap=3D"round" stroke-linejoin=3D"=
round" stroke-width=3D"2" d=3D"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 01=
12 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10=
.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"2669"></td><td class=3D=
"line-content">                                    &lt;/svg&gt;</td></tr><t=
r><td class=3D"line-number" value=3D"2670"></td><td class=3D"line-content">=
                                    MISSION FINAL ASSEMBLY</td></tr><tr><td=
 class=3D"line-number" value=3D"2671"></td><td class=3D"line-content">     =
                           &lt;/h2&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2672"></td><td class=3D"line-content">                         =
       &lt;p class=3D"text-xs opacity-60 font-mono italic"&gt;Validating en=
crypted dossier for tactical deployment.&lt;/p&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2673"></td><td class=3D"line-content">           =
                     </td></tr><tr><td class=3D"line-number" value=3D"2674"=
></td><td class=3D"line-content">                                &lt;div cl=
ass=3D"grid grid-cols-1 md:grid-cols-2 gap-8 mt-6"&gt;</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2675"></td><td class=3D"line-content">         =
                           &lt;div class=3D"space-y-6"&gt;</td></tr><tr><td=
 class=3D"line-number" value=3D"2676"></td><td class=3D"line-content">     =
                                   &lt;div class=3D"space-y-4"&gt;</td></tr=
><tr><td class=3D"line-number" value=3D"2677"></td><td class=3D"line-conten=
t">                                            &lt;div class=3D"form-contro=
l"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2678"></td><td class=
=3D"line-content">                                                &lt;label=
 class=3D"label py-1"&gt;&lt;span class=3D"label-text text-[10px] font-bold=
 opacity-50 uppercase"&gt;Mission Callsign (Title)&lt;/span&gt;&lt;/label&g=
t;</td></tr><tr><td class=3D"line-number" value=3D"2679"></td><td class=3D"=
line-content">                                                &lt;input id=
=3D"birth-mission-title" type=3D"text" class=3D"input input-bordered input-=
sm font-mono text-xs" value=3D"${missionTitle}" onchange=3D"updateMissionMe=
tadata()"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2680"></td><t=
d class=3D"line-content">                                            &lt;/d=
iv&gt;</td></tr><tr><td class=3D"line-number" value=3D"2681"></td><td class=
=3D"line-content">                                            &lt;div class=
=3D"form-control"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2682"=
></td><td class=3D"line-content">                                          =
      &lt;label class=3D"label py-1"&gt;&lt;span class=3D"label-text text-[=
10px] font-bold opacity-50 uppercase"&gt;Strategic Identifier (ID)&lt;/span=
&gt;&lt;/label&gt;</td></tr><tr><td class=3D"line-number" value=3D"2683"></=
td><td class=3D"line-content">                                             =
   &lt;input id=3D"birth-mission-id" type=3D"text" class=3D"input input-bor=
dered input-sm font-mono text-xs" value=3D"${missionId}" onchange=3D"update=
MissionMetadata()"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2684=
"></td><td class=3D"line-content">                                         =
   &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2685"></td>=
<td class=3D"line-content">                                        &lt;/div=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"2686"></td><td class=
=3D"line-content">                                        </td></tr><tr><td=
 class=3D"line-number" value=3D"2687"></td><td class=3D"line-content">     =
                                   &lt;div class=3D"p-4 bg-black/20 rounded=
 border border-white/5"&gt;</td></tr><tr><td class=3D"line-number" value=3D=
"2688"></td><td class=3D"line-content">                                    =
        &lt;h4 class=3D"text-[10px] font-bold opacity-50 uppercase mb-3 tra=
cking-widest"&gt;Integrity Report&lt;/h4&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"2689"></td><td class=3D"line-content">                   =
                         &lt;div id=3D"birth-validation" class=3D"space-y-2=
 font-mono text-[11px]"&gt;</td></tr><tr><td class=3D"line-number" value=3D=
"2690"></td><td class=3D"line-content">                                    =
            &lt;!-- JS Loaded --&gt;</td></tr><tr><td class=3D"line-number"=
 value=3D"2691"></td><td class=3D"line-content">                           =
                 &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2692"></td><td class=3D"line-content">                                 =
       &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2693"><=
/td><td class=3D"line-content">                                    &lt;/div=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"2694"></td><td class=
=3D"line-content">                                    </td></tr><tr><td cla=
ss=3D"line-number" value=3D"2695"></td><td class=3D"line-content">         =
                           &lt;div class=3D"flex flex-col h-full"&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"2696"></td><td class=3D"line-con=
tent">                                        &lt;label class=3D"label py-1=
"&gt;&lt;span class=3D"label-text text-[10px] font-bold opacity-50 uppercas=
e"&gt;Dossier Data Preview (JSON)&lt;/span&gt;&lt;/label&gt;</td></tr><tr><=
td class=3D"line-number" value=3D"2697"></td><td class=3D"line-content">   =
                                     &lt;div class=3D"bg-black shadow-inner=
 rounded p-4 font-mono text-[9px] flex-1 overflow-auto max-h-[350px] border=
 border-white/5 scrollbar-thin"&gt;</td></tr><tr><td class=3D"line-number" =
value=3D"2698"></td><td class=3D"line-content">                            =
                &lt;pre id=3D"birth-json-preview" class=3D"text-success/80"=
&gt;${JSON.stringify(accumulatedData, null, 2)}&lt;/pre&gt;</td></tr><tr><t=
d class=3D"line-number" value=3D"2699"></td><td class=3D"line-content">    =
                                    &lt;/div&gt;</td></tr><tr><td class=3D"=
line-number" value=3D"2700"></td><td class=3D"line-content">               =
                     &lt;/div&gt;</td></tr><tr><td class=3D"line-number" va=
lue=3D"2701"></td><td class=3D"line-content">                              =
  &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2702"></td><=
td class=3D"line-content">                            &lt;/div&gt;</td></tr=
><tr><td class=3D"line-number" value=3D"2703"></td><td class=3D"line-conten=
t">                        &lt;/div&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"2704"></td><td class=3D"line-content">                        =
</td></tr><tr><td class=3D"line-number" value=3D"2705"></td><td class=3D"li=
ne-content">                        &lt;!-- Birth Action Buttons --&gt;</td=
></tr><tr><td class=3D"line-number" value=3D"2706"></td><td class=3D"line-c=
ontent">                        &lt;div class=3D"card bg-base-100 shadow-xl=
 border border-secondary/20"&gt;</td></tr><tr><td class=3D"line-number" val=
ue=3D"2707"></td><td class=3D"line-content">                            &lt=
;div class=3D"card-body p-4"&gt;</td></tr><tr><td class=3D"line-number" val=
ue=3D"2708"></td><td class=3D"line-content">                               =
 &lt;h3 class=3D"text-xs font-bold uppercase opacity-50 tracking-widest mb-=
3"&gt;Deployment Operations&lt;/h3&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2709"></td><td class=3D"line-content">                         =
       &lt;div class=3D"flex flex-wrap gap-3"&gt;</td></tr><tr><td class=3D=
"line-number" value=3D"2710"></td><td class=3D"line-content">              =
                      &lt;button class=3D"btn btn-outline btn-secondary btn=
-sm flex-1 gap-2" onclick=3D"birthMission()"&gt;</td></tr><tr><td class=3D"=
line-number" value=3D"2711"></td><td class=3D"line-content">               =
                         &lt;svg xmlns=3D"http://www.w3.org/2000/svg" class=
=3D"h-4 w-4" fill=3D"none" viewBox=3D"0 0 24 24" stroke=3D"currentColor"&gt=
;</td></tr><tr><td class=3D"line-number" value=3D"2712"></td><td class=3D"l=
ine-content">                                            &lt;path stroke-li=
necap=3D"round" stroke-linejoin=3D"round" stroke-width=3D"2" d=3D"M9.663 17=
h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m=
2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4=
 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" /&gt;</td></tr><tr><td c=
lass=3D"line-number" value=3D"2713"></td><td class=3D"line-content">       =
                                 &lt;/svg&gt;</td></tr><tr><td class=3D"lin=
e-number" value=3D"2714"></td><td class=3D"line-content">                  =
                      AI STRUCTURE</td></tr><tr><td class=3D"line-number" v=
alue=3D"2715"></td><td class=3D"line-content">                             =
       &lt;/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"2716=
"></td><td class=3D"line-content">                                    &lt;b=
utton class=3D"btn btn-outline btn-accent btn-sm flex-1 gap-2" onclick=3D"d=
ownloadBirthedBlob()"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2=
717"></td><td class=3D"line-content">                                      =
  &lt;svg xmlns=3D"http://www.w3.org/2000/svg" class=3D"h-4 w-4" fill=3D"no=
ne" viewBox=3D"0 0 24 24" stroke=3D"currentColor"&gt;</td></tr><tr><td clas=
s=3D"line-number" value=3D"2718"></td><td class=3D"line-content">          =
                                  &lt;path stroke-linecap=3D"round" stroke-=
linejoin=3D"round" stroke-width=3D"2" d=3D"M4 16v1a3 3 0 003 3h10a3 3 0 003=
-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /&gt;</td></tr><tr><td class=3D"line-number=
" value=3D"2719"></td><td class=3D"line-content">                          =
              &lt;/svg&gt;</td></tr><tr><td class=3D"line-number" value=3D"=
2720"></td><td class=3D"line-content">                                     =
   DOWNLOAD .BLOB</td></tr><tr><td class=3D"line-number" value=3D"2721"></t=
d><td class=3D"line-content">                                    &lt;/butto=
n&gt;</td></tr><tr><td class=3D"line-number" value=3D"2722"></td><td class=
=3D"line-content">                                    &lt;button class=3D"b=
tn btn-primary btn-sm flex-1 gap-2" onclick=3D"deployMission()"&gt;</td></t=
r><tr><td class=3D"line-number" value=3D"2723"></td><td class=3D"line-conte=
nt">                                        &lt;svg xmlns=3D"http://www.w3.=
org/2000/svg" class=3D"h-4 w-4" fill=3D"none" viewBox=3D"0 0 24 24" stroke=
=3D"currentColor"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2724"=
></td><td class=3D"line-content">                                          =
  &lt;path stroke-linecap=3D"round" stroke-linejoin=3D"round" stroke-width=
=3D"2" d=3D"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 1=
3l-3-3m0 0l-3 3m3-3v12" /&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2725"></td><td class=3D"line-content">                                 =
       &lt;/svg&gt;</td></tr><tr><td class=3D"line-number" value=3D"2726"><=
/td><td class=3D"line-content">                                        DEPL=
OY TO CLOUD</td></tr><tr><td class=3D"line-number" value=3D"2727"></td><td =
class=3D"line-content">                                    &lt;/button&gt;<=
/td></tr><tr><td class=3D"line-number" value=3D"2728"></td><td class=3D"lin=
e-content">                                    &lt;button class=3D"btn btn-=
ghost btn-sm gap-1 opacity-70" onclick=3D"openHospital()"&gt;</td></tr><tr>=
<td class=3D"line-number" value=3D"2729"></td><td class=3D"line-content">  =
                                      &lt;svg xmlns=3D"http://www.w3.org/20=
00/svg" class=3D"h-4 w-4" fill=3D"none" viewBox=3D"0 0 24 24" stroke=3D"cur=
rentColor"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2730"></td><=
td class=3D"line-content">                                            &lt;p=
ath stroke-linecap=3D"round" stroke-linejoin=3D"round" stroke-width=3D"2" d=
=3D"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 =
0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /&gt;</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2731"></td><td class=3D"line-content">         =
                               &lt;/svg&gt;</td></tr><tr><td class=3D"line-=
number" value=3D"2732"></td><td class=3D"line-content">                    =
                    Manual Edit</td></tr><tr><td class=3D"line-number" valu=
e=3D"2733"></td><td class=3D"line-content">                                =
    &lt;/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"2734"><=
/td><td class=3D"line-content">                                &lt;/div&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"2735"></td><td class=3D"li=
ne-content">                            &lt;/div&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2736"></td><td class=3D"line-content">           =
             &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2=
737"></td><td class=3D"line-content">                    &lt;/div&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"2738"></td><td class=3D"line-con=
tent">                &lt;/div&gt;</td></tr><tr><td class=3D"line-number" v=
alue=3D"2739"></td><td class=3D"line-content">            `;</td></tr><tr><=
td class=3D"line-number" value=3D"2740"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"2741"></td><td class=3D"l=
ine-content">            updateValidationMark();</td></tr><tr><td class=3D"=
line-number" value=3D"2742"></td><td class=3D"line-content">        }</td><=
/tr><tr><td class=3D"line-number" value=3D"2743"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"2744"></td><td c=
lass=3D"line-content">        function updateValidationMark() {</td></tr><t=
r><td class=3D"line-number" value=3D"2745"></td><td class=3D"line-content">=
            const validationEl =3D document.getElementById('birth-validatio=
n');</td></tr><tr><td class=3D"line-number" value=3D"2746"></td><td class=
=3D"line-content">            if (!validationEl) return;</td></tr><tr><td c=
lass=3D"line-number" value=3D"2747"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"2748"></td><td class=3D"line-=
content">            const slides =3D accumulatedData?.slides || [];</td></=
tr><tr><td class=3D"line-number" value=3D"2749"></td><td class=3D"line-cont=
ent">            const metadata =3D accumulatedData?.metadata || {};</td></=
tr><tr><td class=3D"line-number" value=3D"2750"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"2751"></td><td cl=
ass=3D"line-content">            let html =3D '';</td></tr><tr><td class=3D=
"line-number" value=3D"2752"></td><td class=3D"line-content"><br></td></tr>=
<tr><td class=3D"line-number" value=3D"2753"></td><td class=3D"line-content=
">            const check =3D (label, pass, info) =3D&gt; {</td></tr><tr><t=
d class=3D"line-number" value=3D"2754"></td><td class=3D"line-content">    =
            const icon =3D pass ? '=E2=9C=93' : '=E2=9C=97';</td></tr><tr><=
td class=3D"line-number" value=3D"2755"></td><td class=3D"line-content">   =
             const color =3D pass ? 'text-success' : 'text-error';</td></tr=
><tr><td class=3D"line-number" value=3D"2756"></td><td class=3D"line-conten=
t">                return `&lt;div class=3D"flex justify-between items-cent=
er ${color}"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2757"></td=
><td class=3D"line-content">                    &lt;span&gt;${icon} ${label=
}&lt;/span&gt;</td></tr><tr><td class=3D"line-number" value=3D"2758"></td><=
td class=3D"line-content">                    &lt;span class=3D"opacity-50 =
text-[9px]"&gt;${info}&lt;/span&gt;</td></tr><tr><td class=3D"line-number" =
value=3D"2759"></td><td class=3D"line-content">                &lt;/div&gt;=
`;</td></tr><tr><td class=3D"line-number" value=3D"2760"></td><td class=3D"=
line-content">            };</td></tr><tr><td class=3D"line-number" value=
=3D"2761"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"2762"></td><td class=3D"line-content">            html =
+=3D check('MISSION TITLE', !!metadata.title, metadata.title ? 'VERIFIED' :=
 'MISSING');</td></tr><tr><td class=3D"line-number" value=3D"2763"></td><td=
 class=3D"line-content">            html +=3D check('SLIDE CAPACITY', slide=
s.length &gt;=3D 10, `${slides.length}/10 NODES`);</td></tr><tr><td class=
=3D"line-number" value=3D"2764"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"2765"></td><td class=3D"line-cont=
ent">            let imgCount =3D 0;</td></tr><tr><td class=3D"line-number"=
 value=3D"2766"></td><td class=3D"line-content">            slides.forEach(=
s =3D&gt; { if (s.image || s.tabs?.primary?.image) imgCount++; });</td></tr=
><tr><td class=3D"line-number" value=3D"2767"></td><td class=3D"line-conten=
t">            html +=3D check('VISUAL ASSETS', imgCount &gt;=3D 10, `${img=
Count}/10 LOADED`);</td></tr><tr><td class=3D"line-number" value=3D"2768"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"2769"></td><td class=3D"line-content">            const hasGlossar=
y =3D Array.isArray(accumulatedData?.intelligenceGlossary) &amp;&amp; accum=
ulatedData.intelligenceGlossary.length &gt; 0;</td></tr><tr><td class=3D"li=
ne-number" value=3D"2770"></td><td class=3D"line-content">            html =
+=3D check('INTEL GLOSSARY', hasGlossary, hasGlossary ? 'ACTIVE' : 'NONE');=
</td></tr><tr><td class=3D"line-number" value=3D"2771"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2772"></td=
><td class=3D"line-content">            validationEl.innerHTML =3D html;</t=
d></tr><tr><td class=3D"line-number" value=3D"2773"></td><td class=3D"line-=
content">        }</td></tr><tr><td class=3D"line-number" value=3D"2774"></=
td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" v=
alue=3D"2775"></td><td class=3D"line-content">        function updateMissio=
nMetadata() {</td></tr><tr><td class=3D"line-number" value=3D"2776"></td><t=
d class=3D"line-content">            const title =3D document.getElementByI=
d('birth-mission-title')?.value?.trim();</td></tr><tr><td class=3D"line-num=
ber" value=3D"2777"></td><td class=3D"line-content">            const id =
=3D document.getElementById('birth-mission-id')?.value?.trim();</td></tr><t=
r><td class=3D"line-number" value=3D"2778"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"2779"></td><td class=
=3D"line-content">            if (!accumulatedData.metadata) accumulatedDat=
a.metadata =3D {};</td></tr><tr><td class=3D"line-number" value=3D"2780"></=
td><td class=3D"line-content">            if (title) accumulatedData.metada=
ta.title =3D title;</td></tr><tr><td class=3D"line-number" value=3D"2781"><=
/td><td class=3D"line-content">            if (id) accumulatedData.metadata=
.id =3D id;</td></tr><tr><td class=3D"line-number" value=3D"2782"></td><td =
class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D=
"2783"></td><td class=3D"line-content">            // Update JSON preview i=
f visible</td></tr><tr><td class=3D"line-number" value=3D"2784"></td><td cl=
ass=3D"line-content">            const preview =3D document.getElementById(=
'birth-json-preview');</td></tr><tr><td class=3D"line-number" value=3D"2785=
"></td><td class=3D"line-content">            if (preview) preview.textCont=
ent =3D JSON.stringify(accumulatedData, null, 2);</td></tr><tr><td class=3D=
"line-number" value=3D"2786"></td><td class=3D"line-content"><br></td></tr>=
<tr><td class=3D"line-number" value=3D"2787"></td><td class=3D"line-content=
">            updateValidationMark();</td></tr><tr><td class=3D"line-number=
" value=3D"2788"></td><td class=3D"line-content">            log('Mission i=
dentifiers synchronized.', 'info');</td></tr><tr><td class=3D"line-number" =
value=3D"2789"></td><td class=3D"line-content">        }</td></tr><tr><td c=
lass=3D"line-number" value=3D"2790"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"2791"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"2792"></td><t=
d class=3D"line-content">        // --- CLASS DIRECTORY LOGIC ---</td></tr>=
<tr><td class=3D"line-number" value=3D"2793"></td><td class=3D"line-content=
">        async function refreshClasses() {</td></tr><tr><td class=3D"line-=
number" value=3D"2794"></td><td class=3D"line-content">            // Mock =
data if Supabase offline</td></tr><tr><td class=3D"line-number" value=3D"27=
95"></td><td class=3D"line-content">            // if (!SupabaseBridge.clie=
nt) {</td></tr><tr><td class=3D"line-number" value=3D"2796"></td><td class=
=3D"line-content">            //     renderClasses([]);</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2797"></td><td class=3D"line-content">        =
    //     return;</td></tr><tr><td class=3D"line-number" value=3D"2798"></=
td><td class=3D"line-content">            // }</td></tr><tr><td class=3D"li=
ne-number" value=3D"2799"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"2800"></td><td class=3D"line-content"> =
           try {</td></tr><tr><td class=3D"line-number" value=3D"2801"></td=
><td class=3D"line-content">                const classes =3D await Supabas=
eBridge.fetchClasses(googleUser?.email || 'GUEST');</td></tr><tr><td class=
=3D"line-number" value=3D"2802"></td><td class=3D"line-content">           =
     window.activeClassesData =3D classes; // Store for local updates</td><=
/tr><tr><td class=3D"line-number" value=3D"2803"></td><td class=3D"line-con=
tent">                renderClasses(classes);</td></tr><tr><td class=3D"lin=
e-number" value=3D"2804"></td><td class=3D"line-content">            } catc=
h (e) {</td></tr><tr><td class=3D"line-number" value=3D"2805"></td><td clas=
s=3D"line-content">                log("Class Sync Failed: " + e.message, "=
error");</td></tr><tr><td class=3D"line-number" value=3D"2806"></td><td cla=
ss=3D"line-content">            }</td></tr><tr><td class=3D"line-number" va=
lue=3D"2807"></td><td class=3D"line-content">        }</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2808"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"2809"></td><td class=3D"line-co=
ntent">        function renderClasses(classes) {</td></tr><tr><td class=3D"=
line-number" value=3D"2810"></td><td class=3D"line-content">            con=
st tbody =3D document.getElementById('class-directory-list-body');</td></tr=
><tr><td class=3D"line-number" value=3D"2811"></td><td class=3D"line-conten=
t">            if (!tbody) return;</td></tr><tr><td class=3D"line-number" v=
alue=3D"2812"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2813"></td><td class=3D"line-content">           =
 if (!classes.length) {</td></tr><tr><td class=3D"line-number" value=3D"281=
4"></td><td class=3D"line-content">                tbody.innerHTML =3D `&lt=
;tr&gt;&lt;td colspan=3D"5" class=3D"text-center opacity-50 py-8"&gt;No act=
ive classes found. Create one to begin.&lt;/td&gt;&lt;/tr&gt;`;</td></tr><t=
r><td class=3D"line-number" value=3D"2815"></td><td class=3D"line-content">=
                return;</td></tr><tr><td class=3D"line-number" value=3D"281=
6"></td><td class=3D"line-content">            }</td></tr><tr><td class=3D"=
line-number" value=3D"2817"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"2818"></td><td class=3D"line-content"=
>            let html =3D '';</td></tr><tr><td class=3D"line-number" value=
=3D"2819"></td><td class=3D"line-content">            classes.forEach(c =3D=
&gt; {</td></tr><tr><td class=3D"line-number" value=3D"2820"></td><td class=
=3D"line-content">                const isFav =3D c.is_favorite ? 'text-err=
or fill-current' : 'text-base-content/20 hover:text-error';</td></tr><tr><t=
d class=3D"line-number" value=3D"2821"></td><td class=3D"line-content">    =
            html +=3D `</td></tr><tr><td class=3D"line-number" value=3D"282=
2"></td><td class=3D"line-content">                &lt;tr class=3D"hover tr=
ansition-colors group"&gt;</td></tr><tr><td class=3D"line-number" value=3D"=
2823"></td><td class=3D"line-content">                    &lt;td&gt;</td></=
tr><tr><td class=3D"line-number" value=3D"2824"></td><td class=3D"line-cont=
ent">                        &lt;div class=3D"flex items-center gap-2"&gt;<=
/td></tr><tr><td class=3D"line-number" value=3D"2825"></td><td class=3D"lin=
e-content">                            &lt;button onclick=3D"toggleFavorite=
Class('${c.id}')" class=3D"btn btn-ghost btn-xs ${isFav}"&gt;</td></tr><tr>=
<td class=3D"line-number" value=3D"2826"></td><td class=3D"line-content">  =
                              &lt;svg xmlns=3D"http://www.w3.org/2000/svg" =
class=3D"h-4 w-4" viewBox=3D"0 0 20 20" fill=3D"currentColor"&gt;&lt;path f=
ill-rule=3D"evenodd" d=3D"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171=
a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule=3D"=
evenodd" /&gt;&lt;/svg&gt;</td></tr><tr><td class=3D"line-number" value=3D"=
2827"></td><td class=3D"line-content">                            &lt;/butt=
on&gt;</td></tr><tr><td class=3D"line-number" value=3D"2828"></td><td class=
=3D"line-content">                            &lt;span class=3D"font-bold t=
ext-primary"&gt;${c.class_name}&lt;/span&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"2829"></td><td class=3D"line-content">                   =
     &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2830"></t=
d><td class=3D"line-content">                    &lt;/td&gt;</td></tr><tr><=
td class=3D"line-number" value=3D"2831"></td><td class=3D"line-content">   =
                 &lt;td&gt;</td></tr><tr><td class=3D"line-number" value=3D=
"2832"></td><td class=3D"line-content">                        &lt;div clas=
s=3D"badge badge-lg badge-neutral font-mono tracking-widest text-accent"&gt=
;${c.passcode}&lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"=
2833"></td><td class=3D"line-content">                    &lt;/td&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"2834"></td><td class=3D"line-con=
tent">                    &lt;td&gt;</td></tr><tr><td class=3D"line-number"=
 value=3D"2835"></td><td class=3D"line-content">                        &lt=
;div class=3D"flex items-center gap-2"&gt;</td></tr><tr><td class=3D"line-n=
umber" value=3D"2836"></td><td class=3D"line-content">                     =
        &lt;svg xmlns=3D"http://www.w3.org/2000/svg" class=3D"h-4 w-4 opaci=
ty-50" viewBox=3D"0 0 20 20" fill=3D"currentColor"&gt;&lt;path d=3D"M9 6a3 =
3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.0=
7-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v=
1H1v-1a5 5 0 015-5z" /&gt;&lt;/svg&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2837"></td><td class=3D"line-content">                         =
    ${c.student_count || 0}</td></tr><tr><td class=3D"line-number" value=3D=
"2838"></td><td class=3D"line-content">                        &lt;/div&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"2839"></td><td class=3D"li=
ne-content">                    &lt;/td&gt;</td></tr><tr><td class=3D"line-=
number" value=3D"2840"></td><td class=3D"line-content">                    =
&lt;td&gt;</td></tr><tr><td class=3D"line-number" value=3D"2841"></td><td c=
lass=3D"line-content">                        &lt;div class=3D"tooltip" dat=
a-tip=3D"Click to Manage Missions"&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"2842"></td><td class=3D"line-content">                         =
    &lt;button class=3D"btn btn-xs btn-ghost gap-2" onclick=3D"assignMissio=
nUI('${c.id}')"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2843"><=
/td><td class=3D"line-content">                                &lt;span cla=
ss=3D"badge badge-sm badge-primary badge-outline"&gt;${(c.mission_ids || []=
).length}&lt;/span&gt;</td></tr><tr><td class=3D"line-number" value=3D"2844=
"></td><td class=3D"line-content">                                &lt;span =
class=3D"text-[0.6rem] opacity-50 uppercase tracking-wider group-hover:opac=
ity-100 transition-opacity"&gt;Assign&lt;/span&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2845"></td><td class=3D"line-content">           =
                  &lt;/button&gt;</td></tr><tr><td class=3D"line-number" va=
lue=3D"2846"></td><td class=3D"line-content">                        &lt;/d=
iv&gt;</td></tr><tr><td class=3D"line-number" value=3D"2847"></td><td class=
=3D"line-content">                    &lt;/td&gt;</td></tr><tr><td class=3D=
"line-number" value=3D"2848"></td><td class=3D"line-content">              =
      &lt;td&gt;</td></tr><tr><td class=3D"line-number" value=3D"2849"></td=
><td class=3D"line-content">                        &lt;div class=3D"join"&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"2850"></td><td class=3D=
"line-content">                            &lt;button class=3D"btn btn-xs b=
tn-outline join-item" onclick=3D"editClassUI('${c.id}')"&gt;Rename&lt;/butt=
on&gt;</td></tr><tr><td class=3D"line-number" value=3D"2851"></td><td class=
=3D"line-content">                            &lt;button class=3D"btn btn-x=
s btn-outline join-item" onclick=3D"manageStudentsUI('${c.passcode}')"&gt;R=
oster&lt;/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"2852">=
</td><td class=3D"line-content">                            &lt;button clas=
s=3D"btn btn-xs btn-error btn-outline join-item" onclick=3D"deleteClassUI('=
${c.id}')"&gt;X&lt;/button&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"2853"></td><td class=3D"line-content">                        &lt;/div&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"2854"></td><td class=3D=
"line-content">                    &lt;/td&gt;</td></tr><tr><td class=3D"li=
ne-number" value=3D"2855"></td><td class=3D"line-content">                &=
lt;/tr&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"2856"></td><td=
 class=3D"line-content">            });</td></tr><tr><td class=3D"line-numb=
er" value=3D"2857"></td><td class=3D"line-content">            tbody.innerH=
TML =3D html;</td></tr><tr><td class=3D"line-number" value=3D"2858"></td><t=
d class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" v=
alue=3D"2859"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2860"></td><td class=3D"line-content">        // =
--- LIBRARY LOGIC ---</td></tr><tr><td class=3D"line-number" value=3D"2861"=
></td><td class=3D"line-content">        async function fetchMissions() {</=
td></tr><tr><td class=3D"line-number" value=3D"2862"></td><td class=3D"line=
-content">            log("Syncing Archive...", "info");</td></tr><tr><td c=
lass=3D"line-number" value=3D"2863"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"2864"></td><td class=3D"line-=
content">            // Define samples for GUEST/OFFLINE mode only</td></tr=
><tr><td class=3D"line-number" value=3D"2865"></td><td class=3D"line-conten=
t">            const sampleMissions =3D [</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2866"></td><td class=3D"line-content">                { id: =
"SAMPLE-01", name: "Cuban Missile Crisis", description: "Naval blockade sim=
ulation sample.", thumb: "https://images.unsplash.com/photo-1599839575945-a=
9e5af0c3fa5?auto=3Dformat&amp;fit=3Dcrop&amp;q=3D80&amp;w=3D200" },</td></t=
r><tr><td class=3D"line-number" value=3D"2867"></td><td class=3D"line-conte=
nt">                { id: "SAMPLE-02", name: "Mars Colony v1", description:=
 "Resource management failure scenario sample.", thumb: "https://images.uns=
plash.com/photo-1614728853970-32a2f51d15d6?auto=3Dformat&amp;fit=3Dcrop&amp=
;q=3D80&amp;w=3D200" }</td></tr><tr><td class=3D"line-number" value=3D"2868=
"></td><td class=3D"line-content">            ];</td></tr><tr><td class=3D"=
line-number" value=3D"2869"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"2870"></td><td class=3D"line-content"=
>            const currentTeacher =3D googleUser?.email || TEACHER_HANDLE |=
| 'GUEST';</td></tr><tr><td class=3D"line-number" value=3D"2871"></td><td c=
lass=3D"line-content">            const isGuest =3D currentTeacher =3D=3D=
=3D 'GUEST';</td></tr><tr><td class=3D"line-number" value=3D"2872"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"2873"></td><td class=3D"line-content">            if (SupabaseBridge.cl=
ient &amp;&amp; !isGuest) {</td></tr><tr><td class=3D"line-number" value=3D=
"2874"></td><td class=3D"line-content">                try {</td></tr><tr><=
td class=3D"line-number" value=3D"2875"></td><td class=3D"line-content">   =
                 const realMissions =3D await SupabaseBridge.fetchMissions(=
currentTeacher);</td></tr><tr><td class=3D"line-number" value=3D"2876"></td=
><td class=3D"line-content">                    currentMissions =3D realMis=
sions;</td></tr><tr><td class=3D"line-number" value=3D"2877"></td><td class=
=3D"line-content">                    log(`Archive Synced. Found ${currentM=
issions.length} dossiers.`, "success");</td></tr><tr><td class=3D"line-numb=
er" value=3D"2878"></td><td class=3D"line-content">                } catch =
(e) {</td></tr><tr><td class=3D"line-number" value=3D"2879"></td><td class=
=3D"line-content">                    log(`Archive Sync Failed: ${e.message=
}`, "error");</td></tr><tr><td class=3D"line-number" value=3D"2880"></td><t=
d class=3D"line-content">                    currentMissions =3D [];</td></=
tr><tr><td class=3D"line-number" value=3D"2881"></td><td class=3D"line-cont=
ent">                }</td></tr><tr><td class=3D"line-number" value=3D"2882=
"></td><td class=3D"line-content">            } else {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"2883"></td><td class=3D"line-content">         =
       // Not logged in or no Supabase -&gt; Show samples</td></tr><tr><td =
class=3D"line-number" value=3D"2884"></td><td class=3D"line-content">      =
          currentMissions =3D sampleMissions;</td></tr><tr><td class=3D"lin=
e-number" value=3D"2885"></td><td class=3D"line-content">                if=
 (isGuest) log("Guest Mode: Viewing sample simulations.", "warning");</td><=
/tr><tr><td class=3D"line-number" value=3D"2886"></td><td class=3D"line-con=
tent">            }</td></tr><tr><td class=3D"line-number" value=3D"2887"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"2888"></td><td class=3D"line-content">            renderLibrary(cu=
rrentMissions);</td></tr><tr><td class=3D"line-number" value=3D"2889"></td>=
<td class=3D"line-content">        }</td></tr><tr><td class=3D"line-number"=
 value=3D"2890"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"2891"></td><td class=3D"line-content">        fun=
ction renderLibrary(missions) {</td></tr><tr><td class=3D"line-number" valu=
e=3D"2892"></td><td class=3D"line-content">            const grid =3D docum=
ent.getElementById('hub-grid');</td></tr><tr><td class=3D"line-number" valu=
e=3D"2893"></td><td class=3D"line-content">            if (!grid) return;</=
td></tr><tr><td class=3D"line-number" value=3D"2894"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2895"></td><=
td class=3D"line-content">            const isUserAdmin =3D (typeof googleU=
ser !=3D=3D 'undefined' &amp;&amp; googleUser?.email =3D=3D=3D 'dwaugh@gmai=
l.com');</td></tr><tr><td class=3D"line-number" value=3D"2896"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"28=
97"></td><td class=3D"line-content">            let html =3D '';</td></tr><=
tr><td class=3D"line-number" value=3D"2898"></td><td class=3D"line-content"=
>            missions.forEach(m =3D&gt; {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"2899"></td><td class=3D"line-content">                const =
isSample =3D m.id.startsWith('SAMPLE-');</td></tr><tr><td class=3D"line-num=
ber" value=3D"2900"></td><td class=3D"line-content">                const d=
eleteBtn =3D isSample ? '' : `&lt;button class=3D"btn btn-xs btn-error btn-=
outline opacity-0 group-hover:opacity-100 transition-opacity" onclick=3D"ev=
ent.stopPropagation(); deleteMission('${m.id}')"&gt;Delete&lt;/button&gt;`;=
</td></tr><tr><td class=3D"line-number" value=3D"2901"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2902"></td=
><td class=3D"line-content">                html +=3D `</td></tr><tr><td cl=
ass=3D"line-number" value=3D"2903"></td><td class=3D"line-content">        =
        &lt;div class=3D"card bg-base-100 shadow-xl image-full group cursor=
-pointer hover:scale-[1.02] transition-transform" onclick=3D"loadMission('$=
{m.id}')"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2904"></td><t=
d class=3D"line-content">                    &lt;figure&gt;&lt;img src=3D"$=
{m.thumb || 'https://images.unsplash.com/photo-1451187580459-43490279c0fa'}=
" alt=3D"Mission" class=3D"opacity-40 group-hover:opacity-60 transition-opa=
city w-full h-48 object-cover" /&gt;&lt;/figure&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2905"></td><td class=3D"line-content">           =
         &lt;div class=3D"card-body p-4 justify-between"&gt;</td></tr><tr><=
td class=3D"line-number" value=3D"2906"></td><td class=3D"line-content">   =
                     &lt;div&gt;</td></tr><tr><td class=3D"line-number" val=
ue=3D"2907"></td><td class=3D"line-content">                            &lt=
;div class=3D"flex justify-between items-start"&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"2908"></td><td class=3D"line-content">           =
                     &lt;h2 class=3D"card-title text-sm text-white tracking=
-wider mb-1 line-clamp-1"&gt;${m.name}&lt;/h2&gt;</td></tr><tr><td class=3D=
"line-number" value=3D"2909"></td><td class=3D"line-content">              =
                  ${deleteBtn}</td></tr><tr><td class=3D"line-number" value=
=3D"2910"></td><td class=3D"line-content">                            &lt;/=
div&gt;</td></tr><tr><td class=3D"line-number" value=3D"2911"></td><td clas=
s=3D"line-content">                            &lt;p class=3D"text-[10px] t=
ext-base-200/80 line-clamp-2"&gt;${m.description || "No description availab=
le."}&lt;/p&gt;</td></tr><tr><td class=3D"line-number" value=3D"2912"></td>=
<td class=3D"line-content">                        &lt;/div&gt;</td></tr><t=
r><td class=3D"line-number" value=3D"2913"></td><td class=3D"line-content">=
                        &lt;div class=3D"card-actions justify-between items=
-center mt-2"&gt;</td></tr><tr><td class=3D"line-number" value=3D"2914"></t=
d><td class=3D"line-content">                            &lt;div class=3D"b=
adge badge-xs badge-ghost font-mono opacity-50"&gt;${m.id}&lt;/div&gt;</td>=
</tr><tr><td class=3D"line-number" value=3D"2915"></td><td class=3D"line-co=
ntent">                            &lt;div class=3D"flex gap-2"&gt;</td></t=
r><tr><td class=3D"line-number" value=3D"2916"></td><td class=3D"line-conte=
nt">                                &lt;button class=3D"btn btn-xs btn-prim=
ary" onclick=3D"event.stopPropagation(); loadMission('${m.id}')"&gt;Load&lt=
;/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"2917"></td><td=
 class=3D"line-content">                            &lt;/div&gt;</td></tr><=
tr><td class=3D"line-number" value=3D"2918"></td><td class=3D"line-content"=
>                        &lt;/div&gt;</td></tr><tr><td class=3D"line-number=
" value=3D"2919"></td><td class=3D"line-content">                    &lt;/d=
iv&gt;</td></tr><tr><td class=3D"line-number" value=3D"2920"></td><td class=
=3D"line-content">                &lt;/div&gt;`;</td></tr><tr><td class=3D"=
line-number" value=3D"2921"></td><td class=3D"line-content">            });=
</td></tr><tr><td class=3D"line-number" value=3D"2922"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2923"></td=
><td class=3D"line-content">            if (!missions.length) html =3D `&lt=
;div class=3D"col-span-1 md:col-span-3 text-center opacity-50 p-10 font-mon=
o text-xs"&gt;NO MISSION DATA DETECTED IN ARCHIVE.&lt;/div&gt;`;</td></tr><=
tr><td class=3D"line-number" value=3D"2924"></td><td class=3D"line-content"=
>            grid.innerHTML =3D html;</td></tr><tr><td class=3D"line-number=
" value=3D"2925"></td><td class=3D"line-content">        }</td></tr><tr><td=
 class=3D"line-number" value=3D"2926"></td><td class=3D"line-content"><br><=
/td></tr><tr><td class=3D"line-number" value=3D"2927"></td><td class=3D"lin=
e-content">        async function handleFile(file) {</td></tr><tr><td class=
=3D"line-number" value=3D"2928"></td><td class=3D"line-content">           =
 if (!file) return;</td></tr><tr><td class=3D"line-number" value=3D"2929"><=
/td><td class=3D"line-content">            log(`Parsing local dossier: ${fi=
le.name}...`);</td></tr><tr><td class=3D"line-number" value=3D"2930"></td><=
td class=3D"line-content">            const reader =3D new FileReader();</t=
d></tr><tr><td class=3D"line-number" value=3D"2931"></td><td class=3D"line-=
content">            reader.onload =3D async (e) =3D&gt; {</td></tr><tr><td=
 class=3D"line-number" value=3D"2932"></td><td class=3D"line-content">     =
           try {</td></tr><tr><td class=3D"line-number" value=3D"2933"></td=
><td class=3D"line-content">                    const raw =3D e.target.resu=
lt.trim();</td></tr><tr><td class=3D"line-number" value=3D"2934"></td><td c=
lass=3D"line-content">                    // Robust Isolate: Find first { a=
nd last } to strip potential markdown or noise</td></tr><tr><td class=3D"li=
ne-number" value=3D"2935"></td><td class=3D"line-content">                 =
   const start =3D raw.indexOf('{');</td></tr><tr><td class=3D"line-number"=
 value=3D"2936"></td><td class=3D"line-content">                    const e=
nd =3D raw.lastIndexOf('}');</td></tr><tr><td class=3D"line-number" value=
=3D"2937"></td><td class=3D"line-content">                    if (start =3D=
=3D=3D -1 || end =3D=3D=3D -1) throw new Error("No JSON object found.");</t=
d></tr><tr><td class=3D"line-number" value=3D"2938"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"2939"></td><t=
d class=3D"line-content">                    const data =3D JSON.parse(raw.=
substring(start, end + 1));</td></tr><tr><td class=3D"line-number" value=3D=
"2940"></td><td class=3D"line-content">                    accumulatedData =
=3D data;</td></tr><tr><td class=3D"line-number" value=3D"2941"></td><td cl=
ass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"2=
942"></td><td class=3D"line-content">                    // POLYFILL: Handl=
e legacy blobs lacking 'metadata'</td></tr><tr><td class=3D"line-number" va=
lue=3D"2943"></td><td class=3D"line-content">                    if (!accum=
ulatedData.metadata) {</td></tr><tr><td class=3D"line-number" value=3D"2944=
"></td><td class=3D"line-content">                        accumulatedData.m=
etadata =3D {</td></tr><tr><td class=3D"line-number" value=3D"2945"></td><t=
d class=3D"line-content">                            id: data.id || `LEGACY=
_${Date.now()}`,</td></tr><tr><td class=3D"line-number" value=3D"2946"></td=
><td class=3D"line-content">                            title: data.title |=
| data.missionTitle || "Untitled Legacy Mission",</td></tr><tr><td class=3D=
"line-number" value=3D"2947"></td><td class=3D"line-content">              =
              author: data.author || "Unknown"</td></tr><tr><td class=3D"li=
ne-number" value=3D"2948"></td><td class=3D"line-content">                 =
       };</td></tr><tr><td class=3D"line-number" value=3D"2949"></td><td cl=
ass=3D"line-content">                    }</td></tr><tr><td class=3D"line-n=
umber" value=3D"2950"></td><td class=3D"line-content"><br></td></tr><tr><td=
 class=3D"line-number" value=3D"2951"></td><td class=3D"line-content">     =
               // Populate BuilderHistory if possible</td></tr><tr><td clas=
s=3D"line-number" value=3D"2952"></td><td class=3D"line-content">          =
          if (data.history) BuilderHistory =3D data.history;</td></tr><tr><=
td class=3D"line-number" value=3D"2953"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"2954"></td><td class=3D"l=
ine-content">                    log(`Legacy Dossier Loaded: ${accumulatedD=
ata.metadata.title}`, "success");</td></tr><tr><td class=3D"line-number" va=
lue=3D"2955"></td><td class=3D"line-content">                    alert(`Mis=
sion Loaded: ${accumulatedData.metadata.title}`);</td></tr><tr><td class=3D=
"line-number" value=3D"2956"></td><td class=3D"line-content"><br></td></tr>=
<tr><td class=3D"line-number" value=3D"2957"></td><td class=3D"line-content=
">                    // Switch to an active phase tab to show data</td></t=
r><tr><td class=3D"line-number" value=3D"2958"></td><td class=3D"line-conte=
nt">                    switchMainTab('Builder');</td></tr><tr><td class=3D=
"line-number" value=3D"2959"></td><td class=3D"line-content">              =
      updateBuilderUI();</td></tr><tr><td class=3D"line-number" value=3D"29=
60"></td><td class=3D"line-content">                } catch (err) {</td></t=
r><tr><td class=3D"line-number" value=3D"2961"></td><td class=3D"line-conte=
nt">                    log(`Parse Error: ${err.message}`, "error");</td></=
tr><tr><td class=3D"line-number" value=3D"2962"></td><td class=3D"line-cont=
ent">                    alert("Invalid Dossier format: " + err.message);</=
td></tr><tr><td class=3D"line-number" value=3D"2963"></td><td class=3D"line=
-content">                }</td></tr><tr><td class=3D"line-number" value=3D=
"2964"></td><td class=3D"line-content">            };</td></tr><tr><td clas=
s=3D"line-number" value=3D"2965"></td><td class=3D"line-content">          =
  reader.readAsText(file);</td></tr><tr><td class=3D"line-number" value=3D"=
2966"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"l=
ine-number" value=3D"2967"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"2968"></td><td class=3D"line-content">=
        async function deleteMission(id) {</td></tr><tr><td class=3D"line-n=
umber" value=3D"2969"></td><td class=3D"line-content">            const cur=
rentTeacher =3D googleUser?.email || TEACHER_HANDLE || 'GUEST';</td></tr><t=
r><td class=3D"line-number" value=3D"2970"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"2971"></td><td class=
=3D"line-content">            if (id.startsWith('SAMPLE-')) {</td></tr><tr>=
<td class=3D"line-number" value=3D"2972"></td><td class=3D"line-content">  =
              log("Local samples cannot be scrubbed from the factory archiv=
e.", "warning");</td></tr><tr><td class=3D"line-number" value=3D"2973"></td=
><td class=3D"line-content">                alert("Cannot delete factory sa=
mples.");</td></tr><tr><td class=3D"line-number" value=3D"2974"></td><td cl=
ass=3D"line-content">                return;</td></tr><tr><td class=3D"line=
-number" value=3D"2975"></td><td class=3D"line-content">            }</td><=
/tr><tr><td class=3D"line-number" value=3D"2976"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"2977"></td><td c=
lass=3D"line-content">            if (!confirm(`PERMANENT DELETION: Are you=
 sure you want to scrub mission [${id}] from the record?`)) return;</td></t=
r><tr><td class=3D"line-number" value=3D"2978"></td><td class=3D"line-conte=
nt"><br></td></tr><tr><td class=3D"line-number" value=3D"2979"></td><td cla=
ss=3D"line-content">            log(`SCRUBBING MISSION [${id}]...`);</td></=
tr><tr><td class=3D"line-number" value=3D"2980"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"2981"></td><td cl=
ass=3D"line-content">            if (window.SupabaseBridge &amp;&amp; Supab=
aseBridge.client) {</td></tr><tr><td class=3D"line-number" value=3D"2982"><=
/td><td class=3D"line-content">                try {</td></tr><tr><td class=
=3D"line-number" value=3D"2983"></td><td class=3D"line-content">           =
         await SupabaseBridge.deleteMission(id, currentTeacher);</td></tr><=
tr><td class=3D"line-number" value=3D"2984"></td><td class=3D"line-content"=
>                    log(`Mission scrubbed from cloud: ${id}`, "success");<=
/td></tr><tr><td class=3D"line-number" value=3D"2985"></td><td class=3D"lin=
e-content">                    fetchMissions();</td></tr><tr><td class=3D"l=
ine-number" value=3D"2986"></td><td class=3D"line-content">                =
} catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"2987"></td><t=
d class=3D"line-content">                    log(`Deletion Failed: ${e.mess=
age}`, "error");</td></tr><tr><td class=3D"line-number" value=3D"2988"></td=
><td class=3D"line-content">                }</td></tr><tr><td class=3D"lin=
e-number" value=3D"2989"></td><td class=3D"line-content">            } else=
 {</td></tr><tr><td class=3D"line-number" value=3D"2990"></td><td class=3D"=
line-content">                log("Supabase not configured. Cannot delete f=
rom cloud.", "error");</td></tr><tr><td class=3D"line-number" value=3D"2991=
"></td><td class=3D"line-content">            }</td></tr><tr><td class=3D"l=
ine-number" value=3D"2992"></td><td class=3D"line-content">        }</td></=
tr><tr><td class=3D"line-number" value=3D"2993"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"2994"></td><td cl=
ass=3D"line-content">        // --- CURRICULUM CONTEXT ---</td></tr><tr><td=
 class=3D"line-number" value=3D"2995"></td><td class=3D"line-content">     =
   // --- CURRICULUM CONTEXT ---</td></tr><tr><td class=3D"line-number" val=
ue=3D"2996"></td><td class=3D"line-content">        async function fetchCur=
riculum() {</td></tr><tr><td class=3D"line-number" value=3D"2997"></td><td =
class=3D"line-content">            console.log("fetchCurriculum: Initiating=
 load...");</td></tr><tr><td class=3D"line-number" value=3D"2998"></td><td =
class=3D"line-content">            log("Synchronizing Curriculum Hub...");<=
/td></tr><tr><td class=3D"line-number" value=3D"2999"></td><td class=3D"lin=
e-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3000"></td>=
<td class=3D"line-content">            // 1. Load static curriculum.json (f=
ast, cached)</td></tr><tr><td class=3D"line-number" value=3D"3001"></td><td=
 class=3D"line-content">            try {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3002"></td><td class=3D"line-content">                consol=
e.log("fetchCurriculum: Fetching curriculum.json");</td></tr><tr><td class=
=3D"line-number" value=3D"3003"></td><td class=3D"line-content">           =
     const res =3D await fetch("curriculum.json?v=3D" + Date.now());</td></=
tr><tr><td class=3D"line-number" value=3D"3004"></td><td class=3D"line-cont=
ent">                if (res.ok) {</td></tr><tr><td class=3D"line-number" v=
alue=3D"3005"></td><td class=3D"line-content">                    window.cu=
rriculumData =3D await res.json();</td></tr><tr><td class=3D"line-number" v=
alue=3D"3006"></td><td class=3D"line-content">                    console.l=
og("fetchCurriculum: Local data loaded.", Object.keys(window.curriculumData=
));</td></tr><tr><td class=3D"line-number" value=3D"3007"></td><td class=3D=
"line-content">                    log("Local Curriculum Loaded.", "success=
");</td></tr><tr><td class=3D"line-number" value=3D"3008"></td><td class=3D=
"line-content">                } else {</td></tr><tr><td class=3D"line-numb=
er" value=3D"3009"></td><td class=3D"line-content">                    cons=
ole.warn("fetchCurriculum: curriculum.json fetch failed", res.status);</td>=
</tr><tr><td class=3D"line-number" value=3D"3010"></td><td class=3D"line-co=
ntent">                    window.curriculumData =3D window.curriculumData =
|| {};</td></tr><tr><td class=3D"line-number" value=3D"3011"></td><td class=
=3D"line-content">                }</td></tr><tr><td class=3D"line-number" =
value=3D"3012"></td><td class=3D"line-content">            } catch (err) {<=
/td></tr><tr><td class=3D"line-number" value=3D"3013"></td><td class=3D"lin=
e-content">                console.warn("Local Curriculum Fetch Skipped (li=
kely CORS or offline):", err);</td></tr><tr><td class=3D"line-number" value=
=3D"3014"></td><td class=3D"line-content">                window.curriculum=
Data =3D window.curriculumData || {};</td></tr><tr><td class=3D"line-number=
" value=3D"3015"></td><td class=3D"line-content">            }</td></tr><tr=
><td class=3D"line-number" value=3D"3016"></td><td class=3D"line-content"><=
br></td></tr><tr><td class=3D"line-number" value=3D"3017"></td><td class=3D=
"line-content">            // 2. Fetch from Supabase (extended library)</td=
></tr><tr><td class=3D"line-number" value=3D"3018"></td><td class=3D"line-c=
ontent">            if (window.SupabaseBridge &amp;&amp; SupabaseBridge.cli=
ent) {</td></tr><tr><td class=3D"line-number" value=3D"3019"></td><td class=
=3D"line-content">                try {</td></tr><tr><td class=3D"line-numb=
er" value=3D"3020"></td><td class=3D"line-content">                    cons=
t outcomes =3D await SupabaseBridge.fetchAllOutcomes();</td></tr><tr><td cl=
ass=3D"line-number" value=3D"3021"></td><td class=3D"line-content">        =
            outcomes.forEach(o =3D&gt; {</td></tr><tr><td class=3D"line-num=
ber" value=3D"3022"></td><td class=3D"line-content">                       =
 if (!window.curriculumData[o.country]) window.curriculumData[o.country] =
=3D {};</td></tr><tr><td class=3D"line-number" value=3D"3023"></td><td clas=
s=3D"line-content">                        if (!window.curriculumData[o.cou=
ntry][o.region]) window.curriculumData[o.country][o.region] =3D {};</td></t=
r><tr><td class=3D"line-number" value=3D"3024"></td><td class=3D"line-conte=
nt">                        if (!window.curriculumData[o.country][o.region]=
[o.course]) window.curriculumData[o.country][o.region][o.course] =3D [];</t=
d></tr><tr><td class=3D"line-number" value=3D"3025"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"3026"></td><t=
d class=3D"line-content">                        let target =3D window.curr=
iculumData[o.country][o.region][o.course];</td></tr><tr><td class=3D"line-n=
umber" value=3D"3027"></td><td class=3D"line-content">                     =
   if (!Array.isArray(target)) {</td></tr><tr><td class=3D"line-number" val=
ue=3D"3028"></td><td class=3D"line-content">                            win=
dow.curriculumData[o.country][o.region][o.course] =3D [];</td></tr><tr><td =
class=3D"line-number" value=3D"3029"></td><td class=3D"line-content">      =
                      target =3D window.curriculumData[o.country][o.region]=
[o.course];</td></tr><tr><td class=3D"line-number" value=3D"3030"></td><td =
class=3D"line-content">                        }</td></tr><tr><td class=3D"=
line-number" value=3D"3031"></td><td class=3D"line-content">               =
         if (!target.includes(o.description)) target.push(o.description);</=
td></tr><tr><td class=3D"line-number" value=3D"3032"></td><td class=3D"line=
-content">                    });</td></tr><tr><td class=3D"line-number" va=
lue=3D"3033"></td><td class=3D"line-content">                    log(`Cloud=
 Curriculum Synced: ${outcomes.length} outcomes.`, "success");</td></tr><tr=
><td class=3D"line-number" value=3D"3034"></td><td class=3D"line-content"> =
               } catch (e) {</td></tr><tr><td class=3D"line-number" value=
=3D"3035"></td><td class=3D"line-content">                    log(`Cloud Sy=
nc Warning: ${e.message}`, "warning");</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3036"></td><td class=3D"line-content">                }</td></t=
r><tr><td class=3D"line-number" value=3D"3037"></td><td class=3D"line-conte=
nt">            }</td></tr><tr><td class=3D"line-number" value=3D"3038"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"3039"></td><td class=3D"line-content">            // 3. Merge Local =
"Custom Lab" outcomes (Legacy Port)</td></tr><tr><td class=3D"line-number" =
value=3D"3040"></td><td class=3D"line-content">            const custom =3D=
 JSON.parse(localStorage.getItem('blob_custom_curriculum')) || {};</td></tr=
><tr><td class=3D"line-number" value=3D"3041"></td><td class=3D"line-conten=
t">            console.log("fetchCurriculum: Blending custom labs...", Obje=
ct.keys(custom));</td></tr><tr><td class=3D"line-number" value=3D"3042"></t=
d><td class=3D"line-content">            Object.keys(custom).forEach(countr=
y =3D&gt; {</td></tr><tr><td class=3D"line-number" value=3D"3043"></td><td =
class=3D"line-content">                if (!window.curriculumData[country])=
 window.curriculumData[country] =3D {};</td></tr><tr><td class=3D"line-numb=
er" value=3D"3044"></td><td class=3D"line-content">                Object.k=
eys(custom[country]).forEach(region =3D&gt; {</td></tr><tr><td class=3D"lin=
e-number" value=3D"3045"></td><td class=3D"line-content">                  =
  if (!window.curriculumData[country][region]) window.curriculumData[countr=
y][region] =3D {};</td></tr><tr><td class=3D"line-number" value=3D"3046"></=
td><td class=3D"line-content">                    Object.keys(custom[countr=
y][region]).forEach(course =3D&gt; {</td></tr><tr><td class=3D"line-number"=
 value=3D"3047"></td><td class=3D"line-content">                        win=
dow.curriculumData[country][region][course] =3D custom[country][region][cou=
rse];</td></tr><tr><td class=3D"line-number" value=3D"3048"></td><td class=
=3D"line-content">                    });</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3049"></td><td class=3D"line-content">                });</t=
d></tr><tr><td class=3D"line-number" value=3D"3050"></td><td class=3D"line-=
content">            });</td></tr><tr><td class=3D"line-number" value=3D"30=
51"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-num=
ber" value=3D"3052"></td><td class=3D"line-content">            log("Curric=
ulum Hybridization Complete.");</td></tr><tr><td class=3D"line-number" valu=
e=3D"3053"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"3054"></td><td class=3D"line-content">            // P=
opulate Country Select</td></tr><tr><td class=3D"line-number" value=3D"3055=
"></td><td class=3D"line-content">            const sel =3D document.getEle=
mentById('f-country');</td></tr><tr><td class=3D"line-number" value=3D"3056=
"></td><td class=3D"line-content">            if (sel) {</td></tr><tr><td c=
lass=3D"line-number" value=3D"3057"></td><td class=3D"line-content">       =
         sel.innerHTML =3D `&lt;option value=3D""&gt;-- SELECT COUNTRY --&l=
t;/option&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"3058"></td>=
<td class=3D"line-content">                Object.keys(window.curriculumDat=
a).sort().forEach(c =3D&gt; {</td></tr><tr><td class=3D"line-number" value=
=3D"3059"></td><td class=3D"line-content">                    sel.innerHTML=
 +=3D `&lt;option value=3D"${c}"&gt;${c}&lt;/option&gt;`;</td></tr><tr><td =
class=3D"line-number" value=3D"3060"></td><td class=3D"line-content">      =
          });</td></tr><tr><td class=3D"line-number" value=3D"3061"></td><t=
d class=3D"line-content">            }</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3062"></td><td class=3D"line-content"><br></td></tr><tr><td cla=
ss=3D"line-number" value=3D"3063"></td><td class=3D"line-content">         =
   // Sticky Restoration</td></tr><tr><td class=3D"line-number" value=3D"30=
64"></td><td class=3D"line-content">            window.isRestoringCurriculu=
m =3D true;</td></tr><tr><td class=3D"line-number" value=3D"3065"></td><td =
class=3D"line-content">            const savedCountry =3D localStorage.getI=
tem('TM_Builder_COUNTRY');</td></tr><tr><td class=3D"line-number" value=3D"=
3066"></td><td class=3D"line-content">            if (savedCountry &amp;&am=
p; window.curriculumData[savedCountry]) {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3067"></td><td class=3D"line-content">                if (se=
l) sel.value =3D savedCountry;</td></tr><tr><td class=3D"line-number" value=
=3D"3068"></td><td class=3D"line-content">                updateBuilderRegi=
ons();</td></tr><tr><td class=3D"line-number" value=3D"3069"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3070=
"></td><td class=3D"line-content">                const savedRegion =3D loc=
alStorage.getItem('TM_Builder_REGION');</td></tr><tr><td class=3D"line-numb=
er" value=3D"3071"></td><td class=3D"line-content">                const rS=
el =3D document.getElementById('f-region');</td></tr><tr><td class=3D"line-=
number" value=3D"3072"></td><td class=3D"line-content">                if (=
savedRegion &amp;&amp; window.curriculumData[savedCountry][savedRegion]) {<=
/td></tr><tr><td class=3D"line-number" value=3D"3073"></td><td class=3D"lin=
e-content">                    rSel.value =3D savedRegion;</td></tr><tr><td=
 class=3D"line-number" value=3D"3074"></td><td class=3D"line-content">     =
               updateBuilderCourses();</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3075"></td><td class=3D"line-content"><br></td></tr><tr><td cla=
ss=3D"line-number" value=3D"3076"></td><td class=3D"line-content">         =
           const savedCourse =3D localStorage.getItem('TM_Builder_COURSE');=
</td></tr><tr><td class=3D"line-number" value=3D"3077"></td><td class=3D"li=
ne-content">                    const cSel =3D document.getElementById('f-c=
ourse');</td></tr><tr><td class=3D"line-number" value=3D"3078"></td><td cla=
ss=3D"line-content">                    if (savedCourse &amp;&amp; window.c=
urriculumData[savedCountry][savedRegion][savedCourse]) {</td></tr><tr><td c=
lass=3D"line-number" value=3D"3079"></td><td class=3D"line-content">       =
                 cSel.value =3D savedCourse;</td></tr><tr><td class=3D"line=
-number" value=3D"3080"></td><td class=3D"line-content">                   =
     updateBuilderOutcomes();</td></tr><tr><td class=3D"line-number" value=
=3D"3081"></td><td class=3D"line-content">                    }</td></tr><t=
r><td class=3D"line-number" value=3D"3082"></td><td class=3D"line-content">=
                }</td></tr><tr><td class=3D"line-number" value=3D"3083"></t=
d><td class=3D"line-content">            }</td></tr><tr><td class=3D"line-n=
umber" value=3D"3084"></td><td class=3D"line-content">            window.is=
RestoringCurriculum =3D false;</td></tr><tr><td class=3D"line-number" value=
=3D"3085"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"3086"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"3087"></td><td class=3D"line-cont=
ent">        function updateBuilderRegions() {</td></tr><tr><td class=3D"li=
ne-number" value=3D"3088"></td><td class=3D"line-content">            const=
 country =3D document.getElementById('f-country').value;</td></tr><tr><td c=
lass=3D"line-number" value=3D"3089"></td><td class=3D"line-content">       =
     const rSel =3D document.getElementById('f-region');</td></tr><tr><td c=
lass=3D"line-number" value=3D"3090"></td><td class=3D"line-content">       =
     const cSel =3D document.getElementById('f-course');</td></tr><tr><td c=
lass=3D"line-number" value=3D"3091"></td><td class=3D"line-content">       =
     const outDiv =3D document.getElementById('f-outcomes');</td></tr><tr><=
td class=3D"line-number" value=3D"3092"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"3093"></td><td class=3D"l=
ine-content">            if (!window.isRestoringCurriculum) {</td></tr><tr>=
<td class=3D"line-number" value=3D"3094"></td><td class=3D"line-content">  =
              localStorage.setItem('TM_Builder_COUNTRY', country);</td></tr=
><tr><td class=3D"line-number" value=3D"3095"></td><td class=3D"line-conten=
t">                localStorage.removeItem('TM_Builder_REGION');</td></tr><=
tr><td class=3D"line-number" value=3D"3096"></td><td class=3D"line-content"=
>                localStorage.removeItem('TM_Builder_COURSE');</td></tr><tr=
><td class=3D"line-number" value=3D"3097"></td><td class=3D"line-content"> =
           }</td></tr><tr><td class=3D"line-number" value=3D"3098"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"3099"></td><td class=3D"line-content">            rSel.innerHTML =3D `&=
lt;option value=3D""&gt;-- SELECT REGION --&lt;/option&gt;`;</td></tr><tr><=
td class=3D"line-number" value=3D"3100"></td><td class=3D"line-content">   =
         cSel.innerHTML =3D `&lt;option value=3D""&gt;-- SELECT COURSE --&l=
t;/option&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"3101"></td>=
<td class=3D"line-content">            rSel.classList.add('hidden');</td></=
tr><tr><td class=3D"line-number" value=3D"3102"></td><td class=3D"line-cont=
ent">            cSel.classList.add('hidden');</td></tr><tr><td class=3D"li=
ne-number" value=3D"3103"></td><td class=3D"line-content">            if (o=
utDiv) outDiv.innerHTML =3D `&lt;p class=3D"text-center opacity-30 text-[0.=
6rem] py-4"&gt;SELECT COURSE TO LOAD OUTCOMES&lt;/p&gt;`;</td></tr><tr><td =
class=3D"line-number" value=3D"3104"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"3105"></td><td class=3D"line=
-content">            if (!country || !window.curriculumData[country]) retu=
rn;</td></tr><tr><td class=3D"line-number" value=3D"3106"></td><td class=3D=
"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3107"><=
/td><td class=3D"line-content">            Object.keys(window.curriculumDat=
a[country]).sort().forEach(r =3D&gt; {</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3108"></td><td class=3D"line-content">                rSel.inne=
rHTML +=3D `&lt;option value=3D"${r}"&gt;${r}&lt;/option&gt;`;</td></tr><tr=
><td class=3D"line-number" value=3D"3109"></td><td class=3D"line-content"> =
           });</td></tr><tr><td class=3D"line-number" value=3D"3110"></td><=
td class=3D"line-content">            rSel.classList.remove('hidden');</td>=
</tr><tr><td class=3D"line-number" value=3D"3111"></td><td class=3D"line-co=
ntent">        }</td></tr><tr><td class=3D"line-number" value=3D"3112"></td=
><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" val=
ue=3D"3113"></td><td class=3D"line-content">        function updateBuilderC=
ourses() {</td></tr><tr><td class=3D"line-number" value=3D"3114"></td><td c=
lass=3D"line-content">            const country =3D document.getElementById=
('f-country').value;</td></tr><tr><td class=3D"line-number" value=3D"3115">=
</td><td class=3D"line-content">            const region =3D document.getEl=
ementById('f-region').value;</td></tr><tr><td class=3D"line-number" value=
=3D"3116"></td><td class=3D"line-content">            const cSel =3D docume=
nt.getElementById('f-course');</td></tr><tr><td class=3D"line-number" value=
=3D"3117"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3118"></td><td class=3D"line-content">            if (!=
window.isRestoringCurriculum) {</td></tr><tr><td class=3D"line-number" valu=
e=3D"3119"></td><td class=3D"line-content">                localStorage.set=
Item('TM_Builder_REGION', region);</td></tr><tr><td class=3D"line-number" v=
alue=3D"3120"></td><td class=3D"line-content">                localStorage.=
removeItem('TM_Builder_COURSE');</td></tr><tr><td class=3D"line-number" val=
ue=3D"3121"></td><td class=3D"line-content">            }</td></tr><tr><td =
class=3D"line-number" value=3D"3122"></td><td class=3D"line-content"><br></=
td></tr><tr><td class=3D"line-number" value=3D"3123"></td><td class=3D"line=
-content">            cSel.innerHTML =3D `&lt;option value=3D""&gt;-- SELEC=
T COURSE --&lt;/option&gt;`;</td></tr><tr><td class=3D"line-number" value=
=3D"3124"></td><td class=3D"line-content">            cSel.classList.add('h=
idden');</td></tr><tr><td class=3D"line-number" value=3D"3125"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"31=
26"></td><td class=3D"line-content">            if (!region || !window.curr=
iculumData[country][region]) return;</td></tr><tr><td class=3D"line-number"=
 value=3D"3127"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"3128"></td><td class=3D"line-content">           =
 Object.keys(window.curriculumData[country][region]).sort().forEach(c =3D&g=
t; {</td></tr><tr><td class=3D"line-number" value=3D"3129"></td><td class=
=3D"line-content">                cSel.innerHTML +=3D `&lt;option value=3D"=
${c}"&gt;${c}&lt;/option&gt;`;</td></tr><tr><td class=3D"line-number" value=
=3D"3130"></td><td class=3D"line-content">            });</td></tr><tr><td =
class=3D"line-number" value=3D"3131"></td><td class=3D"line-content">      =
      cSel.classList.remove('hidden');</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3132"></td><td class=3D"line-content">        }</td></tr><tr><t=
d class=3D"line-number" value=3D"3133"></td><td class=3D"line-content"><br>=
</td></tr><tr><td class=3D"line-number" value=3D"3134"></td><td class=3D"li=
ne-content">        function updateBuilderOutcomes() {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"3135"></td><td class=3D"line-content">         =
   const country =3D document.getElementById('f-country').value;</td></tr><=
tr><td class=3D"line-number" value=3D"3136"></td><td class=3D"line-content"=
>            const region =3D document.getElementById('f-region').value;</t=
d></tr><tr><td class=3D"line-number" value=3D"3137"></td><td class=3D"line-=
content">            const course =3D document.getElementById('f-course').v=
alue;</td></tr><tr><td class=3D"line-number" value=3D"3138"></td><td class=
=3D"line-content">            const outDiv =3D document.getElementById('f-o=
utcomes');</td></tr><tr><td class=3D"line-number" value=3D"3139"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
3140"></td><td class=3D"line-content">            if (!window.isRestoringCu=
rriculum) {</td></tr><tr><td class=3D"line-number" value=3D"3141"></td><td =
class=3D"line-content">                localStorage.setItem('TM_Builder_COU=
RSE', course);</td></tr><tr><td class=3D"line-number" value=3D"3142"></td><=
td class=3D"line-content">            }</td></tr><tr><td class=3D"line-numb=
er" value=3D"3143"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"3144"></td><td class=3D"line-content">        =
    if (!course || !window.curriculumData[country][region][course]) {</td><=
/tr><tr><td class=3D"line-number" value=3D"3145"></td><td class=3D"line-con=
tent">                if (outDiv) outDiv.innerHTML =3D `&lt;p class=3D"text=
-center opacity-30 text-[0.6rem] py-4"&gt;SELECT COURSE TO LOAD OUTCOMES&lt=
;/p&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"3146"></td><td cl=
ass=3D"line-content">                return;</td></tr><tr><td class=3D"line=
-number" value=3D"3147"></td><td class=3D"line-content">            }</td><=
/tr><tr><td class=3D"line-number" value=3D"3148"></td><td class=3D"line-con=
tent"><br></td></tr><tr><td class=3D"line-number" value=3D"3149"></td><td c=
lass=3D"line-content">            const outcomes =3D window.curriculumData[=
country][region][course];</td></tr><tr><td class=3D"line-number" value=3D"3=
150"></td><td class=3D"line-content">            let html =3D '';</td></tr>=
<tr><td class=3D"line-number" value=3D"3151"></td><td class=3D"line-content=
">            outcomes.forEach((o, i) =3D&gt; {</td></tr><tr><td class=3D"l=
ine-number" value=3D"3152"></td><td class=3D"line-content">                =
html +=3D `</td></tr><tr><td class=3D"line-number" value=3D"3153"></td><td =
class=3D"line-content">                &lt;label class=3D"flex gap-2 items-=
start p-2 hover:bg-base-200 rounded cursor-pointer transition-colors group"=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"3154"></td><td class=
=3D"line-content">                    &lt;input type=3D"checkbox" value=3D"=
${o}" class=3D"checkbox checkbox-primary checkbox-xs mt-0.5 outcome-check"&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"3155"></td><td class=3D=
"line-content">                    &lt;span class=3D"text-[0.7rem] leading-=
tight opacity-70 group-hover:opacity-100"&gt;${o}&lt;/span&gt;</td></tr><tr=
><td class=3D"line-number" value=3D"3156"></td><td class=3D"line-content"> =
               &lt;/label&gt;`;</td></tr><tr><td class=3D"line-number" valu=
e=3D"3157"></td><td class=3D"line-content">            });</td></tr><tr><td=
 class=3D"line-number" value=3D"3158"></td><td class=3D"line-content">     =
       if (outDiv) outDiv.innerHTML =3D html;</td></tr><tr><td class=3D"lin=
e-number" value=3D"3159"></td><td class=3D"line-content">            log(`L=
oaded ${outcomes.length} outcomes for ${course}.`, "success");</td></tr><tr=
><td class=3D"line-number" value=3D"3160"></td><td class=3D"line-content"> =
       }</td></tr><tr><td class=3D"line-number" value=3D"3161"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"31=
62"></td><td class=3D"line-content">        // --- CUSTOM COURSE LOGIC ---<=
/td></tr><tr><td class=3D"line-number" value=3D"3163"></td><td class=3D"lin=
e-content">        function toggleAllOutcomes() {</td></tr><tr><td class=3D=
"line-number" value=3D"3164"></td><td class=3D"line-content">            co=
nst checks =3D document.querySelectorAll('.outcome-check');</td></tr><tr><t=
d class=3D"line-number" value=3D"3165"></td><td class=3D"line-content">    =
        if (checks.length =3D=3D=3D 0) return;</td></tr><tr><td class=3D"li=
ne-number" value=3D"3166"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"3167"></td><td class=3D"line-content"> =
           // If any are unchecked, select all. Otherwise, deselect all.</t=
d></tr><tr><td class=3D"line-number" value=3D"3168"></td><td class=3D"line-=
content">            const anyUnchecked =3D Array.from(checks).some(c =3D&g=
t; !c.checked);</td></tr><tr><td class=3D"line-number" value=3D"3169"></td>=
<td class=3D"line-content">            checks.forEach(c =3D&gt; c.checked =
=3D anyUnchecked);</td></tr><tr><td class=3D"line-number" value=3D"3170"></=
td><td class=3D"line-content">            log(`${anyUnchecked ? 'Selected' =
: 'Deselected'} all ${checks.length} outcomes.`, 'info');</td></tr><tr><td =
class=3D"line-number" value=3D"3171"></td><td class=3D"line-content">      =
  }</td></tr><tr><td class=3D"line-number" value=3D"3172"></td><td class=3D=
"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3173"><=
/td><td class=3D"line-content">        function toggleCustomAdd() {</td></t=
r><tr><td class=3D"line-number" value=3D"3174"></td><td class=3D"line-conte=
nt">            const zone =3D document.getElementById('custom-add-zone');<=
/td></tr><tr><td class=3D"line-number" value=3D"3175"></td><td class=3D"lin=
e-content">            zone.classList.toggle('hidden');</td></tr><tr><td cl=
ass=3D"line-number" value=3D"3176"></td><td class=3D"line-content">        =
}</td></tr><tr><td class=3D"line-number" value=3D"3177"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3178"></t=
d><td class=3D"line-content">        async function saveCustomCourse() {</t=
d></tr><tr><td class=3D"line-number" value=3D"3179"></td><td class=3D"line-=
content">            const country =3D document.getElementById('custom-coun=
try').value.trim() || "CUSTOM_LAB";</td></tr><tr><td class=3D"line-number" =
value=3D"3180"></td><td class=3D"line-content">            const region =3D=
 document.getElementById('custom-region').value.trim() || "LOCAL";</td></tr=
><tr><td class=3D"line-number" value=3D"3181"></td><td class=3D"line-conten=
t">            const name =3D document.getElementById('custom-course-name')=
.value.trim();</td></tr><tr><td class=3D"line-number" value=3D"3182"></td><=
td class=3D"line-content">            const raw =3D document.getElementById=
('custom-outcomes-raw').value;</td></tr><tr><td class=3D"line-number" value=
=3D"3183"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3184"></td><td class=3D"line-content">            if (!=
name || !raw) return alert("MISSING PARAMETERS: Course Name and Outcomes ar=
e required.");</td></tr><tr><td class=3D"line-number" value=3D"3185"></td><=
td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"3186"></td><td class=3D"line-content">            const outcomes =3D ra=
w.split("\n").map(o =3D&gt; o.trim()).filter(o =3D&gt; o.length &gt; 0);</t=
d></tr><tr><td class=3D"line-number" value=3D"3187"></td><td class=3D"line-=
content"><br></td></tr><tr><td class=3D"line-number" value=3D"3188"></td><t=
d class=3D"line-content">            // Save to LocalStorage</td></tr><tr><=
td class=3D"line-number" value=3D"3189"></td><td class=3D"line-content">   =
         const custom =3D JSON.parse(localStorage.getItem('blob_custom_curr=
iculum')) || {};</td></tr><tr><td class=3D"line-number" value=3D"3190"></td=
><td class=3D"line-content">            if (!custom[country]) custom[countr=
y] =3D {};</td></tr><tr><td class=3D"line-number" value=3D"3191"></td><td c=
lass=3D"line-content">            if (!custom[country][region]) custom[coun=
try][region] =3D {};</td></tr><tr><td class=3D"line-number" value=3D"3192">=
</td><td class=3D"line-content">            custom[country][region][name] =
=3D outcomes;</td></tr><tr><td class=3D"line-number" value=3D"3193"></td><t=
d class=3D"line-content">            localStorage.setItem('blob_custom_curr=
iculum', JSON.stringify(custom));</td></tr><tr><td class=3D"line-number" va=
lue=3D"3194"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D=
"line-number" value=3D"3195"></td><td class=3D"line-content">            //=
 Sync to Supabase</td></tr><tr><td class=3D"line-number" value=3D"3196"></t=
d><td class=3D"line-content">            if (SupabaseBridge.client) {</td><=
/tr><tr><td class=3D"line-number" value=3D"3197"></td><td class=3D"line-con=
tent">                try {</td></tr><tr><td class=3D"line-number" value=3D=
"3198"></td><td class=3D"line-content">                    for (const outco=
me of outcomes) {</td></tr><tr><td class=3D"line-number" value=3D"3199"></t=
d><td class=3D"line-content">                        await SupabaseBridge.s=
aveCustomOutcome(country, region, name, outcome);</td></tr><tr><td class=3D=
"line-number" value=3D"3200"></td><td class=3D"line-content">              =
      }</td></tr><tr><td class=3D"line-number" value=3D"3201"></td><td clas=
s=3D"line-content">                    log(`Custom Course [${name}] synced =
to Supabase.`, "success");</td></tr><tr><td class=3D"line-number" value=3D"=
3202"></td><td class=3D"line-content">                } catch (e) {</td></t=
r><tr><td class=3D"line-number" value=3D"3203"></td><td class=3D"line-conte=
nt">                    log(`Sync Error: ${e.message}`, "error");</td></tr>=
<tr><td class=3D"line-number" value=3D"3204"></td><td class=3D"line-content=
">                }</td></tr><tr><td class=3D"line-number" value=3D"3205"><=
/td><td class=3D"line-content">            }</td></tr><tr><td class=3D"line=
-number" value=3D"3206"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"3207"></td><td class=3D"line-content">   =
         alert("Course Saved to Lab. Refreshing curriculum...");</td></tr><=
tr><td class=3D"line-number" value=3D"3208"></td><td class=3D"line-content"=
>            fetchCurriculum();</td></tr><tr><td class=3D"line-number" valu=
e=3D"3209"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"3210"></td><td class=3D"line-content"><br></td></=
tr><tr><td class=3D"line-number" value=3D"3211"></td><td class=3D"line-cont=
ent">        // --- UI HELPERS ---</td></tr><tr><td class=3D"line-number" v=
alue=3D"3212"></td><td class=3D"line-content">        function openSettings=
() {</td></tr><tr><td class=3D"line-number" value=3D"3213"></td><td class=
=3D"line-content">            console.log("openSettings: Interaction Hook F=
ired.");</td></tr><tr><td class=3D"line-number" value=3D"3214"></td><td cla=
ss=3D"line-content">            try {</td></tr><tr><td class=3D"line-number=
" value=3D"3215"></td><td class=3D"line-content">                const moda=
l =3D document.getElementById('settings_modal');</td></tr><tr><td class=3D"=
line-number" value=3D"3216"></td><td class=3D"line-content">               =
 if (!modal) {</td></tr><tr><td class=3D"line-number" value=3D"3217"></td><=
td class=3D"line-content">                    console.error("openSettings: =
Modal element 'settings_modal' missing from DOM.");</td></tr><tr><td class=
=3D"line-number" value=3D"3218"></td><td class=3D"line-content">           =
         log("CRITICAL: settings_modal element missing.", "error");</td></t=
r><tr><td class=3D"line-number" value=3D"3219"></td><td class=3D"line-conte=
nt">                    return;</td></tr><tr><td class=3D"line-number" valu=
e=3D"3220"></td><td class=3D"line-content">                }</td></tr><tr><=
td class=3D"line-number" value=3D"3221"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"3222"></td><td class=3D"l=
ine-content">                const ids =3D {</td></tr><tr><td class=3D"line=
-number" value=3D"3223"></td><td class=3D"line-content">                   =
 'cfg-vercel-proxy': 'TM_VERCEL_PROXY',</td></tr><tr><td class=3D"line-numb=
er" value=3D"3224"></td><td class=3D"line-content">                    'cfg=
-gcp-key': 'TM_GCP_KEY',</td></tr><tr><td class=3D"line-number" value=3D"32=
25"></td><td class=3D"line-content">                    'cfg-gcp-project': =
'TM_GCP_PROJECT',</td></tr><tr><td class=3D"line-number" value=3D"3226"></t=
d><td class=3D"line-content">                    'cfg-gcp-location': 'TM_GC=
P_LOCATION',</td></tr><tr><td class=3D"line-number" value=3D"3227"></td><td=
 class=3D"line-content">                    'cfg-gcp-model': 'TM_GCP_MODEL'=
,</td></tr><tr><td class=3D"line-number" value=3D"3228"></td><td class=3D"l=
ine-content">                    'cfg-gcp-client-id': 'TM_GCP_CLIENT_ID',</=
td></tr><tr><td class=3D"line-number" value=3D"3229"></td><td class=3D"line=
-content">                    'cfg-teacher-id': 'TM_TEACHER_HANDLE',</td></=
tr><tr><td class=3D"line-number" value=3D"3230"></td><td class=3D"line-cont=
ent">                    'cfg-builder-model': 'TM_BUILDER_MODEL'</td></tr><=
tr><td class=3D"line-number" value=3D"3231"></td><td class=3D"line-content"=
>                };</td></tr><tr><td class=3D"line-number" value=3D"3232"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"3233"></td><td class=3D"line-content">                for (let [id=
, storageKey] of Object.entries(ids)) {</td></tr><tr><td class=3D"line-numb=
er" value=3D"3234"></td><td class=3D"line-content">                    cons=
t el =3D document.getElementById(id);</td></tr><tr><td class=3D"line-number=
" value=3D"3235"></td><td class=3D"line-content">                    if (el=
) {</td></tr><tr><td class=3D"line-number" value=3D"3236"></td><td class=3D=
"line-content">                        let val =3D localStorage.getItem(sto=
rageKey) || '';</td></tr><tr><td class=3D"line-number" value=3D"3237"></td>=
<td class=3D"line-content">                        // Fallbacks for certain=
 fields to match V2 defaults</td></tr><tr><td class=3D"line-number" value=
=3D"3238"></td><td class=3D"line-content">                        if (!val =
&amp;&amp; storageKey =3D=3D=3D 'TM_GCP_LOCATION') val =3D "us-central1";</=
td></tr><tr><td class=3D"line-number" value=3D"3239"></td><td class=3D"line=
-content">                        if (!val &amp;&amp; storageKey =3D=3D=3D =
'TM_GCP_MODEL') val =3D "gemini-1.5-flash";</td></tr><tr><td class=3D"line-=
number" value=3D"3240"></td><td class=3D"line-content">                    =
    if (!val &amp;&amp; storageKey =3D=3D=3D 'TM_GCP_CLIENT_ID') val =3D "9=
85904065235-u0115ektel546fs42mar5rch46utkki6.apps.googleusercontent.com";</=
td></tr><tr><td class=3D"line-number" value=3D"3241"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3242"></td><=
td class=3D"line-content">                        el.value =3D val;</td></t=
r><tr><td class=3D"line-number" value=3D"3243"></td><td class=3D"line-conte=
nt">                    }</td></tr><tr><td class=3D"line-number" value=3D"3=
244"></td><td class=3D"line-content">                    else console.warn(=
`openSettings: Input field '${id}' missing.`);</td></tr><tr><td class=3D"li=
ne-number" value=3D"3245"></td><td class=3D"line-content">                }=
</td></tr><tr><td class=3D"line-number" value=3D"3246"></td><td class=3D"li=
ne-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3247"></td=
><td class=3D"line-content">                modal.showModal();</td></tr><tr=
><td class=3D"line-number" value=3D"3248"></td><td class=3D"line-content"> =
               log("Opening System Configuration...");</td></tr><tr><td cla=
ss=3D"line-number" value=3D"3249"></td><td class=3D"line-content">         =
   } catch (e) {</td></tr><tr><td class=3D"line-number" value=3D"3250"></td=
><td class=3D"line-content">                console.error("openSettings: Ex=
ecution Error", e);</td></tr><tr><td class=3D"line-number" value=3D"3251"><=
/td><td class=3D"line-content">                log("Settings Error: " + e.m=
essage, "error");</td></tr><tr><td class=3D"line-number" value=3D"3252"></t=
d><td class=3D"line-content">            }</td></tr><tr><td class=3D"line-n=
umber" value=3D"3253"></td><td class=3D"line-content">        }</td></tr><t=
r><td class=3D"line-number" value=3D"3254"></td><td class=3D"line-content">=
<br></td></tr><tr><td class=3D"line-number" value=3D"3255"></td><td class=
=3D"line-content">        function saveSettings() {</td></tr><tr><td class=
=3D"line-number" value=3D"3256"></td><td class=3D"line-content">           =
 try {</td></tr><tr><td class=3D"line-number" value=3D"3257"></td><td class=
=3D"line-content">                const mappings =3D {</td></tr><tr><td cla=
ss=3D"line-number" value=3D"3258"></td><td class=3D"line-content">         =
           'cfg-vercel-proxy': 'TM_VERCEL_PROXY',</td></tr><tr><td class=3D=
"line-number" value=3D"3259"></td><td class=3D"line-content">              =
      'cfg-gcp-key': 'TM_GCP_KEY',</td></tr><tr><td class=3D"line-number" v=
alue=3D"3260"></td><td class=3D"line-content">                    'cfg-gcp-=
project': 'TM_GCP_PROJECT',</td></tr><tr><td class=3D"line-number" value=3D=
"3261"></td><td class=3D"line-content">                    'cfg-gcp-locatio=
n': 'TM_GCP_LOCATION',</td></tr><tr><td class=3D"line-number" value=3D"3262=
"></td><td class=3D"line-content">                    'cfg-gcp-model': 'TM_=
GCP_MODEL',</td></tr><tr><td class=3D"line-number" value=3D"3263"></td><td =
class=3D"line-content">                    'cfg-gcp-client-id': 'TM_GCP_CLI=
ENT_ID',</td></tr><tr><td class=3D"line-number" value=3D"3264"></td><td cla=
ss=3D"line-content">                    'cfg-teacher-id': 'TM_TEACHER_HANDL=
E',</td></tr><tr><td class=3D"line-number" value=3D"3265"></td><td class=3D=
"line-content">                    'cfg-builder-model': 'TM_BUILDER_MODEL'<=
/td></tr><tr><td class=3D"line-number" value=3D"3266"></td><td class=3D"lin=
e-content">                };</td></tr><tr><td class=3D"line-number" value=
=3D"3267"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3268"></td><td class=3D"line-content">                c=
onsole.log("saveSettings: Starting save process...");</td></tr><tr><td clas=
s=3D"line-number" value=3D"3269"></td><td class=3D"line-content">          =
      for (let [id, storageKey] of Object.entries(mappings)) {</td></tr><tr=
><td class=3D"line-number" value=3D"3270"></td><td class=3D"line-content"> =
                   const el =3D document.getElementById(id);</td></tr><tr><=
td class=3D"line-number" value=3D"3271"></td><td class=3D"line-content">   =
                 if (el) {</td></tr><tr><td class=3D"line-number" value=3D"=
3272"></td><td class=3D"line-content">                        let val =3D e=
l.value.trim();</td></tr><tr><td class=3D"line-number" value=3D"3273"></td>=
<td class=3D"line-content">                        if (storageKey =3D=3D=3D=
 'TM_TEACHER_HANDLE') val =3D val.toUpperCase();</td></tr><tr><td class=3D"=
line-number" value=3D"3274"></td><td class=3D"line-content">               =
         console.log(`saveSettings: Saving ${storageKey} =3D "${val.substri=
ng(0, 10)}..."`);</td></tr><tr><td class=3D"line-number" value=3D"3275"></t=
d><td class=3D"line-content">                        localStorage.setItem(s=
torageKey, val);</td></tr><tr><td class=3D"line-number" value=3D"3276"></td=
><td class=3D"line-content">                    } else {</td></tr><tr><td c=
lass=3D"line-number" value=3D"3277"></td><td class=3D"line-content">       =
                 console.warn(`saveSettings: Element '${id}' not found!`);<=
/td></tr><tr><td class=3D"line-number" value=3D"3278"></td><td class=3D"lin=
e-content">                    }</td></tr><tr><td class=3D"line-number" val=
ue=3D"3279"></td><td class=3D"line-content">                }</td></tr><tr>=
<td class=3D"line-number" value=3D"3280"></td><td class=3D"line-content"><b=
r></td></tr><tr><td class=3D"line-number" value=3D"3281"></td><td class=3D"=
line-content">                // Verify key was saved</td></tr><tr><td clas=
s=3D"line-number" value=3D"3282"></td><td class=3D"line-content">          =
      const savedKey =3D localStorage.getItem('TM_GCP_KEY');</td></tr><tr><=
td class=3D"line-number" value=3D"3283"></td><td class=3D"line-content">   =
             console.log("saveSettings: Verification - TM_GCP_KEY =3D", sav=
edKey ? `${savedKey.substring(0, 8)}...` : "EMPTY");</td></tr><tr><td class=
=3D"line-number" value=3D"3284"></td><td class=3D"line-content">           =
     log(`Settings Saved. GCP Key: ${savedKey ? 'Stored' : 'MISSING'}`, sav=
edKey ? "success" : "error");</td></tr><tr><td class=3D"line-number" value=
=3D"3285"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3286"></td><td class=3D"line-content">                /=
/ Sync Builder Model specifically</td></tr><tr><td class=3D"line-number" va=
lue=3D"3287"></td><td class=3D"line-content">                const bModel =
=3D document.getElementById('cfg-builder-model')?.value;</td></tr><tr><td c=
lass=3D"line-number" value=3D"3288"></td><td class=3D"line-content">       =
         if (bModel &amp;&amp; document.getElementById('f-model')) {</td></=
tr><tr><td class=3D"line-number" value=3D"3289"></td><td class=3D"line-cont=
ent">                    document.getElementById('f-model').value =3D bMode=
l;</td></tr><tr><td class=3D"line-number" value=3D"3290"></td><td class=3D"=
line-content">                }</td></tr><tr><td class=3D"line-number" valu=
e=3D"3291"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"3292"></td><td class=3D"line-content">                =
alert("Settings Saved. Refreshing to apply cloud credentials.");</td></tr><=
tr><td class=3D"line-number" value=3D"3293"></td><td class=3D"line-content"=
>                location.reload();</td></tr><tr><td class=3D"line-number" =
value=3D"3294"></td><td class=3D"line-content">            } catch (e) {</t=
d></tr><tr><td class=3D"line-number" value=3D"3295"></td><td class=3D"line-=
content">                console.error("saveSettings Error:", e);</td></tr>=
<tr><td class=3D"line-number" value=3D"3296"></td><td class=3D"line-content=
">                alert("Failed to save settings: " + e.message);</td></tr>=
<tr><td class=3D"line-number" value=3D"3297"></td><td class=3D"line-content=
">            }</td></tr><tr><td class=3D"line-number" value=3D"3298"></td>=
<td class=3D"line-content">        }</td></tr><tr><td class=3D"line-number"=
 value=3D"3299"></td><td class=3D"line-content"><br></td></tr><tr><td class=
=3D"line-number" value=3D"3300"></td><td class=3D"line-content">        asy=
nc function loadMission(id) {</td></tr><tr><td class=3D"line-number" value=
=3D"3301"></td><td class=3D"line-content">            const mission =3D cur=
rentMissions.find(m =3D&gt; m.id =3D=3D=3D id);</td></tr><tr><td class=3D"l=
ine-number" value=3D"3302"></td><td class=3D"line-content">            if (=
!mission) return log(`Mission ${id} not found locally.`, 'error');</td></tr=
><tr><td class=3D"line-number" value=3D"3303"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"3304"></td><td clas=
s=3D"line-content">            if (confirm(`Load mission "${mission.name}" =
into Builder? Current progress will be overwritten.`)) {</td></tr><tr><td c=
lass=3D"line-number" value=3D"3305"></td><td class=3D"line-content">       =
         // Determine phase based on completeness (Mock logic)</td></tr><tr=
><td class=3D"line-number" value=3D"3306"></td><td class=3D"line-content"> =
               accumulatedData =3D { metadata: mission, slides: [] };</td><=
/tr><tr><td class=3D"line-number" value=3D"3307"></td><td class=3D"line-con=
tent">                BuilderHistory =3D [];</td></tr><tr><td class=3D"line=
-number" value=3D"3308"></td><td class=3D"line-content">                cur=
rentPhaseIndex =3D 1; // Jump to Narrative as example</td></tr><tr><td clas=
s=3D"line-number" value=3D"3309"></td><td class=3D"line-content">          =
      updateBuilderUI();</td></tr><tr><td class=3D"line-number" value=3D"33=
10"></td><td class=3D"line-content">                switchMainTab('Builder'=
);</td></tr><tr><td class=3D"line-number" value=3D"3311"></td><td class=3D"=
line-content">                addBuilderChat('ai', `**MISSION LOADED: ${mis=
sion.name}**\nResuming architecture sequence at Phase: ${getCurrentPhase().=
label}.`);</td></tr><tr><td class=3D"line-number" value=3D"3312"></td><td c=
lass=3D"line-content">            }</td></tr><tr><td class=3D"line-number" =
value=3D"3313"></td><td class=3D"line-content">        }</td></tr><tr><td c=
lass=3D"line-number" value=3D"3314"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"3315"></td><td class=3D"line-=
content">        function resetBuilder() {</td></tr><tr><td class=3D"line-n=
umber" value=3D"3316"></td><td class=3D"line-content">            if (!conf=
irm("RESET ALL PROGRESS? This will clear the current builder session.")) re=
turn;</td></tr><tr><td class=3D"line-number" value=3D"3317"></td><td class=
=3D"line-content">            BuilderHistory =3D [];</td></tr><tr><td class=
=3D"line-number" value=3D"3318"></td><td class=3D"line-content">           =
 currentPhaseIndex =3D 0;</td></tr><tr><td class=3D"line-number" value=3D"3=
319"></td><td class=3D"line-content">            accumulatedData =3D {</td>=
</tr><tr><td class=3D"line-number" value=3D"3320"></td><td class=3D"line-co=
ntent">                metadata: {},</td></tr><tr><td class=3D"line-number"=
 value=3D"3321"></td><td class=3D"line-content">                slides: [],=
</td></tr><tr><td class=3D"line-number" value=3D"3322"></td><td class=3D"li=
ne-content">                intelligenceGlossary: [],</td></tr><tr><td clas=
s=3D"line-number" value=3D"3323"></td><td class=3D"line-content">          =
      aiPromptsExtracted: false</td></tr><tr><td class=3D"line-number" valu=
e=3D"3324"></td><td class=3D"line-content">            };</td></tr><tr><td =
class=3D"line-number" value=3D"3325"></td><td class=3D"line-content">      =
      localStorage.removeItem('TM_Builder_HISTORY');</td></tr><tr><td class=
=3D"line-number" value=3D"3326"></td><td class=3D"line-content">           =
 localStorage.removeItem('TM_Builder_DATA');</td></tr><tr><td class=3D"line=
-number" value=3D"3327"></td><td class=3D"line-content"><br></td></tr><tr><=
td class=3D"line-number" value=3D"3328"></td><td class=3D"line-content">   =
         const chat =3D document.getElementById('Builder-chat');</td></tr><=
tr><td class=3D"line-number" value=3D"3329"></td><td class=3D"line-content"=
>            if (chat) {</td></tr><tr><td class=3D"line-number" value=3D"33=
30"></td><td class=3D"line-content">                chat.innerHTML =3D `</t=
d></tr><tr><td class=3D"line-number" value=3D"3331"></td><td class=3D"line-=
content">                    &lt;div class=3D"chat chat-start"&gt;</td></tr=
><tr><td class=3D"line-number" value=3D"3332"></td><td class=3D"line-conten=
t">                        &lt;div class=3D"chat-image avatar placeholder"&=
gt;</td></tr><tr><td class=3D"line-number" value=3D"3333"></td><td class=3D=
"line-content">                            &lt;div class=3D"w-10 rounded-fu=
ll bg-neutral text-neutral-content"&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"3334"></td><td class=3D"line-content">                        =
        &lt;span&gt;AI&lt;/span&gt;</td></tr><tr><td class=3D"line-number" =
value=3D"3335"></td><td class=3D"line-content">                            =
&lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"3336"></td><td=
 class=3D"line-content">                        &lt;/div&gt;</td></tr><tr><=
td class=3D"line-number" value=3D"3337"></td><td class=3D"line-content">   =
                     &lt;div class=3D"chat-bubble chat-bubble-primary font-=
mono text-sm leading-relaxed"&gt;</td></tr><tr><td class=3D"line-number" va=
lue=3D"3338"></td><td class=3D"line-content">                            &l=
t;strong&gt;SESSION RESET.&lt;/strong&gt;&lt;br&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"3339"></td><td class=3D"line-content">           =
                 Builder systems purged. Ready for new curriculum context.<=
/td></tr><tr><td class=3D"line-number" value=3D"3340"></td><td class=3D"lin=
e-content">                        &lt;/div&gt;</td></tr><tr><td class=3D"l=
ine-number" value=3D"3341"></td><td class=3D"line-content">                =
    &lt;/div&gt;`;</td></tr><tr><td class=3D"line-number" value=3D"3342"></=
td><td class=3D"line-content">            }</td></tr><tr><td class=3D"line-=
number" value=3D"3343"></td><td class=3D"line-content"><br></td></tr><tr><t=
d class=3D"line-number" value=3D"3344"></td><td class=3D"line-content">    =
        renderPipelineStepper();</td></tr><tr><td class=3D"line-number" val=
ue=3D"3345"></td><td class=3D"line-content">            updateBuilderUI();<=
/td></tr><tr><td class=3D"line-number" value=3D"3346"></td><td class=3D"lin=
e-content">            log("Builder session reset.", "warning");</td></tr><=
tr><td class=3D"line-number" value=3D"3347"></td><td class=3D"line-content"=
>        }</td></tr><tr><td class=3D"line-number" value=3D"3348"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
3349"></td><td class=3D"line-content">        function generateClassCode() =
{</td></tr><tr><td class=3D"line-number" value=3D"3350"></td><td class=3D"l=
ine-content">            const chars =3D "ABCDEFGHJKMNPQRSTUVWXYZ23456789";=
</td></tr><tr><td class=3D"line-number" value=3D"3351"></td><td class=3D"li=
ne-content">            let code =3D "";</td></tr><tr><td class=3D"line-num=
ber" value=3D"3352"></td><td class=3D"line-content">            for (let i =
=3D 0; i &lt; 5; i++) {</td></tr><tr><td class=3D"line-number" value=3D"335=
3"></td><td class=3D"line-content">                code +=3D chars.charAt(M=
ath.floor(Math.random() * chars.length));</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3354"></td><td class=3D"line-content">            }</td></tr=
><tr><td class=3D"line-number" value=3D"3355"></td><td class=3D"line-conten=
t">            return code;</td></tr><tr><td class=3D"line-number" value=3D=
"3356"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"=
line-number" value=3D"3357"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"3358"></td><td class=3D"line-content"=
>        async function registerClass() {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3359"></td><td class=3D"line-content">            const clas=
sName =3D prompt("Enter Class Name (e.g., Period 1 History):", "New Class")=
;</td></tr><tr><td class=3D"line-number" value=3D"3360"></td><td class=3D"l=
ine-content">            if (!className) return;</td></tr><tr><td class=3D"=
line-number" value=3D"3361"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"3362"></td><td class=3D"line-content"=
>            const code =3D generateClassCode();</td></tr><tr><td class=3D"=
line-number" value=3D"3363"></td><td class=3D"line-content">            con=
st tId =3D googleUser?.email || 'GUEST';</td></tr><tr><td class=3D"line-num=
ber" value=3D"3364"></td><td class=3D"line-content"><br></td></tr><tr><td c=
lass=3D"line-number" value=3D"3365"></td><td class=3D"line-content">       =
     if (!confirm(`Register new class [${className}] with code: ${code}?`))=
 return;</td></tr><tr><td class=3D"line-number" value=3D"3366"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"33=
67"></td><td class=3D"line-content">            if (SupabaseBridge.client) =
{</td></tr><tr><td class=3D"line-number" value=3D"3368"></td><td class=3D"l=
ine-content">                try {</td></tr><tr><td class=3D"line-number" v=
alue=3D"3369"></td><td class=3D"line-content">                    await Sup=
abaseBridge.saveClass(tId, className, code);</td></tr><tr><td class=3D"line=
-number" value=3D"3370"></td><td class=3D"line-content">                   =
 log(`CLASS REGISTERED: [${className}] Code: ${code}`, "success");</td></tr=
><tr><td class=3D"line-number" value=3D"3371"></td><td class=3D"line-conten=
t">                    alert(`Class Registered!\n\nName: ${className}\nCode=
: ${code}\n\nGive this code to your students.`);</td></tr><tr><td class=3D"=
line-number" value=3D"3372"></td><td class=3D"line-content">               =
     refreshClasses();</td></tr><tr><td class=3D"line-number" value=3D"3373=
"></td><td class=3D"line-content">                } catch (e) {</td></tr><t=
r><td class=3D"line-number" value=3D"3374"></td><td class=3D"line-content">=
                    log("Class Registration Failed: " + e.message, "error")=
;</td></tr><tr><td class=3D"line-number" value=3D"3375"></td><td class=3D"l=
ine-content">                    alert("Failed to register class: " + e.mes=
sage);</td></tr><tr><td class=3D"line-number" value=3D"3376"></td><td class=
=3D"line-content">                }</td></tr><tr><td class=3D"line-number" =
value=3D"3377"></td><td class=3D"line-content">            } else {</td></t=
r><tr><td class=3D"line-number" value=3D"3378"></td><td class=3D"line-conte=
nt">                alert("Supabase not connected. Cannot register class.")=
;</td></tr><tr><td class=3D"line-number" value=3D"3379"></td><td class=3D"l=
ine-content">            }</td></tr><tr><td class=3D"line-number" value=3D"=
3380"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"l=
ine-number" value=3D"3381"></td><td class=3D"line-content"><br></td></tr><t=
r><td class=3D"line-number" value=3D"3382"></td><td class=3D"line-content">=
        async function editClassUI(id) {</td></tr><tr><td class=3D"line-num=
ber" value=3D"3383"></td><td class=3D"line-content">            const newNa=
me =3D prompt("Enter new Class Name:");</td></tr><tr><td class=3D"line-numb=
er" value=3D"3384"></td><td class=3D"line-content">            if (newName =
&amp;&amp; window.SupabaseBridge &amp;&amp; SupabaseBridge.client) {</td></=
tr><tr><td class=3D"line-number" value=3D"3385"></td><td class=3D"line-cont=
ent">                try {</td></tr><tr><td class=3D"line-number" value=3D"=
3386"></td><td class=3D"line-content">                    await SupabaseBri=
dge.updateClass(id, { class_name: newName });</td></tr><tr><td class=3D"lin=
e-number" value=3D"3387"></td><td class=3D"line-content">                  =
  log(`Class renamed to ${newName}`, 'success');</td></tr><tr><td class=3D"=
line-number" value=3D"3388"></td><td class=3D"line-content">               =
     refreshClasses();</td></tr><tr><td class=3D"line-number" value=3D"3389=
"></td><td class=3D"line-content">                } catch (e) { log(`Edit F=
ailed: ${e.message}`, 'error'); }</td></tr><tr><td class=3D"line-number" va=
lue=3D"3390"></td><td class=3D"line-content">            }</td></tr><tr><td=
 class=3D"line-number" value=3D"3391"></td><td class=3D"line-content">     =
   }</td></tr><tr><td class=3D"line-number" value=3D"3392"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3393=
"></td><td class=3D"line-content">        async function deleteClassUI(id) =
{</td></tr><tr><td class=3D"line-number" value=3D"3394"></td><td class=3D"l=
ine-content">            if (!confirm("Delete this class? This will disconn=
ect student connections.")) return;</td></tr><tr><td class=3D"line-number" =
value=3D"3395"></td><td class=3D"line-content">            if (window.Supab=
aseBridge &amp;&amp; SupabaseBridge.client) {</td></tr><tr><td class=3D"lin=
e-number" value=3D"3396"></td><td class=3D"line-content">                tr=
y {</td></tr><tr><td class=3D"line-number" value=3D"3397"></td><td class=3D=
"line-content">                    await SupabaseBridge.deleteClass(id);</t=
d></tr><tr><td class=3D"line-number" value=3D"3398"></td><td class=3D"line-=
content">                    log(`Class scrubbed from record.`, 'warning');=
</td></tr><tr><td class=3D"line-number" value=3D"3399"></td><td class=3D"li=
ne-content">                    refreshClasses();</td></tr><tr><td class=3D=
"line-number" value=3D"3400"></td><td class=3D"line-content">              =
  } catch (e) { log(`Delete Failed: ${e.message}`, 'error'); }</td></tr><tr=
><td class=3D"line-number" value=3D"3401"></td><td class=3D"line-content"> =
           }</td></tr><tr><td class=3D"line-number" value=3D"3402"></td><td=
 class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" va=
lue=3D"3403"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D=
"line-number" value=3D"3404"></td><td class=3D"line-content">        // ---=
 PROJECTOR VIEW LOGIC ---</td></tr><tr><td class=3D"line-number" value=3D"3=
405"></td><td class=3D"line-content">        function toggleProjector() {</=
td></tr><tr><td class=3D"line-number" value=3D"3406"></td><td class=3D"line=
-content">            const pv =3D document.getElementById('projector-view'=
);</td></tr><tr><td class=3D"line-number" value=3D"3407"></td><td class=3D"=
line-content">            pv.classList.toggle('active');</td></tr><tr><td c=
lass=3D"line-number" value=3D"3408"></td><td class=3D"line-content">       =
     if (pv.classList.contains('active')) {</td></tr><tr><td class=3D"line-=
number" value=3D"3409"></td><td class=3D"line-content">                rend=
erProjectorBoard();</td></tr><tr><td class=3D"line-number" value=3D"3410"><=
/td><td class=3D"line-content">                // Start auto-refresh loop</=
td></tr><tr><td class=3D"line-number" value=3D"3411"></td><td class=3D"line=
-content">                if (window.projInterval) clearInterval(window.pro=
jInterval);</td></tr><tr><td class=3D"line-number" value=3D"3412"></td><td =
class=3D"line-content">                window.projInterval =3D setInterval(=
renderProjectorBoard, 10000); // Refresh every 10s</td></tr><tr><td class=
=3D"line-number" value=3D"3413"></td><td class=3D"line-content">           =
 } else {</td></tr><tr><td class=3D"line-number" value=3D"3414"></td><td cl=
ass=3D"line-content">                if (window.projInterval) clearInterval=
(window.projInterval);</td></tr><tr><td class=3D"line-number" value=3D"3415=
"></td><td class=3D"line-content">            }</td></tr><tr><td class=3D"l=
ine-number" value=3D"3416"></td><td class=3D"line-content">        }</td></=
tr><tr><td class=3D"line-number" value=3D"3417"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"3418"></td><td cl=
ass=3D"line-content">        async function renderProjectorBoard() {</td></=
tr><tr><td class=3D"line-number" value=3D"3419"></td><td class=3D"line-cont=
ent">            // Mock Data for Demo / if offline</td></tr><tr><td class=
=3D"line-number" value=3D"3420"></td><td class=3D"line-content">           =
 let progressData =3D [</td></tr><tr><td class=3D"line-number" value=3D"342=
1"></td><td class=3D"line-content">                { name: "Cadet Sarah", c=
lass: "Period 1", mission: "CUBA_62", steps: 4, status: "IN_PROGRESS" },</t=
d></tr><tr><td class=3D"line-number" value=3D"3422"></td><td class=3D"line-=
content">                { name: "Cadet John", class: "Period 1", mission: =
"CUBA_62", steps: 8, status: "READY" },</td></tr><tr><td class=3D"line-numb=
er" value=3D"3423"></td><td class=3D"line-content">                { name: =
"Cadet Mike", class: "Period 2", mission: "MARS_V1", steps: 2, status: "IN_=
PROGRESS" }</td></tr><tr><td class=3D"line-number" value=3D"3424"></td><td =
class=3D"line-content">            ];</td></tr><tr><td class=3D"line-number=
" value=3D"3425"></td><td class=3D"line-content"><br></td></tr><tr><td clas=
s=3D"line-number" value=3D"3426"></td><td class=3D"line-content">          =
  const board =3D document.getElementById('proj-board');</td></tr><tr><td c=
lass=3D"line-number" value=3D"3427"></td><td class=3D"line-content">       =
     const sync =3D document.getElementById('proj-sync');</td></tr><tr><td =
class=3D"line-number" value=3D"3428"></td><td class=3D"line-content">      =
      sync.innerText =3D `[SYNC: ${new Date().toLocaleTimeString()}]`;</td>=
</tr><tr><td class=3D"line-number" value=3D"3429"></td><td class=3D"line-co=
ntent"><br></td></tr><tr><td class=3D"line-number" value=3D"3430"></td><td =
class=3D"line-content">            let html =3D "";</td></tr><tr><td class=
=3D"line-number" value=3D"3431"></td><td class=3D"line-content">           =
 progressData.forEach(p =3D&gt; {</td></tr><tr><td class=3D"line-number" va=
lue=3D"3432"></td><td class=3D"line-content">                const pct =3D =
(p.steps / 10) * 100; // Assuming 10 steps</td></tr><tr><td class=3D"line-n=
umber" value=3D"3433"></td><td class=3D"line-content">                const=
 isReady =3D p.status =3D=3D=3D "READY";</td></tr><tr><td class=3D"line-num=
ber" value=3D"3434"></td><td class=3D"line-content"><br></td></tr><tr><td c=
lass=3D"line-number" value=3D"3435"></td><td class=3D"line-content">       =
         html +=3D `</td></tr><tr><td class=3D"line-number" value=3D"3436">=
</td><td class=3D"line-content">                 &lt;div class=3D"proj-card=
 ${p.steps &gt; 0 ? 'active' : ''}"&gt;</td></tr><tr><td class=3D"line-numb=
er" value=3D"3437"></td><td class=3D"line-content">                    &lt;=
div class=3D"proj-name"&gt;${p.name}&lt;/div&gt;</td></tr><tr><td class=3D"=
line-number" value=3D"3438"></td><td class=3D"line-content">               =
     &lt;div class=3D"proj-class"&gt;${p.class} // ${p.mission}&lt;/div&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"3439"></td><td class=3D"li=
ne-content">                    &lt;div class=3D"proj-stats"&gt;</td></tr><=
tr><td class=3D"line-number" value=3D"3440"></td><td class=3D"line-content"=
>                        &lt;div&gt;&lt;div style=3D"color:#d2b48c; font-si=
ze:0.5rem; text-transform:uppercase; margin-bottom:2px;"&gt;Intel&lt;/div&g=
t;&lt;div style=3D"font-size:0.75rem; color:#fff;"&gt;${p.steps}&lt;/div&gt=
;&lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"3441"></td><t=
d class=3D"line-content">                        &lt;div&gt;&lt;div style=
=3D"color:#d2b48c; font-size:0.5rem; text-transform:uppercase; margin-botto=
m:2px;"&gt;Status&lt;/div&gt;&lt;div style=3D"font-size:0.65rem; color:${is=
Ready ? '#0f0' : '#ff0'};"&gt;${p.status}&lt;/div&gt;&lt;/div&gt;</td></tr>=
<tr><td class=3D"line-number" value=3D"3442"></td><td class=3D"line-content=
">                    &lt;/div&gt;</td></tr><tr><td class=3D"line-number" v=
alue=3D"3443"></td><td class=3D"line-content">                    &lt;div c=
lass=3D"proj-bar"&gt;&lt;div class=3D"proj-fill" style=3D"width:${pct}%"&gt=
;&lt;/div&gt;&lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"3=
444"></td><td class=3D"line-content">                &lt;/div&gt;`;</td></t=
r><tr><td class=3D"line-number" value=3D"3445"></td><td class=3D"line-conte=
nt">            });</td></tr><tr><td class=3D"line-number" value=3D"3446"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"3447"></td><td class=3D"line-content">            board.innerHTML =
=3D html;</td></tr><tr><td class=3D"line-number" value=3D"3448"></td><td cl=
ass=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=
=3D"3449"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3450"></td><td class=3D"line-content">        // --- CL=
ASS MANAGEMENT FEATURES ---</td></tr><tr><td class=3D"line-number" value=3D=
"3451"></td><td class=3D"line-content">        let activeClassAssignId =3D =
null;</td></tr><tr><td class=3D"line-number" value=3D"3452"></td><td class=
=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3453=
"></td><td class=3D"line-content">        function toggleFavoriteClass(clas=
sId) {</td></tr><tr><td class=3D"line-number" value=3D"3454"></td><td class=
=3D"line-content">            // Local preference persistence for V3</td></=
tr><tr><td class=3D"line-number" value=3D"3455"></td><td class=3D"line-cont=
ent">            const key =3D `fav_class_${classId}`;</td></tr><tr><td cla=
ss=3D"line-number" value=3D"3456"></td><td class=3D"line-content">         =
   const current =3D localStorage.getItem(key);</td></tr><tr><td class=3D"l=
ine-number" value=3D"3457"></td><td class=3D"line-content">            if (=
current) localStorage.removeItem(key);</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3458"></td><td class=3D"line-content">            else localSto=
rage.setItem(key, "true");</td></tr><tr><td class=3D"line-number" value=3D"=
3459"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-n=
umber" value=3D"3460"></td><td class=3D"line-content">            // Re-ren=
der (In a real app, this would be a DB field)</td></tr><tr><td class=3D"lin=
e-number" value=3D"3461"></td><td class=3D"line-content">            // Mon=
key-patch the local data for immediate feedback</td></tr><tr><td class=3D"l=
ine-number" value=3D"3462"></td><td class=3D"line-content">            docu=
ment.querySelectorAll(`button[onclick=3D"toggleFavoriteClass('${classId}')"=
]`).forEach(btn =3D&gt; {</td></tr><tr><td class=3D"line-number" value=3D"3=
463"></td><td class=3D"line-content">                btn.classList.toggle('=
text-error');</td></tr><tr><td class=3D"line-number" value=3D"3464"></td><t=
d class=3D"line-content">                btn.classList.toggle('text-base-co=
ntent/20');</td></tr><tr><td class=3D"line-number" value=3D"3465"></td><td =
class=3D"line-content">            });</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3466"></td><td class=3D"line-content">            log("Class fa=
vorite status updated.", "info");</td></tr><tr><td class=3D"line-number" va=
lue=3D"3467"></td><td class=3D"line-content">        }</td></tr><tr><td cla=
ss=3D"line-number" value=3D"3468"></td><td class=3D"line-content"><br></td>=
</tr><tr><td class=3D"line-number" value=3D"3469"></td><td class=3D"line-co=
ntent">        function assignMissionUI(classId) {</td></tr><tr><td class=
=3D"line-number" value=3D"3470"></td><td class=3D"line-content">           =
 activeClassAssignId =3D classId;</td></tr><tr><td class=3D"line-number" va=
lue=3D"3471"></td><td class=3D"line-content">            const modal =3D do=
cument.createElement('dialog');</td></tr><tr><td class=3D"line-number" valu=
e=3D"3472"></td><td class=3D"line-content">            modal.className =3D =
'modal';</td></tr><tr><td class=3D"line-number" value=3D"3473"></td><td cla=
ss=3D"line-content">            modal.id =3D 'assign_mission_modal';</td></=
tr><tr><td class=3D"line-number" value=3D"3474"></td><td class=3D"line-cont=
ent"><br></td></tr><tr><td class=3D"line-number" value=3D"3475"></td><td cl=
ass=3D"line-content">            let missionOptions =3D '';</td></tr><tr><t=
d class=3D"line-number" value=3D"3476"></td><td class=3D"line-content">    =
        if (currentMissions.length =3D=3D=3D 0) {</td></tr><tr><td class=3D=
"line-number" value=3D"3477"></td><td class=3D"line-content">              =
  missionOptions =3D '&lt;div class=3D"p-4 opacity-50 text-center"&gt;No mi=
ssions in Library.&lt;/div&gt;';</td></tr><tr><td class=3D"line-number" val=
ue=3D"3478"></td><td class=3D"line-content">            } else {</td></tr><=
tr><td class=3D"line-number" value=3D"3479"></td><td class=3D"line-content"=
>                currentMissions.forEach(m =3D&gt; {</td></tr><tr><td class=
=3D"line-number" value=3D"3480"></td><td class=3D"line-content">           =
         missionOptions +=3D `</td></tr><tr><td class=3D"line-number" value=
=3D"3481"></td><td class=3D"line-content">                    &lt;div class=
=3D"form-control border-b border-base-content/10 p-2 hover:bg-base-200 curs=
or-pointer"&gt;</td></tr><tr><td class=3D"line-number" value=3D"3482"></td>=
<td class=3D"line-content">                        &lt;label class=3D"label=
 cursor-pointer justify-start gap-4"&gt;</td></tr><tr><td class=3D"line-num=
ber" value=3D"3483"></td><td class=3D"line-content">                       =
     &lt;input type=3D"checkbox" class=3D"checkbox checkbox-primary" value=
=3D"${m.id}" /&gt;</td></tr><tr><td class=3D"line-number" value=3D"3484"></=
td><td class=3D"line-content">                            &lt;div class=3D"=
flex flex-col"&gt;</td></tr><tr><td class=3D"line-number" value=3D"3485"></=
td><td class=3D"line-content">                                &lt;span clas=
s=3D"label-text font-bold text-primary"&gt;${m.metadata?.title || m.name}&l=
t;/span&gt;</td></tr><tr><td class=3D"line-number" value=3D"3486"></td><td =
class=3D"line-content">                                &lt;span class=3D"la=
bel-text-alt opacity-50"&gt;${m.metadata?.id || m.id}&lt;/span&gt;</td></tr=
><tr><td class=3D"line-number" value=3D"3487"></td><td class=3D"line-conten=
t">                            &lt;/div&gt;</td></tr><tr><td class=3D"line-=
number" value=3D"3488"></td><td class=3D"line-content">                    =
    &lt;/label&gt;</td></tr><tr><td class=3D"line-number" value=3D"3489"></=
td><td class=3D"line-content">                    &lt;/div&gt;`;</td></tr><=
tr><td class=3D"line-number" value=3D"3490"></td><td class=3D"line-content"=
>                });</td></tr><tr><td class=3D"line-number" value=3D"3491">=
</td><td class=3D"line-content">            }</td></tr><tr><td class=3D"lin=
e-number" value=3D"3492"></td><td class=3D"line-content"><br></td></tr><tr>=
<td class=3D"line-number" value=3D"3493"></td><td class=3D"line-content">  =
          modal.innerHTML =3D `</td></tr><tr><td class=3D"line-number" valu=
e=3D"3494"></td><td class=3D"line-content">                &lt;div class=3D=
"modal-box bg-base-100 border border-primary/20"&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"3495"></td><td class=3D"line-content">           =
         &lt;h3 class=3D"font-bold text-lg font-display text-primary mb-4"&=
gt;ASSIGN MISSIONS TO CLASS&lt;/h3&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3496"></td><td class=3D"line-content">                    &lt;d=
iv class=3D"max-h-60 overflow-y-auto border border-base-300 rounded-lg"&gt;=
</td></tr><tr><td class=3D"line-number" value=3D"3497"></td><td class=3D"li=
ne-content">                        ${missionOptions}</td></tr><tr><td clas=
s=3D"line-number" value=3D"3498"></td><td class=3D"line-content">          =
          &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"3499=
"></td><td class=3D"line-content">                    &lt;div class=3D"moda=
l-action"&gt;</td></tr><tr><td class=3D"line-number" value=3D"3500"></td><t=
d class=3D"line-content">                        &lt;button class=3D"btn bt=
n-primary btn-sm" onclick=3D"confirmAssignment()"&gt;CONFIRM ASSIGNMENT&lt;=
/button&gt;</td></tr><tr><td class=3D"line-number" value=3D"3501"></td><td =
class=3D"line-content">                        &lt;form method=3D"dialog"&g=
t;&lt;button class=3D"btn btn-ghost btn-sm"&gt;CANCEL&lt;/button&gt;&lt;/fo=
rm&gt;</td></tr><tr><td class=3D"line-number" value=3D"3502"></td><td class=
=3D"line-content">                    &lt;/div&gt;</td></tr><tr><td class=
=3D"line-number" value=3D"3503"></td><td class=3D"line-content">           =
     &lt;/div&gt;</td></tr><tr><td class=3D"line-number" value=3D"3504"></t=
d><td class=3D"line-content">                &lt;form method=3D"dialog" cla=
ss=3D"modal-backdrop"&gt;&lt;button&gt;close&lt;/button&gt;&lt;/form&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"3505"></td><td class=3D"line-=
content">            `;</td></tr><tr><td class=3D"line-number" value=3D"350=
6"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numb=
er" value=3D"3507"></td><td class=3D"line-content">            document.bod=
y.appendChild(modal);</td></tr><tr><td class=3D"line-number" value=3D"3508"=
></td><td class=3D"line-content">            modal.showModal();</td></tr><t=
r><td class=3D"line-number" value=3D"3509"></td><td class=3D"line-content">=
            modal.addEventListener('close', () =3D&gt; modal.remove());</td=
></tr><tr><td class=3D"line-number" value=3D"3510"></td><td class=3D"line-c=
ontent">        }</td></tr><tr><td class=3D"line-number" value=3D"3511"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"3512"></td><td class=3D"line-content">        function confirmAssign=
ment() {</td></tr><tr><td class=3D"line-number" value=3D"3513"></td><td cla=
ss=3D"line-content">            const checks =3D document.querySelectorAll(=
'#assign_mission_modal input:checked');</td></tr><tr><td class=3D"line-numb=
er" value=3D"3514"></td><td class=3D"line-content">            const ids =
=3D Array.from(checks).map(c =3D&gt; c.value);</td></tr><tr><td class=3D"li=
ne-number" value=3D"3515"></td><td class=3D"line-content"><br></td></tr><tr=
><td class=3D"line-number" value=3D"3516"></td><td class=3D"line-content"> =
           if (ids.length &gt; 0) {</td></tr><tr><td class=3D"line-number" =
value=3D"3517"></td><td class=3D"line-content">                // Update lo=
cal class data with assigned missions</td></tr><tr><td class=3D"line-number=
" value=3D"3518"></td><td class=3D"line-content">                if (window=
.activeClassesData) {</td></tr><tr><td class=3D"line-number" value=3D"3519"=
></td><td class=3D"line-content">                    const classToUpdate =
=3D window.activeClassesData.find(c =3D&gt; c.id =3D=3D=3D activeClassAssig=
nId);</td></tr><tr><td class=3D"line-number" value=3D"3520"></td><td class=
=3D"line-content">                    if (classToUpdate) {</td></tr><tr><td=
 class=3D"line-number" value=3D"3521"></td><td class=3D"line-content">     =
                   if (!classToUpdate.mission_ids) classToUpdate.mission_id=
s =3D [];</td></tr><tr><td class=3D"line-number" value=3D"3522"></td><td cl=
ass=3D"line-content">                        ids.forEach(id =3D&gt; {</td><=
/tr><tr><td class=3D"line-number" value=3D"3523"></td><td class=3D"line-con=
tent">                            if (!classToUpdate.mission_ids.includes(i=
d)) {</td></tr><tr><td class=3D"line-number" value=3D"3524"></td><td class=
=3D"line-content">                                classToUpdate.mission_ids=
.push(id);</td></tr><tr><td class=3D"line-number" value=3D"3525"></td><td c=
lass=3D"line-content">                            }</td></tr><tr><td class=
=3D"line-number" value=3D"3526"></td><td class=3D"line-content">           =
             });</td></tr><tr><td class=3D"line-number" value=3D"3527"></td=
><td class=3D"line-content">                        // Re-render the class =
list with updated data</td></tr><tr><td class=3D"line-number" value=3D"3528=
"></td><td class=3D"line-content">                        renderClasses(win=
dow.activeClassesData);</td></tr><tr><td class=3D"line-number" value=3D"352=
9"></td><td class=3D"line-content">                    }</td></tr><tr><td c=
lass=3D"line-number" value=3D"3530"></td><td class=3D"line-content">       =
         }</td></tr><tr><td class=3D"line-number" value=3D"3531"></td><td c=
lass=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"=
3532"></td><td class=3D"line-content">                log(`Assigned ${ids.l=
ength} missions to Class [${activeClassAssignId}].`, "success");</td></tr><=
tr><td class=3D"line-number" value=3D"3533"></td><td class=3D"line-content"=
>                // Ideally: SupabaseBridge.assignMissions(activeClassAssig=
nId, ids);</td></tr><tr><td class=3D"line-number" value=3D"3534"></td><td c=
lass=3D"line-content">            }</td></tr><tr><td class=3D"line-number" =
value=3D"3535"></td><td class=3D"line-content">            document.getElem=
entById('assign_mission_modal').close();</td></tr><tr><td class=3D"line-num=
ber" value=3D"3536"></td><td class=3D"line-content">        }</td></tr><tr>=
<td class=3D"line-number" value=3D"3537"></td><td class=3D"line-content"><b=
r></td></tr><tr><td class=3D"line-number" value=3D"3538"></td><td class=3D"=
line-content">        function manageStudentsUI(passcode) {</td></tr><tr><t=
d class=3D"line-number" value=3D"3539"></td><td class=3D"line-content">    =
        const modalId =3D 'manage_roster_modal';</td></tr><tr><td class=3D"=
line-number" value=3D"3540"></td><td class=3D"line-content">            let=
 existing =3D document.getElementById(modalId);</td></tr><tr><td class=3D"l=
ine-number" value=3D"3541"></td><td class=3D"line-content">            if (=
existing) existing.remove();</td></tr><tr><td class=3D"line-number" value=
=3D"3542"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3543"></td><td class=3D"line-content">            const=
 modal =3D document.createElement('dialog');</td></tr><tr><td class=3D"line=
-number" value=3D"3544"></td><td class=3D"line-content">            modal.i=
d =3D modalId;</td></tr><tr><td class=3D"line-number" value=3D"3545"></td><=
td class=3D"line-content">            modal.className =3D 'modal';</td></tr=
><tr><td class=3D"line-number" value=3D"3546"></td><td class=3D"line-conten=
t"><br></td></tr><tr><td class=3D"line-number" value=3D"3547"></td><td clas=
s=3D"line-content">            // Use a semi-persistent mock list for the s=
ession</td></tr><tr><td class=3D"line-number" value=3D"3548"></td><td class=
=3D"line-content">            if (!window.activeRoster) {</td></tr><tr><td =
class=3D"line-number" value=3D"3549"></td><td class=3D"line-content">      =
          window.activeRoster =3D [</td></tr><tr><td class=3D"line-number" =
value=3D"3550"></td><td class=3D"line-content">                    { name: =
"Cadet Sarah", status: "ONLINE", score: 85 },</td></tr><tr><td class=3D"lin=
e-number" value=3D"3551"></td><td class=3D"line-content">                  =
  { name: "Cadet John", status: "OFFLINE", score: 42 },</td></tr><tr><td cl=
ass=3D"line-number" value=3D"3552"></td><td class=3D"line-content">        =
            { name: "Cadet Mike", status: "ONLINE", score: 92 }</td></tr><t=
r><td class=3D"line-number" value=3D"3553"></td><td class=3D"line-content">=
                ];</td></tr><tr><td class=3D"line-number" value=3D"3554"></=
td><td class=3D"line-content">            }</td></tr><tr><td class=3D"line-=
number" value=3D"3555"></td><td class=3D"line-content"><br></td></tr><tr><t=
d class=3D"line-number" value=3D"3556"></td><td class=3D"line-content">    =
        const renderRows =3D () =3D&gt; {</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3557"></td><td class=3D"line-content">                return=
 window.activeRoster.map(s =3D&gt; `</td></tr><tr><td class=3D"line-number"=
 value=3D"3558"></td><td class=3D"line-content">                    &lt;tr =
class=3D"hover" id=3D"roster-row-${s.name.replace(/\s+/g, '-')}"&gt;</td></=
tr><tr><td class=3D"line-number" value=3D"3559"></td><td class=3D"line-cont=
ent">                        &lt;td class=3D"font-bold"&gt;${s.name}&lt;/td=
&gt;</td></tr><tr><td class=3D"line-number" value=3D"3560"></td><td class=
=3D"line-content">                        &lt;td&gt;&lt;div class=3D"badge =
${s.status =3D=3D=3D 'ONLINE' ? 'badge-success' : 'badge-ghost'} badge-xs m=
r-1"&gt;&lt;/div&gt; ${s.status}&lt;/td&gt;</td></tr><tr><td class=3D"line-=
number" value=3D"3561"></td><td class=3D"line-content">                    =
    &lt;td class=3D"font-mono text-xs"&gt;${s.score}%&lt;/td&gt;</td></tr><=
tr><td class=3D"line-number" value=3D"3562"></td><td class=3D"line-content"=
>                        &lt;td&gt;&lt;button class=3D"btn btn-xs btn-error=
 btn-outline" onclick=3D"kickStudentUI('${s.name}', '${passcode}')"&gt;KICK=
&lt;/button&gt;&lt;/td&gt;</td></tr><tr><td class=3D"line-number" value=3D"=
3563"></td><td class=3D"line-content">                    &lt;/tr&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"3564"></td><td class=3D"line-con=
tent">                `).join('');</td></tr><tr><td class=3D"line-number" v=
alue=3D"3565"></td><td class=3D"line-content">            };</td></tr><tr><=
td class=3D"line-number" value=3D"3566"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"3567"></td><td class=3D"l=
ine-content">            modal.innerHTML =3D `</td></tr><tr><td class=3D"li=
ne-number" value=3D"3568"></td><td class=3D"line-content">                &=
lt;div class=3D"modal-box"&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"3569"></td><td class=3D"line-content">                    &lt;h3 class=
=3D"font-bold text-lg font-display text-secondary mb-2"&gt;CLASS ROSTER [${=
passcode}]&lt;/h3&gt;</td></tr><tr><td class=3D"line-number" value=3D"3570"=
></td><td class=3D"line-content">                    </td></tr><tr><td clas=
s=3D"line-number" value=3D"3571"></td><td class=3D"line-content">          =
          &lt;div class=3D"overflow-x-auto h-64 border border-base-300 roun=
ded mb-4 bg-black/10"&gt;</td></tr><tr><td class=3D"line-number" value=3D"3=
572"></td><td class=3D"line-content">                        &lt;table clas=
s=3D"table table-xs w-full"&gt;</td></tr><tr><td class=3D"line-number" valu=
e=3D"3573"></td><td class=3D"line-content">                            &lt;=
thead&gt;</td></tr><tr><td class=3D"line-number" value=3D"3574"></td><td cl=
ass=3D"line-content">                                &lt;tr&gt;</td></tr><t=
r><td class=3D"line-number" value=3D"3575"></td><td class=3D"line-content">=
                                    &lt;th&gt;Cadet Name&lt;/th&gt;</td></t=
r><tr><td class=3D"line-number" value=3D"3576"></td><td class=3D"line-conte=
nt">                                    &lt;th&gt;Status&lt;/th&gt;</td></t=
r><tr><td class=3D"line-number" value=3D"3577"></td><td class=3D"line-conte=
nt">                                    &lt;th&gt;Progress&lt;/th&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"3578"></td><td class=3D"line-con=
tent">                                    &lt;th&gt;Action&lt;/th&gt;</td><=
/tr><tr><td class=3D"line-number" value=3D"3579"></td><td class=3D"line-con=
tent">                                &lt;/tr&gt;</td></tr><tr><td class=3D=
"line-number" value=3D"3580"></td><td class=3D"line-content">              =
              &lt;/thead&gt;</td></tr><tr><td class=3D"line-number" value=
=3D"3581"></td><td class=3D"line-content">                            &lt;t=
body id=3D"roster-tbody"&gt;${renderRows()}&lt;/tbody&gt;</td></tr><tr><td =
class=3D"line-number" value=3D"3582"></td><td class=3D"line-content">      =
                  &lt;/table&gt;</td></tr><tr><td class=3D"line-number" val=
ue=3D"3583"></td><td class=3D"line-content">                    &lt;/div&gt=
;</td></tr><tr><td class=3D"line-number" value=3D"3584"></td><td class=3D"l=
ine-content">                    </td></tr><tr><td class=3D"line-number" va=
lue=3D"3585"></td><td class=3D"line-content">                    &lt;div cl=
ass=3D"alert alert-info text-xs py-2 mb-4"&gt;</td></tr><tr><td class=3D"li=
ne-number" value=3D"3586"></td><td class=3D"line-content">                 =
       &lt;svg xmlns=3D"http://www.w3.org/2000/svg" fill=3D"none" viewBox=
=3D"0 0 24 24" class=3D"stroke-current shrink-0 w-4 h-4"&gt;&lt;path stroke=
-linecap=3D"round" stroke-linejoin=3D"round" stroke-width=3D"2" d=3D"M13 16=
h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"&gt;&lt;/path&gt;&lt;/s=
vg&gt;</td></tr><tr><td class=3D"line-number" value=3D"3587"></td><td class=
=3D"line-content">                        &lt;span&gt;Live updates require =
Supabase connection. Manage seats in Admin panel.&lt;/span&gt;</td></tr><tr=
><td class=3D"line-number" value=3D"3588"></td><td class=3D"line-content"> =
                   &lt;/div&gt;</td></tr><tr><td class=3D"line-number" valu=
e=3D"3589"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"l=
ine-number" value=3D"3590"></td><td class=3D"line-content">                =
    &lt;div class=3D"modal-action"&gt;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3591"></td><td class=3D"line-content">                        &=
lt;form method=3D"dialog"&gt;&lt;button class=3D"btn btn-sm"&gt;Close&lt;/b=
utton&gt;&lt;/form&gt;</td></tr><tr><td class=3D"line-number" value=3D"3592=
"></td><td class=3D"line-content">                    &lt;/div&gt;</td></tr=
><tr><td class=3D"line-number" value=3D"3593"></td><td class=3D"line-conten=
t">                &lt;/div&gt;</td></tr><tr><td class=3D"line-number" valu=
e=3D"3594"></td><td class=3D"line-content">                &lt;form method=
=3D"dialog" class=3D"modal-backdrop"&gt;&lt;button&gt;close&lt;/button&gt;&=
lt;/form&gt;</td></tr><tr><td class=3D"line-number" value=3D"3595"></td><td=
 class=3D"line-content">            `;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3596"></td><td class=3D"line-content">            document.body=
.appendChild(modal);</td></tr><tr><td class=3D"line-number" value=3D"3597">=
</td><td class=3D"line-content">            modal.showModal();</td></tr><tr=
><td class=3D"line-number" value=3D"3598"></td><td class=3D"line-content"> =
       }</td></tr><tr><td class=3D"line-number" value=3D"3599"></td><td cla=
ss=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"36=
00"></td><td class=3D"line-content">        window.kickStudentUI =3D functi=
on (name, passcode) {</td></tr><tr><td class=3D"line-number" value=3D"3601"=
></td><td class=3D"line-content">            if (!confirm(`Are you sure you=
 want to kick ${name} from class ${passcode}?`)) return;</td></tr><tr><td c=
lass=3D"line-number" value=3D"3602"></td><td class=3D"line-content"><br></t=
d></tr><tr><td class=3D"line-number" value=3D"3603"></td><td class=3D"line-=
content">            // Update state</td></tr><tr><td class=3D"line-number"=
 value=3D"3604"></td><td class=3D"line-content">            if (window.acti=
veRoster) {</td></tr><tr><td class=3D"line-number" value=3D"3605"></td><td =
class=3D"line-content">                window.activeRoster =3D window.activ=
eRoster.filter(s =3D&gt; s.name !=3D=3D name);</td></tr><tr><td class=3D"li=
ne-number" value=3D"3606"></td><td class=3D"line-content">            }</td=
></tr><tr><td class=3D"line-number" value=3D"3607"></td><td class=3D"line-c=
ontent"><br></td></tr><tr><td class=3D"line-number" value=3D"3608"></td><td=
 class=3D"line-content">            // Update UI if the modal is open</td><=
/tr><tr><td class=3D"line-number" value=3D"3609"></td><td class=3D"line-con=
tent">            const tbody =3D document.getElementById('roster-tbody');<=
/td></tr><tr><td class=3D"line-number" value=3D"3610"></td><td class=3D"lin=
e-content">            if (tbody) {</td></tr><tr><td class=3D"line-number" =
value=3D"3611"></td><td class=3D"line-content">                const rows =
=3D window.activeRoster.map(s =3D&gt; `</td></tr><tr><td class=3D"line-numb=
er" value=3D"3612"></td><td class=3D"line-content">                    &lt;=
tr class=3D"hover" id=3D"roster-row-${s.name.replace(/\s+/g, '-')}"&gt;</td=
></tr><tr><td class=3D"line-number" value=3D"3613"></td><td class=3D"line-c=
ontent">                        &lt;td class=3D"font-bold"&gt;${s.name}&lt;=
/td&gt;</td></tr><tr><td class=3D"line-number" value=3D"3614"></td><td clas=
s=3D"line-content">                        &lt;td&gt;&lt;div class=3D"badge=
 ${s.status =3D=3D=3D 'ONLINE' ? 'badge-success' : 'badge-ghost'} badge-xs =
mr-1"&gt;&lt;/div&gt; ${s.status}&lt;/td&gt;</td></tr><tr><td class=3D"line=
-number" value=3D"3615"></td><td class=3D"line-content">                   =
     &lt;td class=3D"font-mono text-xs"&gt;${s.score}%&lt;/td&gt;</td></tr>=
<tr><td class=3D"line-number" value=3D"3616"></td><td class=3D"line-content=
">                        &lt;td&gt;&lt;button class=3D"btn btn-xs btn-erro=
r btn-outline" onclick=3D"kickStudentUI('${s.name}', '${passcode}')"&gt;KIC=
K&lt;/button&gt;&lt;/td&gt;</td></tr><tr><td class=3D"line-number" value=3D=
"3617"></td><td class=3D"line-content">                    &lt;/tr&gt;</td>=
</tr><tr><td class=3D"line-number" value=3D"3618"></td><td class=3D"line-co=
ntent">                `).join('');</td></tr><tr><td class=3D"line-number" =
value=3D"3619"></td><td class=3D"line-content">                tbody.innerH=
TML =3D rows;</td></tr><tr><td class=3D"line-number" value=3D"3620"></td><t=
d class=3D"line-content">            }</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3621"></td><td class=3D"line-content"><br></td></tr><tr><td cla=
ss=3D"line-number" value=3D"3622"></td><td class=3D"line-content">         =
   log(`Kicked ${name} from roster.`, "warning");</td></tr><tr><td class=3D=
"line-number" value=3D"3623"></td><td class=3D"line-content">        };</td=
></tr><tr><td class=3D"line-number" value=3D"3624"></td><td class=3D"line-c=
ontent"><br></td></tr><tr><td class=3D"line-number" value=3D"3625"></td><td=
 class=3D"line-content">        // --- PAGE INITIALIZATION ---</td></tr><tr=
><td class=3D"line-number" value=3D"3626"></td><td class=3D"line-content"> =
       window.onload =3D () =3D&gt; {</td></tr><tr><td class=3D"line-number=
" value=3D"3627"></td><td class=3D"line-content">            // Initialize =
Supabase Bridge</td></tr><tr><td class=3D"line-number" value=3D"3628"></td>=
<td class=3D"line-content">            if (typeof SupabaseBridge !=3D=3D 'u=
ndefined' &amp;&amp; SB_URL &amp;&amp; SB_KEY) {</td></tr><tr><td class=3D"=
line-number" value=3D"3629"></td><td class=3D"line-content">               =
 const connected =3D SupabaseBridge.init(SB_URL, SB_KEY);</td></tr><tr><td =
class=3D"line-number" value=3D"3630"></td><td class=3D"line-content">      =
          if (connected) {</td></tr><tr><td class=3D"line-number" value=3D"=
3631"></td><td class=3D"line-content">                    const badge =3D d=
ocument.getElementById('status-badge-sb');</td></tr><tr><td class=3D"line-n=
umber" value=3D"3632"></td><td class=3D"line-content">                    i=
f (badge) {</td></tr><tr><td class=3D"line-number" value=3D"3633"></td><td =
class=3D"line-content">                        badge.innerHTML =3D `&lt;div=
 class=3D"w-1.5 h-1.5 rounded-full bg-success"&gt;&lt;/div&gt; SB_ONLINE`;<=
/td></tr><tr><td class=3D"line-number" value=3D"3634"></td><td class=3D"lin=
e-content">                        badge.classList.remove('badge-outline');=
</td></tr><tr><td class=3D"line-number" value=3D"3635"></td><td class=3D"li=
ne-content">                        badge.classList.add('badge-success', 't=
ext-white');</td></tr><tr><td class=3D"line-number" value=3D"3636"></td><td=
 class=3D"line-content">                    }</td></tr><tr><td class=3D"lin=
e-number" value=3D"3637"></td><td class=3D"line-content">                  =
  log("Supabase Uplink Established.", "success");</td></tr><tr><td class=3D=
"line-number" value=3D"3638"></td><td class=3D"line-content">              =
  }</td></tr><tr><td class=3D"line-number" value=3D"3639"></td><td class=3D=
"line-content">            }</td></tr><tr><td class=3D"line-number" value=
=3D"3640"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3641"></td><td class=3D"line-content">            initG=
oogleAuth();</td></tr><tr><td class=3D"line-number" value=3D"3642"></td><td=
 class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=
=3D"3643"></td><td class=3D"line-content">            // Sync saved Builder=
 model on load</td></tr><tr><td class=3D"line-number" value=3D"3644"></td><=
td class=3D"line-content">            const savedBModel =3D localStorage.ge=
tItem('TM_BUILDER_MODEL');</td></tr><tr><td class=3D"line-number" value=3D"=
3645"></td><td class=3D"line-content">            if (savedBModel &amp;&amp=
; document.getElementById('f-model')) {</td></tr><tr><td class=3D"line-numb=
er" value=3D"3646"></td><td class=3D"line-content">                document=
.getElementById('f-model').value =3D savedBModel;</td></tr><tr><td class=3D=
"line-number" value=3D"3647"></td><td class=3D"line-content">            }<=
/td></tr><tr><td class=3D"line-number" value=3D"3648"></td><td class=3D"lin=
e-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3649"></td>=
<td class=3D"line-content">            updateBuilderUI();</td></tr><tr><td =
class=3D"line-number" value=3D"3650"></td><td class=3D"line-content">      =
      log("Command Center v3.0 Initialized.");</td></tr><tr><td class=3D"li=
ne-number" value=3D"3651"></td><td class=3D"line-content">            refre=
shClasses();</td></tr><tr><td class=3D"line-number" value=3D"3652"></td><td=
 class=3D"line-content">            fetchMissions();</td></tr><tr><td class=
=3D"line-number" value=3D"3653"></td><td class=3D"line-content">           =
 fetchCurriculum();</td></tr><tr><td class=3D"line-number" value=3D"3654"><=
/td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" =
value=3D"3655"></td><td class=3D"line-content">            // Force Auth Pr=
ompt if Guest</td></tr><tr><td class=3D"line-number" value=3D"3656"></td><t=
d class=3D"line-content">            setTimeout(() =3D&gt; {</td></tr><tr><=
td class=3D"line-number" value=3D"3657"></td><td class=3D"line-content">   =
             if (!googleUser || googleUser.email =3D=3D=3D 'GUEST') {</td><=
/tr><tr><td class=3D"line-number" value=3D"3658"></td><td class=3D"line-con=
tent">                    openAuthModal();</td></tr><tr><td class=3D"line-n=
umber" value=3D"3659"></td><td class=3D"line-content">                }</td=
></tr><tr><td class=3D"line-number" value=3D"3660"></td><td class=3D"line-c=
ontent">            }, 1500);</td></tr><tr><td class=3D"line-number" value=
=3D"3661"></td><td class=3D"line-content">        };</td></tr><tr><td class=
=3D"line-number" value=3D"3662"></td><td class=3D"line-content">    <span c=
lass=3D"html-tag">&lt;/script&gt;</span></td></tr><tr><td class=3D"line-num=
ber" value=3D"3663"></td><td class=3D"line-content"><br></td></tr><tr><td c=
lass=3D"line-number" value=3D"3664"></td><td class=3D"line-content">    <sp=
an class=3D"html-comment">&lt;!-- [PORTED] PROJECTOR VIEW OVERLAY --&gt;</s=
pan></td></tr><tr><td class=3D"line-number" value=3D"3665"></td><td class=
=3D"line-content">    <span class=3D"html-tag">&lt;style&gt;</span></td></t=
r><tr><td class=3D"line-number" value=3D"3666"></td><td class=3D"line-conte=
nt">        /* [PORTED] PROJECTOR VIEW CSS */</td></tr><tr><td class=3D"lin=
e-number" value=3D"3667"></td><td class=3D"line-content">        #projector=
-view {</td></tr><tr><td class=3D"line-number" value=3D"3668"></td><td clas=
s=3D"line-content">            display: none;</td></tr><tr><td class=3D"lin=
e-number" value=3D"3669"></td><td class=3D"line-content">            positi=
on: fixed;</td></tr><tr><td class=3D"line-number" value=3D"3670"></td><td c=
lass=3D"line-content">            top: 0;</td></tr><tr><td class=3D"line-nu=
mber" value=3D"3671"></td><td class=3D"line-content">            left: 0;</=
td></tr><tr><td class=3D"line-number" value=3D"3672"></td><td class=3D"line=
-content">            width: 100vw;</td></tr><tr><td class=3D"line-number" =
value=3D"3673"></td><td class=3D"line-content">            height: 100vh;</=
td></tr><tr><td class=3D"line-number" value=3D"3674"></td><td class=3D"line=
-content">            background: #000;</td></tr><tr><td class=3D"line-numb=
er" value=3D"3675"></td><td class=3D"line-content">            z-index: 999=
9;</td></tr><tr><td class=3D"line-number" value=3D"3676"></td><td class=3D"=
line-content">            flex-direction: column;</td></tr><tr><td class=3D=
"line-number" value=3D"3677"></td><td class=3D"line-content">            pa=
dding: 20px;</td></tr><tr><td class=3D"line-number" value=3D"3678"></td><td=
 class=3D"line-content">            box-sizing: border-box;</td></tr><tr><t=
d class=3D"line-number" value=3D"3679"></td><td class=3D"line-content">    =
        background-image:</td></tr><tr><td class=3D"line-number" value=3D"3=
680"></td><td class=3D"line-content">                linear-gradient(rgba(0=
, 255, 100, 0.03) 1px, transparent 1px),</td></tr><tr><td class=3D"line-num=
ber" value=3D"3681"></td><td class=3D"line-content">                linear-=
gradient(90deg, rgba(0, 255, 100, 0.03) 1px, transparent 1px);</td></tr><tr=
><td class=3D"line-number" value=3D"3682"></td><td class=3D"line-content"> =
           background-size: 30px 30px;</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3683"></td><td class=3D"line-content">        }</td></tr><tr><t=
d class=3D"line-number" value=3D"3684"></td><td class=3D"line-content"><br>=
</td></tr><tr><td class=3D"line-number" value=3D"3685"></td><td class=3D"li=
ne-content">        #projector-view.active {</td></tr><tr><td class=3D"line=
-number" value=3D"3686"></td><td class=3D"line-content">            display=
: flex;</td></tr><tr><td class=3D"line-number" value=3D"3687"></td><td clas=
s=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=
=3D"3688"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"li=
ne-number" value=3D"3689"></td><td class=3D"line-content">        .proj-hea=
der {</td></tr><tr><td class=3D"line-number" value=3D"3690"></td><td class=
=3D"line-content">            display: flex;</td></tr><tr><td class=3D"line=
-number" value=3D"3691"></td><td class=3D"line-content">            justify=
-content: space-between;</td></tr><tr><td class=3D"line-number" value=3D"36=
92"></td><td class=3D"line-content">            align-items: center;</td></=
tr><tr><td class=3D"line-number" value=3D"3693"></td><td class=3D"line-cont=
ent">            border-bottom: 2px solid #333;</td></tr><tr><td class=3D"l=
ine-number" value=3D"3694"></td><td class=3D"line-content">            padd=
ing-bottom: 15px;</td></tr><tr><td class=3D"line-number" value=3D"3695"></t=
d><td class=3D"line-content">            margin-bottom: 20px;</td></tr><tr>=
<td class=3D"line-number" value=3D"3696"></td><td class=3D"line-content">  =
      }</td></tr><tr><td class=3D"line-number" value=3D"3697"></td><td clas=
s=3D"line-content"><br></td></tr><tr><td class=3D"line-number" value=3D"369=
8"></td><td class=3D"line-content">        .proj-header h1 {</td></tr><tr><=
td class=3D"line-number" value=3D"3699"></td><td class=3D"line-content">   =
         font-family: 'Oswald', sans-serif;</td></tr><tr><td class=3D"line-=
number" value=3D"3700"></td><td class=3D"line-content">            font-siz=
e: 2.5rem;</td></tr><tr><td class=3D"line-number" value=3D"3701"></td><td c=
lass=3D"line-content">            color: #d2b48c;</td></tr><tr><td class=3D=
"line-number" value=3D"3702"></td><td class=3D"line-content">            ma=
rgin: 0;</td></tr><tr><td class=3D"line-number" value=3D"3703"></td><td cla=
ss=3D"line-content">            letter-spacing: 5px;</td></tr><tr><td class=
=3D"line-number" value=3D"3704"></td><td class=3D"line-content">           =
 text-transform: uppercase;</td></tr><tr><td class=3D"line-number" value=3D=
"3705"></td><td class=3D"line-content">        }</td></tr><tr><td class=3D"=
line-number" value=3D"3706"></td><td class=3D"line-content"><br></td></tr><=
tr><td class=3D"line-number" value=3D"3707"></td><td class=3D"line-content"=
>        .proj-grid {</td></tr><tr><td class=3D"line-number" value=3D"3708"=
></td><td class=3D"line-content">            display: grid;</td></tr><tr><t=
d class=3D"line-number" value=3D"3709"></td><td class=3D"line-content">    =
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));</td><=
/tr><tr><td class=3D"line-number" value=3D"3710"></td><td class=3D"line-con=
tent">            gap: 15px;</td></tr><tr><td class=3D"line-number" value=
=3D"3711"></td><td class=3D"line-content">            flex: 1;</td></tr><tr=
><td class=3D"line-number" value=3D"3712"></td><td class=3D"line-content"> =
           overflow-y: auto;</td></tr><tr><td class=3D"line-number" value=
=3D"3713"></td><td class=3D"line-content">            padding: 10px;</td></=
tr><tr><td class=3D"line-number" value=3D"3714"></td><td class=3D"line-cont=
ent">            align-content: flex-start;</td></tr><tr><td class=3D"line-=
number" value=3D"3715"></td><td class=3D"line-content">        }</td></tr><=
tr><td class=3D"line-number" value=3D"3716"></td><td class=3D"line-content"=
><br></td></tr><tr><td class=3D"line-number" value=3D"3717"></td><td class=
=3D"line-content">        .proj-card {</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3718"></td><td class=3D"line-content">            background: #=
111;</td></tr><tr><td class=3D"line-number" value=3D"3719"></td><td class=
=3D"line-content">            border: 1px solid #333;</td></tr><tr><td clas=
s=3D"line-number" value=3D"3720"></td><td class=3D"line-content">          =
  padding: 15px;</td></tr><tr><td class=3D"line-number" value=3D"3721"></td=
><td class=3D"line-content">            border-radius: 4px;</td></tr><tr><t=
d class=3D"line-number" value=3D"3722"></td><td class=3D"line-content">    =
        opacity: 0.5;</td></tr><tr><td class=3D"line-number" value=3D"3723"=
></td><td class=3D"line-content">            transition: all 0.3s ease;</td=
></tr><tr><td class=3D"line-number" value=3D"3724"></td><td class=3D"line-c=
ontent">            position: relative;</td></tr><tr><td class=3D"line-numb=
er" value=3D"3725"></td><td class=3D"line-content">            overflow: hi=
dden;</td></tr><tr><td class=3D"line-number" value=3D"3726"></td><td class=
=3D"line-content">        }</td></tr><tr><td class=3D"line-number" value=3D=
"3727"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-=
number" value=3D"3728"></td><td class=3D"line-content">        .proj-card.a=
ctive {</td></tr><tr><td class=3D"line-number" value=3D"3729"></td><td clas=
s=3D"line-content">            opacity: 1;</td></tr><tr><td class=3D"line-n=
umber" value=3D"3730"></td><td class=3D"line-content">            border-co=
lor: #555;</td></tr><tr><td class=3D"line-number" value=3D"3731"></td><td c=
lass=3D"line-content">            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5)=
;</td></tr><tr><td class=3D"line-number" value=3D"3732"></td><td class=3D"l=
ine-content">        }</td></tr><tr><td class=3D"line-number" value=3D"3733=
"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-numbe=
r" value=3D"3734"></td><td class=3D"line-content">        .proj-card.active=
::before {</td></tr><tr><td class=3D"line-number" value=3D"3735"></td><td c=
lass=3D"line-content">            content: '';</td></tr><tr><td class=3D"li=
ne-number" value=3D"3736"></td><td class=3D"line-content">            posit=
ion: absolute;</td></tr><tr><td class=3D"line-number" value=3D"3737"></td><=
td class=3D"line-content">            top: 0;</td></tr><tr><td class=3D"lin=
e-number" value=3D"3738"></td><td class=3D"line-content">            left: =
0;</td></tr><tr><td class=3D"line-number" value=3D"3739"></td><td class=3D"=
line-content">            width: 4px;</td></tr><tr><td class=3D"line-number=
" value=3D"3740"></td><td class=3D"line-content">            height: 100%;<=
/td></tr><tr><td class=3D"line-number" value=3D"3741"></td><td class=3D"lin=
e-content">            background: #00ffcc;</td></tr><tr><td class=3D"line-=
number" value=3D"3742"></td><td class=3D"line-content">        }</td></tr><=
tr><td class=3D"line-number" value=3D"3743"></td><td class=3D"line-content"=
><br></td></tr><tr><td class=3D"line-number" value=3D"3744"></td><td class=
=3D"line-content">        .proj-name {</td></tr><tr><td class=3D"line-numbe=
r" value=3D"3745"></td><td class=3D"line-content">            font-family: =
'Oswald', sans-serif;</td></tr><tr><td class=3D"line-number" value=3D"3746"=
></td><td class=3D"line-content">            font-size: 1.1rem;</td></tr><t=
r><td class=3D"line-number" value=3D"3747"></td><td class=3D"line-content">=
            color: #fff;</td></tr><tr><td class=3D"line-number" value=3D"37=
48"></td><td class=3D"line-content">            margin-bottom: 5px;</td></t=
r><tr><td class=3D"line-number" value=3D"3749"></td><td class=3D"line-conte=
nt">            white-space: nowrap;</td></tr><tr><td class=3D"line-number"=
 value=3D"3750"></td><td class=3D"line-content">            overflow: hidde=
n;</td></tr><tr><td class=3D"line-number" value=3D"3751"></td><td class=3D"=
line-content">            text-overflow: ellipsis;</td></tr><tr><td class=
=3D"line-number" value=3D"3752"></td><td class=3D"line-content">        }</=
td></tr><tr><td class=3D"line-number" value=3D"3753"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3754"></td><=
td class=3D"line-content">        .proj-class {</td></tr><tr><td class=3D"l=
ine-number" value=3D"3755"></td><td class=3D"line-content">            font=
-family: 'Inter', sans-serif;</td></tr><tr><td class=3D"line-number" value=
=3D"3756"></td><td class=3D"line-content">            font-size: 0.7rem;</t=
d></tr><tr><td class=3D"line-number" value=3D"3757"></td><td class=3D"line-=
content">            color: #888;</td></tr><tr><td class=3D"line-number" va=
lue=3D"3758"></td><td class=3D"line-content">            margin-bottom: 10p=
x;</td></tr><tr><td class=3D"line-number" value=3D"3759"></td><td class=3D"=
line-content">            text-transform: uppercase;</td></tr><tr><td class=
=3D"line-number" value=3D"3760"></td><td class=3D"line-content">        }</=
td></tr><tr><td class=3D"line-number" value=3D"3761"></td><td class=3D"line=
-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3762"></td><=
td class=3D"line-content">        .proj-stats {</td></tr><tr><td class=3D"l=
ine-number" value=3D"3763"></td><td class=3D"line-content">            disp=
lay: flex;</td></tr><tr><td class=3D"line-number" value=3D"3764"></td><td c=
lass=3D"line-content">            justify-content: space-between;</td></tr>=
<tr><td class=3D"line-number" value=3D"3765"></td><td class=3D"line-content=
">            margin-bottom: 10px;</td></tr><tr><td class=3D"line-number" v=
alue=3D"3766"></td><td class=3D"line-content">            background: #1a1a=
1a;</td></tr><tr><td class=3D"line-number" value=3D"3767"></td><td class=3D=
"line-content">            padding: 5px 8px;</td></tr><tr><td class=3D"line=
-number" value=3D"3768"></td><td class=3D"line-content">            border-=
radius: 3px;</td></tr><tr><td class=3D"line-number" value=3D"3769"></td><td=
 class=3D"line-content">        }</td></tr><tr><td class=3D"line-number" va=
lue=3D"3770"></td><td class=3D"line-content"><br></td></tr><tr><td class=3D=
"line-number" value=3D"3771"></td><td class=3D"line-content">        .proj-=
bar {</td></tr><tr><td class=3D"line-number" value=3D"3772"></td><td class=
=3D"line-content">            height: 6px;</td></tr><tr><td class=3D"line-n=
umber" value=3D"3773"></td><td class=3D"line-content">            backgroun=
d: #222;</td></tr><tr><td class=3D"line-number" value=3D"3774"></td><td cla=
ss=3D"line-content">            border-radius: 3px;</td></tr><tr><td class=
=3D"line-number" value=3D"3775"></td><td class=3D"line-content">           =
 overflow: hidden;</td></tr><tr><td class=3D"line-number" value=3D"3776"></=
td><td class=3D"line-content">        }</td></tr><tr><td class=3D"line-numb=
er" value=3D"3777"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"3778"></td><td class=3D"line-content">        =
.proj-fill {</td></tr><tr><td class=3D"line-number" value=3D"3779"></td><td=
 class=3D"line-content">            height: 100%;</td></tr><tr><td class=3D=
"line-number" value=3D"3780"></td><td class=3D"line-content">            ba=
ckground: linear-gradient(90deg, #d2b48c, #00ffcc);</td></tr><tr><td class=
=3D"line-number" value=3D"3781"></td><td class=3D"line-content">           =
 transition: width 0.5s ease;</td></tr><tr><td class=3D"line-number" value=
=3D"3782"></td><td class=3D"line-content">        }</td></tr><tr><td class=
=3D"line-number" value=3D"3783"></td><td class=3D"line-content">    <span c=
lass=3D"html-tag">&lt;/style&gt;</span></td></tr><tr><td class=3D"line-numb=
er" value=3D"3784"></td><td class=3D"line-content"><br></td></tr><tr><td cl=
ass=3D"line-number" value=3D"3785"></td><td class=3D"line-content">    <spa=
n class=3D"html-tag">&lt;div <span class=3D"html-attribute-name">id</span>=
=3D"<span class=3D"html-attribute-value">projector-view</span>"&gt;</span><=
/td></tr><tr><td class=3D"line-number" value=3D"3786"></td><td class=3D"lin=
e-content">        <span class=3D"html-tag">&lt;header <span class=3D"html-=
attribute-name">class</span>=3D"<span class=3D"html-attribute-value">proj-h=
eader</span>"&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"37=
87"></td><td class=3D"line-content">            <span class=3D"html-tag">&l=
t;h1&gt;</span>COMMAND PROGRESS BOARD<span class=3D"html-tag">&lt;/h1&gt;</=
span></td></tr><tr><td class=3D"line-number" value=3D"3788"></td><td class=
=3D"line-content">            <span class=3D"html-tag">&lt;div <span class=
=3D"html-attribute-name">style</span>=3D"<span class=3D"html-attribute-valu=
e">display:flex; gap:15px; align-items:center;</span>"&gt;</span></td></tr>=
<tr><td class=3D"line-number" value=3D"3789"></td><td class=3D"line-content=
">                <span class=3D"html-tag">&lt;select <span class=3D"html-a=
ttribute-name">id</span>=3D"<span class=3D"html-attribute-value">proj-class=
-filter</span>" <span class=3D"html-attribute-name">onchange</span>=3D"<spa=
n class=3D"html-attribute-value">renderProjectorBoard()</span>"</span></td>=
</tr><tr><td class=3D"line-number" value=3D"3790"></td><td class=3D"line-co=
ntent">                    <span class=3D"html-attribute-name">class</span>=
=3D"<span class=3D"html-attribute-value">select select-bordered select-xs f=
ont-mono bg-[#111] text-[#d2b48c] border-[#444] rounded-none</span>"&gt;</t=
d></tr><tr><td class=3D"line-number" value=3D"3791"></td><td class=3D"line-=
content">                    <span class=3D"html-tag">&lt;option <span clas=
s=3D"html-attribute-name">value</span>=3D"<span class=3D"html-attribute-val=
ue">ALL</span>"&gt;</span>ALL CLASSES<span class=3D"html-tag">&lt;/option&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"3792"></td><td cl=
ass=3D"line-content">                <span class=3D"html-tag">&lt;/select&g=
t;</span></td></tr><tr><td class=3D"line-number" value=3D"3793"></td><td cl=
ass=3D"line-content">                <span class=3D"html-tag">&lt;div <span=
 class=3D"html-attribute-name">id</span>=3D"<span class=3D"html-attribute-v=
alue">proj-sync</span>" <span class=3D"html-attribute-name">class</span>=3D=
"<span class=3D"html-attribute-value">font-mono text-[0.7rem] text-[#888] t=
racking-widest animate-pulse</span>"&gt;</span>[SYNCING]</td></tr><tr><td c=
lass=3D"line-number" value=3D"3794"></td><td class=3D"line-content">       =
         <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><td clas=
s=3D"line-number" value=3D"3795"></td><td class=3D"line-content">          =
      <span class=3D"html-tag">&lt;button <span class=3D"html-attribute-nam=
e">onclick</span>=3D"<span class=3D"html-attribute-value">toggleProjector()=
</span>"</span></td></tr><tr><td class=3D"line-number" value=3D"3796"></td>=
<td class=3D"line-content">                    <span class=3D"html-attribut=
e-name">class</span>=3D"<span class=3D"html-attribute-value">btn btn-sm bg-=
[#d2b48c] text-black border-none hover:bg-white font-bold tracking-widest r=
ounded-sm</span>"&gt;</td></tr><tr><td class=3D"line-number" value=3D"3797"=
></td><td class=3D"line-content">                    EXIT PROJECTOR</td></t=
r><tr><td class=3D"line-number" value=3D"3798"></td><td class=3D"line-conte=
nt">                <span class=3D"html-tag">&lt;/button&gt;</span></td></t=
r><tr><td class=3D"line-number" value=3D"3799"></td><td class=3D"line-conte=
nt">            <span class=3D"html-tag">&lt;/div&gt;</span></td></tr><tr><=
td class=3D"line-number" value=3D"3800"></td><td class=3D"line-content"><br=
></td></tr><tr><td class=3D"line-number" value=3D"3801"></td><td class=3D"l=
ine-content"><br></td></tr><tr><td class=3D"line-number" value=3D"3802"></t=
d><td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" va=
lue=3D"3803"></td><td class=3D"line-content"><span class=3D"html-tag">&lt;/=
body&gt;</span></td></tr><tr><td class=3D"line-number" value=3D"3804"></td>=
<td class=3D"line-content"><br></td></tr><tr><td class=3D"line-number" valu=
e=3D"3805"></td><td class=3D"line-content"><span class=3D"html-tag">&lt;/ht=
ml&gt;</span><span class=3D"html-end-of-file"></span></td></tr></tbody></ta=
ble></body></html>
------MultipartBoundary--FeyzHuLTMIljhGvj9jgptcWXZPnsbmmXKjbLzejwBg------
